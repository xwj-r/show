!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(a){return new Promise(function(t,i){var e=new XMLHttpRequest;e.open("GET",a,!0),e.onreadystatechange=function(){if(4===this.readyState)if(200===this.status)t(this.responseText,this);else{var e={code:this.status,response:this.response};i(e,this)}},e.send()})}function n(e){var t=e instanceof Array?[]:{};for(var i in e)t[i]="object"===a(e[i])?n(e[i]):e[i];return t}function s(e){var a={};return e.replace(/[?&](.*?)=([^&]*)/g,function(e,t,i){return a[t]=i}),a}function o(){return/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)||/(Android)/i.test(navigator.userAgent)||/(WindowsWechat)/i.test(navigator.userAgent)}function d(e){return document.querySelector(e)}function c(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),window.d3Chart.setUserMd("c53822d351882c0c49acafc7c44f09ca");this.opts=Object.assign({},e,{url:"",publishTime:"",dataSouce:"",hidewatermark:!1,hidelogo:!1,screenshot:{},screenshot_un:{},fileType:"",isSubscribed:!1,isLogined:!0,subscribeLoadfg:!1,showLikeMask:!1,itemId:"",metaId:"",sessionId:"",task:0,imgurls:{watermarkImg:"",nowatermarkImg:""},transmitLoadfg:!1,showAndroidMask:!1,showIOSMask:!1,showViewDataTip:!0,originalData:[[]],showTips:!0,uploadImg_height:0,isAndroid:!1,flag:!1,hasPaid:"",showTipNum:4,jsonDict:{data_permission:"must_paid",is_senior_vip:!1,payment_status:!1,geotype:"3"}}),(/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)||/(Android)/i.test(navigator.userAgent)||/(Wechat)/i.test(navigator.userAgent)||/(WindowsWechat)/i.test(navigator.userAgent))&&(function(e,i){var t,a=document,r=window,n=a.documentElement,s=document.createElement("style");function o(){var e=n.getBoundingClientRect().width;(i=i||540)<e&&(e=i);var t=100*e/750;s.innerHTML="html{font-size:"+t+"px;}"}if(n.firstElementChild)n.firstElementChild.appendChild(s);else{var d=a.createElement("div");d.appendChild(s),a.write(d.innerHTML),d=null}o(),r.addEventListener("resize",function(){clearTimeout(t),t=setTimeout(o,300)},!1),r.addEventListener("pageshow",function(e){e.persisted&&(clearTimeout(t),t=setTimeout(o,300))},!1),"complete"===a.readyState?a.body.style.fontSize="16px":a.addEventListener("DOMContentLoaded",function(e){a.body.style.fontSize="16px"},!1)}(0,750),document.querySelector("body").classList.add("is-mobile")),this.initData(),this.getDataDetail();var i=this;r(this.opts.url).then(function(e){var t=JSON.parse(e);1e3===t.resultCode?(i.loadBlock(t.data.article.contents.pages[0].blocks[0]),i.opts.data=t.data,i.resolveArticle(t.data)):6003===t.resultCode||t.resultCode}).catch(function(e){console.log(""+e)}),this.addEvent()}new(function(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),e}(t,[{key:"initData",value:function(){var e=s(location.href);this.opts.url=function(e){if(!e)throw new Error("need request address");var t=void 0;if(0<e.indexOf("_")){var i=e.split("_")[0];"d"===i?t="https://www.dydata.io/dychart/data_chart_publish/"+e.split("_")[1]:"c"===i&&(t="https://www.dydata.io/dychart/chart_publish/"+e.split("_")[1])}else t="https://www.dydata.io/dychart/publish/"+e;return t}(e.id),e.hidewatermark?this.opts.hidewatermark="true"===e.hidewatermark:this.opts.hidewatermark=!1,e.hidelogo?this.opts.hidelogo="true"===e.hidelogo:this.opts.hidelogo=!1,this.opts.sessionId=e.sessionId;var t={id:e.id,metaId:this.opts.metaId,fileType:this.opts.fileType},i=JSON.stringify(t);window.wx&&window.wx.miniProgram.postMessage({data:i}),/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?this.opts.isAndroid=!1:/(Android)/i.test(navigator.userAgent)&&(this.opts.isAndroid=!0)}},{key:"getDataDetail",value:function(){var i=this;i.opts.itemId=s(location.href).id.split("d_")[1],document.cookie="csrftoken=fs4J0NeAOSXXu2fcvaTi9fVdHaKj1P9qwdnrhkgbShGF4rKMS6I0AzPpWGpwXTJy";var e="https://www.dydata.io/mapp/detail/ref_info/"+i.opts.itemId+"/?sessionId="+i.opts.sessionId;jQuery.ajax({url:e,type:"get",async:!1,xhrFields:{withCredentials:!0},contentType:!1,success:function(e){var t=e.data;10<=String(t.publish_time).length?i.opts.publishTime=t.publish_time.substring(0,10):i.opts.publishTime="",i.opts.dataSouce=t.source?decodeURIComponent(t.source)+"</br>更多数据请在pc端登陆官网www.dydata.io":"",i.opts.isSubscribed=t.is_subscribed,i.opts.metaId=t.meta_id,i.opts.fileType=t.file_type,i.opts.isLogined=t.is_logined,i.opts.hasPaid=t.has_paid,i.opts.isLogined||d(".login-mask").classList.remove("active")},error:function(e){console.log(e)}})}},{key:"addEvent",value:function(){var i=this;document.addEventListener("touchmove",function(e){i.opts.flag&&e.preventDefault()},{passive:!1}),d(".view-data").addEventListener("click",function(){i.opts.isLogined?d(".page").classList.contains("active")?(d(".page").classList.remove("active"),d(".weixin-table").classList.add("active"),d(".view-data-img").src="./images/excel.svg",d(".view-data-text").innerHTML="查看数据",d(".publish-time").classList.remove("active"),d(".view-data-tip").classList.add("active"),d(".from-tooltip").classList.remove("active"),d("body").setAttribute("style","position: auto"),window._hmt.push(["_trackEvent","wxshow","wxshow","wxshow-checkData"])):(d(".page").classList.add("active"),d(".weixin-table").classList.remove("active"),d(".view-data-img").src="./images/pie.svg",d(".view-data-text").innerHTML="查看图表",d(".publish-time").classList.add("active"),d(".view-data-tip").classList.remove("active"),d(".from-tooltip").classList.add("active"),d("body").setAttribute("style","position: fixed"),window.scroll(0,0),window._hmt.push(["_trackEvent","wxshow","wxshow","wxshow-checkChart"])):window.wx&&window.wx.miniProgram.navigateTo({url:"/pages/auth/auth"})}),d(".login-return").addEventListener("click",function(){window.wx.miniProgram.switchTab({url:"/pages/home/index"})}),d(".login-wx").addEventListener("click",function(){window.wx&&window.wx.miniProgram.navigateTo({url:"/pages/auth/auth"})}),d(".home").addEventListener("click",function(){window._hmt.push(["_trackEvent","wxshow","wxshow","wxshow-returnIndex"]),window.wx.miniProgram.switchTab({url:"/pages/home/index"})}),d(".collection").addEventListener("click",function(){window._hmt.push(["_trackEvent","wxshow","wxshow","wxshow-like"]);var t=i.opts;if(t.isLogined)if(t.subscribeLoadfg)alert("请不要频繁操作!");else{d(".collection").classList.contains("active")?d(".collection").classList.remove("active"):d(".collection").classList.add("active"),t.subscribeLoadfg=!0,t.isSubscribed=!t.isSubscribed,t.isSubscribed?(t.showLikeMask=!0,d(".like-mask").classList.remove("active"),t.flag=!0,setTimeout(function(){d(".like-mask").classList.add("active"),t.flag=!1},1e3)):(t.showDisLikeMask=!0,d(".disLike-mask").classList.remove("active"),t.flag=!0,setTimeout(function(){t.showDisLikeMask=!1,d(".disLike-mask").classList.add("active"),t.flag=!1},1e3));var e="https://www.dydata.io/mapp/user/favorite";r(e+="?metaId="+t.metaId+"&id="+t.data.id+"&isAdded="+t.isSubscribed+"&sessionId="+t.sessionId).then(function(e){t.subscribeLoadfg=!1})}else window.wx&&window.wx.miniProgram.navigateTo({url:"/pages/auth/auth"})}),d(".download").addEventListener("click",function(){if(i.opts.isLogined){var e=s(location.href).id;0<e.indexOf("_")&&(e=e.split("_")[1]);var t=document.createElement("input");t.readOnly="readOnly",t.value="http://www.dydata.io/datastore/detail/"+e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),d(".download-mask").classList.remove("active")}else window.wx&&window.wx.miniProgram.navigateTo({url:"/pages/auth/auth"})}),d(".button-group").addEventListener("click",function(){d(".download-mask").classList.add("active")})}},{key:"loadBlock",value:function(e){var h={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,i,a,r,n,s,o,d="",c=0;for(e=h._utf8_encode(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,n=(3&t)<<4|(i=e.charCodeAt(c++))>>4,s=(15&i)<<2|(a=e.charCodeAt(c++))>>6,o=63&a,isNaN(i)?s=o=64:isNaN(a)&&(o=64),d=d+this._keyStr.charAt(r)+this._keyStr.charAt(n)+this._keyStr.charAt(s)+this._keyStr.charAt(o);return d},decode:function(e){var t,i,a,r,n,s,o="",d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)t=this._keyStr.indexOf(e.charAt(d++))<<2|(r=this._keyStr.indexOf(e.charAt(d++)))>>4,i=(15&r)<<4|(n=this._keyStr.indexOf(e.charAt(d++)))>>2,a=(3&n)<<6|(s=this._keyStr.indexOf(e.charAt(d++))),o+=String.fromCharCode(t),64!=n&&(o+=String.fromCharCode(i)),64!=s&&(o+=String.fromCharCode(a));return o=h._utf8_decode(o)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var a=e.charCodeAt(i);a<128?t+=String.fromCharCode(a):(127<a&&a<2048?t+=String.fromCharCode(a>>6|192):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128)),t+=String.fromCharCode(63&a|128))}return t},_utf8_decode:function(e){for(var t,i="",a=0,r=0,n=0;a<e.length;)(r=e.charCodeAt(a))<128?(i+=String.fromCharCode(r),a++):191<r&&r<224?(n=e.charCodeAt(a+1),i+=String.fromCharCode((31&r)<<6|63&n),a+=2):(n=e.charCodeAt(a+1),t=e.charCodeAt(a+2),i+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&t),a+=3);return i}},t=n(e.dataSrc.data[0]),i=[];t.forEach(function(e){var t=e.map(function(e,t,i){if(!isNaN(e))return e-3;if(/^b/.test(e))try{return h.decode(e.substring(1))}catch(e){console.log(e)}});i.push(t)}),t=i,this.opts.originalData[0]=function(e){return n(e).map(function(e){return e.map(function(e){return""===e?void 0:isNaN(e)||e===parseInt(e)?e:Math.ceil(1e4*Number(e))/1e4})})}(i);var a=void 0;a=4<t.length?t.slice(0,4):t;for(var r=0;r<a.length;r++)4<a[r].length&&(a[r]=a[r].slice(0,4));e.dataSrc.data[0]=a}},{key:"resolveArticle",value:function(e){var t=n(e);console.log(e),document.title=""===t.title?"未命名":t.title,this.createTip(t.title),this.resolveDesign(t.article.contents.design),this.resolveBlock(t.article.contents.pages[0].blocks),this.filterData()}},{key:"createTip",value:function(e){d("h4").innerHTML=e,d(".title").innerHTML=e;var t=d(".view-data-tip");this.opts.showViewDataTip,this.opts.isAndroid,this.opts.showTipNum,this.opts.jsonDict.is_senior_vip,this.opts.jsonDict.payment_status,this.opts.hidewatermark&&d("main").classList.remove("active");var i=d("header").getBoundingClientRect().height;d(".weixin-table").setAttribute("style","top: "+(i+5)+"px"),this.opts.hidelogo&&d(".page-logo").classList.add("active"),this.opts.hasPaid||(t.innerHTML="注：标*部分数据在下载后的文件中完整显示"),this.opts.publishTime&&(d(".publish-time").innerHTML="发布时间："+this.opts.publishTime),this.opts.dataSouce&&(d(".dataSouce").innerHTML="数据来源："+this.opts.dataSouce),this.opts.showTips&&setTimeout(function(){d(".tips").style.display="none"},5e3),o()&&d(".from-tooltip").classList.remove("active");var a={id:this.opts.data.id,metaId:this.opts.metaId,fileType:this.opts.fileType},r=JSON.stringify(a);window.wx&&window.wx.miniProgram.postMessage({data:r}),this.opts.isSubscribed&&d(".collection").classList.add("active")}},{key:"filterData",value:function(){var e=void 0;e=this.opts.hasPaid?n(this.opts.originalData[0]):n(this.opts.originalData[0]).map(function(e,t){return 4<=t&&(e=e.map(function(e,t){return 0<t&&(e="*"),e})),0!==t&&4<=e.length&&(e=e.map(function(e,t){return 4<=t&&(e="*"),e})),e}),this.createTable(e)}},{key:"createTable",value:function(e){var i=d(".table-tbody");e&&e.map(function(e){var t=document.createElement("tr");e.forEach(function(e){t.innerHTML+=e?"<td>"+e+"</td>":"<td></td>"}),i.appendChild(t)})}},{key:"resolveDesign",value:function(e){var t=d(".page"),i=d("article");if(this.setCss(t,{width:e.width,height:e.height}),this.updatePageSize(t,i,e),o()){var a=this;window.onresize=function(e,t){var i=null;return function(){clearTimeout(i),i=setTimeout(function(){e()},t)}}(function(){a.updatePageSize(t,i,e)},200)}}},{key:"updatePageSize",value:function(e,t,i){var a=void 0;o()?a=document.body.clientWidth:window.self!==window.top||(a="700");var r=a/i.width;e.style.transform="scale("+r+")",o()?t.style.height=i.height*r+"px":t.style.height=i.height*r+80+"px"}},{key:"resolveBlock",value:function(e){for(var t=0;t<e.length;t++)switch(e[t].type){case"image":this.resolveImg(e[t]);break;case"chart":this.resolveChart(e[t]);break;case"text":this.resolveText(e[t]);break;case"shape":this.resolveShape(e[t])}}},{key:"resolveImg",value:function(e){var t=d(".page"),i=document.createElement("img"),a=e.props;i.src=e.src,this.setCss(i,{left:e.position.left,top:e.position.top,width:a.size.width,height:a.size.height,border:a.border.strokeWidth+"px "+a.border.strokeType+" "+a.border.strokeColor,borderRadius:a.borderRadius,opacity:a.opacity,transform:a.size.rotate}),t.appendChild(i)}},{key:"resolveChart",value:function(e){var t=d(".page"),i=document.createElement("div");i.className="block-container";var a=e.props;this.setCss(i,{left:e.position.left,top:e.position.top,width:a.size.width,height:a.size.height,transform:a.size.rotate}),t.appendChild(i),function(e,t){switch(e){case"5544734748594536492":return new window.d3Chart.RoundCornerDonutChart(t);case"5544734748594536493":return new window.d3Chart.RoundCornerPieChart(t);case"5944734748594536331":return new window.d3Chart.RoseChart(t);case"5943734748594536331":return new window.d3Chart.QuarterRoseChart(t);case"5544734748594536499":return new window.d3Chart.OverlapAreaChart(t);case"5612096174443311134":return new window.d3Chart.StepLineChart(t);case"5945734748594536331":return new window.d3Chart.RadialBarChart(t);case"5948734748594536332":return new window.d3Chart.RadialLineChart(t);case"4447460703254610031":return new window.d3Chart.WaveCircleChart(t);case"5544734748594536473":return new window.d3Chart.IconBarChart(t);case"5543733748594536505":return new window.d3Chart.SimpleSankeyChart(t);case"5543733748594536504":return new window.d3Chart.SankeyChart(t);case"5543533748794536504":return new window.d3Chart.VerticalSankeyChart(t);case"4447460703254610041":return new window.d3Chart.IconPieChart(t);case"5544734748594536494":return new window.d3Chart.TwoLevelDonutChart(t);case"5544734748594536500":return new window.d3Chart.ChordChart(t);case"5544734748594536503":return new window.d3Chart.OneLevelTreemapChart(t);case"5544734748594536502":return new window.d3Chart.TwoLevelTreemapChart(t);case"5543734748594537504":return new window.d3Chart.SunburstChart(t);case"5543734748595436502":return new window.d3Chart.TreeChart(t);case"5543734748594536502":return new window.d3Chart.WeightedTreeChart(t);case"5544734748594536478":return new window.d3Chart.MultipleBarChart(t);case"5544734748594536487":return new window.d3Chart.PyramidChart(t);case"5544734748594536491":return new window.d3Chart.RadarChart(t);case"5544734748594536486":return new window.d3Chart.StreamgraphChart(t);case"4612096174443311107":return new window.d3Chart.GroupingBubbleChart(t);case"5544734748594536484":return new window.d3Chart.CalendarHeatmapChart(t);case"5612096174443311145":return new window.d3Chart.HollowChart;case"5544734748594536330":return new window.d3Chart.ChangeWaterfallHistogramChart(t);case"5544734748594536326":return new window.d3Chart.FormWaterfallHistogramChart(t);case"5544734748594536498":return new window.d3Chart.StackedChart(t);case"444746070325460997":return new window.d3Chart.PieChart(t);case"444746070325460998":return new window.d3Chart.DonutChart(t);case"444746070325460999":return new window.d3Chart.DeformedPieChart(t);case"4544734748594536433":return new window.d3Chart.BeeLineChart(t);case"5948734748594536789":return new window.d3Chart.SmoothLineChart(t);case"444734748594536323":return new window.d3Chart.SimpleBarChart(t);case"154772011302084304":return new window.d3Chart.BasicHorizontalBarChart(t);case"3612096174443311105":return new window.d3Chart.GroupedBarChart(t);case"3612096174443311107":return new window.d3Chart.StackBarChart(t);case"3612096174443311106":return new window.d3Chart.NegativeHorizontalBarChart(t);case"3612096174443311110":return new window.d3Chart.GroupedHorizontalBarChart(t);case"3612096174443311109":return new window.d3Chart.StackHorizontalBarChart(t);case"5544734748594536332":return new window.d3Chart.MixLineBarChart(t);case"4544734748594536434":return new window.d3Chart.StackedLinearChart(t);case"451905388296536065":return new window.d3Chart.PolygonRadarChart(t);case"5544734748594536339":return new window.d3Chart.FunnelChart(t);case"154778025133261039":return new window.d3Chart.PercentageAreaChart(t);case"154778102528502157":return new window.d3Chart.PercentageBarChart(t);case"154777746677828400":return new window.d3Chart.HalfPieChart(t);case"154778171740391769":return new window.d3Chart.ProgressRoundPieChart(t);case"154778145806026722":return new window.d3Chart.BarProgressChart(t);case"154777820323716078":return new window.d3Chart.HalfProgressPieChart(t);case"154771854328053247":return new window.d3Chart.ArcDiagramChart(t);case"154778232785223023":return new window.d3Chart.SlopeChart(t);case"154777693253141239":return new window.d3Chart.GanttChart(t);case"154778205305403383":return new window.d3Chart.RankingChangeChart(t);case"5544734748594536495":return new window.d3Chart.SymmetricChart(t);case"444746070325460995":return new window.d3Chart.SimpleLineChart(t);case"7612096173333355101":return new window.d3Chart.ContrastiveFunnelChart(t);case"7612096173333355103":return new window.d3Chart.RelativeRadarChart(t);case"7612096176663355107":case"7612096176663355107":return new window.d3Chart.StackCircleChart(t);case"7612096176663355103":return new window.d3Chart.RangeAreaChart(t);case"7612096176663355104":return new window.d3Chart.RangeBarChart(t);case"7612096176663355105":return new window.d3Chart.RangeHorizontalBarChart(t);case"7612096174443355101":return new window.d3Chart.PolarStackBarChart(t);case"7612096174443355102":return new window.d3Chart.PolarStackDonutBarChart(t);case"7612096176663355106":return new window.d3Chart.RoseDonutChart(t);case"7612096173333355102":return new window.d3Chart.HistogramChart(t);case"114473474859453649":return new window.d3Chart.WordCloudChart(t);default:return new window.d3Chart.PieChart(t)}}(e.templateId,i).setOption(e)}},{key:"resolveText",value:function(e){var t=d(".page"),i=document.createElement("textarea"),a=e.props;i.innerHTML=a.content,i.readOnly="readonly",i.className="textarea",this.setCss(i,{left:e.position.left,top:e.position.top,width:a.size.width,height:a.size.height,transform:a.size.rotate,opacity:a.opacity,fontSize:a.fontSize,fontFamily:a.fontFamily,color:a.color,letterSpacing:a.letterSpacing,lineHeight:a.lineHeight,textAlign:a.basic.align,fontWeight:a.basic.bold}),t.appendChild(i)}},{key:"resolveShape",value:function(e){switch(e.shapeType){case"icon":this.resolveIcon(e);break;default:this.resolveDefaultShape(e)}}},{key:"resolveIcon",value:function(e){var t=d(".page"),i=document.createElement("div"),a=e.props;i.className="shape-box",i.innerHTML=e.src,this.setCss(i,{left:e.position.left,top:e.position.top,width:a.size.width,height:a.size.height,transform:a.size.rotate,opacity:a.opacity}),t.appendChild(i);var r=i.querySelector("svg");this.setSvgStyle(r,{opacity:a.opacity/100,fill:a.fill.fillColor[0],rx:a.specified?a.specified.rx:0,ry:a.specified?a.specified.ry:0,x:a.specified?a.specified.x:0,y:a.specified?a.specified.y:0,cx:a.specified?a.specified.cx:0,cy:a.specified?a.specified.cy:0,r:a.specified?a.specified.r:0,x1:a.specified?a.specified.x1:0,y1:a.specified?a.specified.y1:0,x2:a.specified?a.specified.x2:0,y2:a.specified?a.specified.y2:0,stroke:a.strokeColor,strokeWidth:a.strokeWidth,strokeDasharray:a.strokeDasharray})}},{key:"resolveDefaultShape",value:function(e){var t=d(".page"),i=document.createElement("div"),a=e.props;i.className="shape-box",this.setCss(i,{left:e.position.left,top:e.position.top,width:a.size.width,height:a.size.height,transform:a.size.rotate,opacity:a.opacity});var r={width:a.size.width+"px",height:a.size.height+"px",opacity:a.opacity/100,fill:a.fill.fillColor[0],rx:a.specified?a.specified.rx:0,ry:a.specified?a.specified.ry:0,x:a.specified?a.specified.x:0,y:a.specified?a.specified.y:0,cx:a.specified?a.specified.cx:0,cy:a.specified?a.specified.cy:0,r:a.specified?a.specified.r:0,x1:a.specified?a.specified.x1:0,y1:a.specified?a.specified.y1:0,x2:a.specified?a.specified.x2:0,y2:a.specified?a.specified.y2:0,stroke:a.strokeColor,strokeWidth:a.strokeWidth,strokeDasharray:a.strokeDasharray,linearGradientStart:{"stop-color":a.fill.fillColor[0],"stop-opacity":1},linearGradientEnd:{"stop-color":a.fill.fillColor[1],"stop-opacity":1}};switch(e.shapeType){case"rectangle":case"round-rectangle":i.innerHTML='\n          <svg width="100%" height="100%" preserveAspectRatio="none" stroke-miterlimit="60" version="1.1" xmlns="http://www.w3.org/2000/svg">\n            <rect class="svg-element"\n              width="'+r.width+'" height="'+r.height+'" opacity="'+r.opacity+'"\n              fill="'+r.fill+'" rx="'+r.rx+'" ry="'+r.ry+'" x="'+r.x+'"\n              y="'+r.y+'" stroke="'+r.stroke+'" stroke-width="'+r.strokeWidth+'"\n              stroke-dasharray="'+r.strokeDasharray+'"></rect>\n          </svg>\n        ';break;case"line":i.innerHTML='\n          <svg width="100%" height="100%" class="line-wrap">\n            <line class="line" width="'+r.width+'"\n              height="'+r.height+'" opacity="'+r.opacity+'" fill="'+r.stroke+'"\n              x1="'+r.x1+'" y1="'+r.y1+'" x2="'+r.x2+'" y2="'+r.y2+'"\n              stroke="'+r.stroke+'" stroke-width="'+r.strokeWidth+'" stroke-dasharray="'+r.strokeDasharray+'"\n              marker-start="'+r.markerStart+'" marker-end="'+r.markerEnd+'"></line>\n          </svg>\n        ';break;case"oval":i.innerHTML='\n          <svg width="100%" height="100%" preserveAspectRatio="none" stroke-miterlimit="60" version="1.1" xmlns="http://www.w3.org/2000/svg">\n            <ellipse class="svg-element" \n              opacity="'+r.opacity+'" fill="'+r.fill+'" cx="'+r.cx+'" cy="'+r.cy+'"\n              rx="'+r.rx+'" ry="'+r.ry+'" stroke="'+r.stroke+'" stroke-width="'+r.strokeWidth+'"\n              stroke-dasharray="'+r.strokeDasharray+'"></ellipse>\n          </svg>\n        ';break;case"triangle":i.innerHTML='\n        <svg width="100%" height="100%" preserveAspectRatio="none" stroke-miterlimit="60" version="1.1" xmlns="http://www.w3.org/2000/svg">\n          <polygon class="svg-element" \n            points="'+e.path+'" width="'+r.width+'" height="'+r.height+'" opacity="'+r.opacity+'" fill="'+r.fill+'" stroke="'+r.stroke+'" stroke-width="'+r.strokeWidth+'" stroke-dasharray="'+r.strokeDasharray+'"></polygon>\n        </svg>\n        ';break;case"pentagon":i.innerHTML='\n        <svg width="100%" height="100%" preserveAspectRatio="none" stroke-miterlimit="60" version="1.1" xmlns="http://www.w3.org/2000/svg">\n          <polygon class="svg-element" points="'+e.path+'"\n            width="'+r.width+'" height="'+r.height+'" opacity="'+r.opacity+'"\n            fill="'+r.fill+'" stroke="'+r.stroke+'" stroke-width="'+r.strokeWidth+'"\n            stroke-dasharray="'+r.strokeDasharray+'"></polygon>\n        </svg>\n        '}t.appendChild(i)}},{key:"setCss",value:function(e,t){this.setStyle(e,{width:t.width?t.width+"px":null,height:t.height?t.height+"px":null,left:t.left?t.left+"px":null,top:t.top?t.top+"px":null,backgroundColor:t.backgroundColor?t.backgroundColor:null,border:t.border?t.border:null,borderRadius:t.borderRadius?t.borderRadius:null,opacity:t.opacity?t.opacity:null,transform:t.rotate?"rotate("+t.rotate+"deg)":null,fontSize:t.fontSize?t.fontSize+"px":null,fontFamily:t.fontFamily?t.fontFamily:null,color:t.color?t.color:null,letterSpacing:t.letterSpacing?t.letterSpacing+"px":null,lineHeight:t.lineHeight?t.lineHeight:null,textAlign:t.textAlign?t.textAlign:null,fontWeight:t.fontWeight?"bold":null})}},{key:"setStyle",value:function(e,t){for(var i in t)e.style[i]=t[i]}},{key:"setSvgStyle",value:function(e,t){for(var i in t)e.setAttribute(i,t[i])}},{key:"uploadImg",value:function(n){var s=this;window.scrollTo(0,0),d(".show-container").setAttribute("style"," overflow: visible"),d(".from-box").setAttribute("style","border: none");var e=0;"查看图表"===d(".view-data-text").innerHTML&&(d(".title").classList.remove("active"),d(".page").classList.remove("active"),d(".publish-time").classList.remove("active"),d(".from-tooltip").classList.remove("active"),e=d(".title").getBoundingClientRect().y-48),n&&d("main").classList.remove("active");var t=d(".from").getBoundingClientRect().y+d(".from").getBoundingClientRect().height-37-e;html2canvas(d("main"),{x:0,y:e,width:innerWidth,height:t,logging:!1,ignoreElements:function(e){if("weixin-table"===e.id)return!0}}).then(function(e){d(".show-container").setAttribute("style",'overflow:""'),d(".from-box").setAttribute("style","border-bottom: 1px dashed #d1d1d1"),"查看图表"===d(".view-data-text").innerHTML&&(d(".title").classList.add("active"),d(".page").classList.add("active"),d(".publish-time").classList.add("active"),d(".from-tooltip").classList.add("active")),n&&d("main").classList.add("active");var t=e.toDataURL("image/png").split(";"),i=t[0].split(":")[1],a=t[1].split(",")[1],r=s.base64toBinary(a,i);jQuery.ajax({url:"https://www.dydata.io/dychart/upload/base64_image",type:"post",async:!1,xhrFields:{withCredentials:!0},processData:!1,contentType:!1,cache:!1,data:r,dataType:"json",success:function(e){var t="https://image.dydata.io/"+e.data;n?(s.opts.imgurls.nowatermarkImg=t,console.log("无水印"+t)):(s.opts.imgurls.watermarkImg=t,console.log("有水印"+t))},error:function(e){console.log(e)}})})}},{key:"base64toBinary",value:function(e,t){t=t||"";for(var i=atob(e),a=new ArrayBuffer(i.length),r=new Uint8Array(a),n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return new Blob([a],{type:t})}}]),t)});
