!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).d3Chart={})}(this,function(t){"use strict";function L(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2*Math.PI,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0,o=t,a=e,r=n;Math.abs(r-a-2*Math.PI)<=1e-5&&(r-=1e-5);var l=Math.cos(a-Math.PI/2)*o,s=Math.sin(a-Math.PI/2)*o,u=Math.cos(r-Math.PI/2)*o,c=Math.sin(r-Math.PI/2)*o,h=0,d=1;function _(){return o+" "+o+" 0 "+h+" "+d+" "}return Math.abs(r-a)>=Math.PI&&(h=1),void 0!==i?d=isNaN(Number(i))?1:Number(i):void 0===i&&(r+a)/2>Math.PI/2&&(r+a)/2<Math.PI/2*3&&(d=0),d?"M"+l+" "+s+"A"+_()+" "+u+" "+c:"M"+u+" "+c+"A"+_()+" "+l+" "+s}function at(t){return"none"!==t.style("display")?t.node().getBBox():{x:0,y:0,width:0,height:0}}function e(t){t.style("display","block")}function n(t){t.style("display","none")}function H(t,e,n){t.attr("transform","translate("+e+","+n+")")}function i(t){var e=t+Math.floor(1e9*Math.random()).toString(32)+Date.now().toString(32);return null==document.getElementById(e)?e:i(t)}function C(t){return t.filter(function(t){return!1!==t.active})}function M(t,e,n,i){var o=Math.min(t,e)/2,a=t/2,r=e/2,l=0;if(Math.abs(i-n)<=Math.PI/2){var s=Math.min(i,n),u=Math.max(i,n);o=Math.min(t,e),0<=s&&u<=Math.PI/2?(a=(t-o)/2,r=(e-o)/2+o,l=1):s>=Math.PI/2&&u<=Math.PI?(a=(t-o)/2,r=(e-o)/2,l=2):s>=Math.PI&&u<=3*Math.PI/2?(a=(t-o)/2+o,r=(e-o)/2,l=3):s>=3*Math.PI/2&&u<=2*Math.PI&&(a=(t-o)/2+o,r=(e-o)/2+o,l=4)}return{radius:o,cx:a,cy:r,quadrant:l}}function y(t){var e=t.split(/[\-\/]/);if(3!==e.length)return t;if(e[0].length<4){var n=d3.range(4-e[0].length).map(function(){return 0}).join("");e[0]=n+e[0]}return 1===e[1].length&&(e[1]="0"+e[1]),1===e[2].length&&(e[2]="0"+e[2]),e.join("-")}function k(t,e){var n,i=window.location.href;return void 0===e&&(e="Safari"==(-1<(n=navigator.userAgent).indexOf("Opera")||-1<n.indexOf("OPR")?"Opera":-1<n.indexOf("compatible")&&-1<n.indexOf("MSIE")?"IE":-1<n.indexOf("Edge")?"Edge":-1<n.indexOf("Firefox")?"Firefox":-1<n.indexOf("Safari")&&-1==n.indexOf("Chrome")?"Safari":-1<n.indexOf("Chrome")&&-1<n.indexOf("Safari")?"Chrome":window.ActiveXObject||"ActiveXObject"in window?"IE>=11":"Unkonwn")&&!/\/#\//.test(i)),e?i+t:t}function T(t,e){var n=/[^\u4e00-\u9fa5\w-]/gi;return e=null==e||n.test(e)?"-":e,t.toString().replace(n,e)}function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return Math.abs(parseFloat(t))||e}function tt(t){for(var e=t.x,n=void 0===e?0:e,i=t.y,o=void 0===i?0:i,a=t.width,r=void 0===a?100:a,l=t.height,s=void 0===l?100:l,u=t.cornerRadius,c=void 0===u?0:u,h=t.roundCorners,d=void 0===h?[0,1,2,3]:h,_=n,f=o,p=n+r,y=o+s,g=Math.min(Math.min(r,s)/2,c),v=g+" "+g+" 0 0 1",x=["L"+_+" "+f,"L"+p+" "+f,"L"+p+" "+y,"L"+_+" "+y],m=["A"+v+" "+(_+g)+" "+f,"A"+v+" "+p+" "+(f+g),"A"+v+" "+(p-g)+" "+y,"A"+v+" "+_+" "+(y-g)],k=[],b=0;b<=3;b++){var S=d.includes(b)?m[b]:x[b];k.push(S)}return"\n    M"+_+" "+(f+g)+"\n    "+k[0]+"\n    H"+(p-g)+"\n    "+k[1]+"\n    V"+(y-g)+"\n    "+k[2]+"\n    H"+(_+g)+"\n    "+k[3]+"\n    Z\n  "}function rt(t,e){var n=t.x,i=t.y,o=t.x+t.width,a=t.y+t.height,r=e.x,l=e.y,s=e.x+e.width,u=e.y+e.height;return!(s<n||o<r||u<i||a<l)}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},l=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),s=function t(e,n,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,n,i)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(i):void 0},u=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},v=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},a=function(){function t(){r(this,t),this.elem=null,this._pos=[0,0],this._show=!0,this.id=i("")}return l(t,[{key:"update",value:function(){}},{key:"show",value:function(){return e(this.elem),this._show=!0,this}},{key:"hide",value:function(){return n(this.elem),this._show=!1,this}},{key:"width",value:function(){return at(this.elem).width}},{key:"height",value:function(){return at(this.elem).height}},{key:"translate",value:function(t,e){return arguments.length?(this.pos=[t,e],H(this.elem,t,e),this):this.pos}},{key:"isShow",get:function(){return this._show}}]),t}();function P(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];return!e.length||e[0].length<(n||2)||t.some(function(t){return void 0===e[0][t]})}function x(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return t.slice(1).some(function(t){return!isNaN(parseFloat(t[e]))})}function h(t,e){var o=0,a=1;if(e.forEach(function(t){"objCol"===t.function?o=t.index:"vCol"===t.function&&(a=t.index)}),P(t,[o,a])||!x(t,a))return[];var r=[],l=t[0][o],s=t[0][a];return t.slice(1).forEach(function(t,e){var n=parseFloat(t[a]);if(!isNaN(n)){var i=t[o];""!=t[o]&&null!=t[o]&&null!=t[o]||(i="$-"+e),r.push({name:i,showLegend:i!="$-"+e,value:+t[a],nameLabel:l,valueLabel:s})}}),r.forEach(function(t,e){t.key=T(t.name)+"-"+e}),r}function W(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(1===e.length)return t;var n=e.filter(function(t){return"objCol"===t.function||"vCol"===t.function&&t.configurable}).map(function(t){return t.index});return t.map(function(t){return t.filter(function(t,e){return 0<=n.indexOf(e)})})}function _(t,e){var n=0,i=!1,o=[];if(e.forEach(function(t){"objCol"===t.function?(n=t.index,i=t.isLegend):"vCol"===t.function&&0==t.configurable&&o.push(t.index)}),P(t,[n],2))return[];for(var a=W(t,e),r={},l=[],s=a.length,u=a[0],c=[],h=[],d=1;d<s;d++)h.push(a[d].length);h.sort(function(t,e){return e-t});for(var _=0;_<s;_++)for(var f=0;f<h[0];f++)c.push(isNaN(parseFloat(a[_][f])));if(0==c.filter(function(t,e){return 0==t}).length)return[];if(i){for(var p=[],y=1;y<s;y++)p.push(a[y].length);p.sort(function(t,e){return e-t});for(var g=1;g<s;g++){var v=a[g],x=v[n];if(""!=x&&null!=x&&null!=x||(x="$-"+g),x){for(var m={name:x,showLegend:x!="$-"+g,data:[]},k=0;k<p[0];k++){var b=u[k];""!=b&&null!=b&&null!=b||(b="&-"+k),k!==n&&m.data.push({name:b,showAxisText:b!="&-"+k,value:""==v[k]||isNaN(parseFloat(v[k]))||null==v[k]||null==v[k]?0:v[k],tooltipValueShow:!isNaN(parseFloat(v[k]))})}l.push(m)}}}else{for(var S=[],w=1;w<s;w++)S.push(a[w].length);S.sort(function(t,e){return e-t});for(var O=1;O<S[0];O++)if(O!==n){var C=u[O];""!=u[O]&&null!=u[O]&&null!=u[O]||(C="$-"+O),r[C+"-"+O]={name:C,showLegend:C!="$-"+O,data:[]}}for(var A=1;A<s;A++){var F=a[A],L=F[n];if(""!=L&&null!=L&&null!=L||(L="&-"+A),L)for(var M=0;M<S[0];M++){var z=u[M];""!=u[M]&&null!=u[M]&&null!=u[M]||(z="$-"+M),M!==n&&z&&r[z+"-"+M].data.push({name:L,showAxisText:L!="&-"+A,value:""==F[M]||isNaN(parseFloat(F[M]))||null==F[M]||null==F[M]?0:F[M],tooltipValueShow:!isNaN(parseFloat(F[M]))})}}for(var R in r)l.push(r[R])}return l.forEach(function(t,e){t.key=T(t.name)+"-"+e}),l}function z(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:12,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"sans-serif",a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"50%",r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"middle",l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"...",s=t.append("text").style("text-anchor",r).style("font-size",i+"px").style("font-family",o).attr("dy","0.35em");return s.append("textPath").attr("startOffset",a).attr("xlink:href",function(){return"#"+e.attr("id")}).text(function(){var t=e.node().getTotalLength();return I(n,t,i,o,l)}),s}function V(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"sans-serif";if(!t.toString||!t)return 0;var i=d3.select("defs");i.empty()&&(i=d3.select("svg").append("defs"));var o=i.append("text").style("font-size",e+"px").style("font-family",n).text(t.toString()),a=o.node().getComputedTextLength();return o.remove(),a}function et(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"sans-serif";return Math.ceil(d3.max(t,function(t){return V(t,e,n)}))}function I(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:12,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"sans-serif",o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"...";if(V(t,n,i)<=e)return t;if(V(o,n,i)>=e)return"";for(var a=t.toString().split(""),r=a.length,l="",s=0;s<r;s++)if(V((l+=a[s])+o,n,i)>e)return 0===s?"":l.slice(0,s)+o}var p="legend-group",g=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","legend"),e.group=e.elem.append("g"),e._data=[],e._shapeType="circle",e._shapeWidth=12,e._shapeHeight=12,e._shapeStroke="none",e._rowGap=6,e._colGap=20,e._innerGap=6,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._limitedWidth=400,e._horizontalAlign="center",e._onClick=function(){},e._each=function(){},e._orient="horizontal",e}return u(n,a),l(n,[{key:"update",value:function(){var o=this,a=o.group,r=Math.max(o._shapeHeight,o._fontSize),l=o._limitedWidth-o._shapeWidth-o._innerGap,s=0,u=0;o.elem.selectAll("."+p).remove();var c=a.append("g").attr("class",p);o._data.forEach(function(t){var e=I(t.name?t.name:"",l,o._fontSize,o._fontFamily),n=o._shapeWidth+o._innerGap+V(e,o._fontSize,o._fontFamily);if("vertical"===o._orient)o._legendItem(t,c,0,u),u=u+r+o._rowGap;else{var i=s+n+o._colGap;i>o._limitedWidth&&(s=0,i=n+o._colGap,u+=r+o._rowGap,c=a.append("g").attr("class",p)),o._legendItem(t,c,s,u),s=i}});var t=at(a).width;return"center"===o._horizontalAlign?a.call(H,o._limitedWidth/2-t/2,0):"left"===o._horizontalAlign?a.call(H,0,0):"right"===o._horizontalAlign&&a.call(H,o._limitedWidth-t,0),o}},{key:"_shapeElem",value:function(t){var e=void 0;return(e="rect"===this._shapeType?t.append("rect").attr("width",this._shapeWidth).attr("height",this._shapeHeight):t.append("circle").attr("cx",this._shapeWidth/2).attr("cy",this._shapeHeight/2).attr("r",Math.min(this._shapeWidth,this._shapeHeight)/2)).attr("class","legend-shape"),e}},{key:"_legendItem",value:function(t,e,n,i){var o=e.append("g").datum(t).attr("class","legend-item").call(H,n,i).on("click",this._onClick).each(this._each);return this._shapeElem(o).style("fill",t.color),o.append("text").attr("x",this._shapeWidth+this._innerGap).attr("y",this._shapeHeight/2).attr("dy","0.35em").style("text-anchor","start").style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("fill",this._fontColor).text(I(t.name?t.name:"",this._limitedWidth-this._shapeWidth-this._innerGap,this._fontSize,this._fontFamily)),o}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"shapeType",value:function(t){return arguments.length?(this._shapeType=t,this):this._shapeType}},{key:"shapeWidth",value:function(t){return arguments.length?(this._shapeWidth=t,this):this._shapeWidth}},{key:"shapeHeight",value:function(t){return arguments.length?(this._shapeHeight=t,this):this._shapeHeight}},{key:"rowGap",value:function(t){return arguments.length?(this._rowGap=t,this):this._rowGap}},{key:"colGap",value:function(t){return arguments.length?(this._colGap=t,this):this._colGap}},{key:"innerGap",value:function(t){return arguments.length?(this._innerGap=t,this):this._innerGap}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"onClick",value:function(t){return arguments.length?(this._onClick=t,this):this._onClick}},{key:"each",value:function(t){return arguments.length?(this._each=t,this):this._each}}]),n}(),m=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("text"),e._text="",e._fontSize=24,e._fontFamily="noto",e._fontWeight="normal",e._color="#000",e._textAnchor="middle",e._dy="1em",e}return u(n,a),l(n,[{key:"update",value:function(){var t=this;return t.elem.attr("dy",t._dy).style("fill",t._color).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("font-weight",t._fontWeight).style("text-anchor",t._textAnchor).text(t._text),t}},{key:"text",value:function(t){return arguments.length?(this._text=t,this):this._text}},{key:"color",value:function(t){return arguments.length?(this._color=t,this):this._color}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontWeight",value:function(t){return arguments.length?(this._fontWeight=t,this):this._fontWeight}},{key:"textAnchor",value:function(t){return arguments.length?(this._textAnchor=t,this):this._textAnchor}},{key:"dy",value:function(t){return arguments.length?(this._dy=t,this):this._dy}}]),n}(),b=function(t){function i(t){r(this,i);var e=c(this,(i.__proto__||Object.getPrototypeOf(i)).call(this)),n=t._groups?t:d3.select(t);return e.elem=n.append("div").attr("class","chart-tooltip").style("position","absolute").style("pointer-events","none").style("-moz-user-select","none").style("-webkit-user-select","none").style("-ms-user-select","none").style("user-select","none"),"static"!=n.style("position")&&"initial"!=n.style("position")||n.style("position","relative"),e._data=[],e._x=0,e._y=0,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#fff",e._backgroundColor="rgba(0,0,0,0.7)",e._borderRadius=5,e._padding={top:5,right:8,bottom:5,left:8},e._textAlign="left",e._locked=!1,e._scale=1,e._scaleValue=1,e}return u(i,a),l(i,[{key:"update",value:function(){var t=this,e=t._fontSize;if(t._locked)return t;t._scaleValue="function"==typeof t._scale?t._scale():t._scale,t.elem.style("background-color",t._backgroundColor).style("border-radius",t._borderRadius+"px").style("font-size",e+"px").style("font-family",t._fontFamily).style("color",t._fontColor).style("text-align",t._textAlign).style("padding",t._padding.top+"px "+t._padding.right+"px "+t._padding.bottom+"px "+t._padding.left+"px");var n=t.elem.selectAll("div").data(t._data);n.exit().remove();var i=n.enter().append("div").attr("class","tooltip-row").style("white-space","nowrap");i.append("span").attr("class","tooltip-color-circle"),i.append("span").attr("class","tooltip-text");var o=i.merge(n);return o.select(".tooltip-color-circle").style("width","0px").style("height","0px").style("border-radius","50%").style("display","inline-block").style("margin","0px").style("vertical-align","middle").filter(function(t){return t.color}).style("width",e+"px").style("height",e+"px").style("background-color",function(t){return t.color}).style("margin-right","3px"),o.select(".tooltip-text").text(function(t){return t.text}).style("vertical-align","middle"),this}},{key:"move",value:function(t){var e=this;if(e._locked||!e.isShow)return e;var n=e._scaleValue||1,i=0,o=0,a=e.elem,r=a.node().parentNode,l=a.node().getBoundingClientRect(),s=r.getBoundingClientRect(),u=t||d3.mouse(r);return o=u[0]+l.width+8>s.width?u[0]-l.width-8:u[0]+8,i=u[1]+l.height+5>s.height?u[1]-l.height-0:u[1]+0,a.transition().duration(10).style("top",i/n+"px").style("left",o/n+"px"),e}},{key:"show",value:function(){return this._locked||(e(this.elem),this._show=!0),this}},{key:"hide",value:function(){return this._locked||(n(this.elem),this._show=!1),this}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"lock",value:function(t){return arguments.length?(this._locked=t,this):this._locked}},{key:"scale",value:function(t){return arguments.length?(this._scale=t,this):this._scale}}]),i}();function S(t,n){return t.forEach(function(t,e){t.color=n[e],t.color_special=n[e+1]}),t}var w=function(){function n(t,e){r(this,n),this._blockData=t,this._projectTheme=e,this._dataSrc=t.dataSrc,this._blockTheme=t.theme,this._props=t.props,this._columnMap=this._props.map,this._legend=this._props.legend,this._font=this._props.font,this._axis=this._props.axis,this._title=this._props.titleDisplay,this._label=this._props.label,this._display=this._props.display,this._animation=this._props.animation,this._dataSolveFunc=h}return l(n,[{key:"dataSolveFunc",value:function(t){return arguments.length&&"function"==typeof t?(this._dataSolveFunc=t,this):this._dataSolveFunc}},{key:"generateColorList",value:function(t){var e,n,i,o=this._props.colors.type,a=(e=this._props.colors.list,n=this._blockData,i=this._projectTheme,e.map(function(t){return function(t,e,n){var i=void 0;if("number"==typeof t){var o=e.theme&&e.theme.colors;i=o&&o[t%o.length]||n&&n.colors[t]||"#000"}else i=t;return i}(t,n,i)}));if(!t)return a;var r=a;switch(o){case"linear":var l=a.slice(0,2),s=d3.scaleLinear().domain([0,t-1]).range(l);r=d3.range(t).map(function(t,e){return s(e)});break;case"single":r=d3.range(t).map(function(){return a[0]});break;default:if(r=a.slice(0),a.length<t)for(var u=a.length;r.push(a[u%a.length]),++u<t;);}return r}},{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]);return S(t,this.generateColorList(t.length))}},{key:"dataType",get:function(){var t="2d";if("cross-table"===this._dataSrc.dataType)t="cross-table";else{var e=this._dataSrc.data;t=e[1]?"2sheet":e[0].length+"d"}return t}},{key:"width",get:function(){return parseFloat(this._props.size.width)-2}},{key:"height",get:function(){return parseFloat(this._props.size.height)-2}},{key:"font",get:function(){return{fontSize:this._font.fontSize||this._blockData.theme.fonts.fontSize||12,color:this._font.color||this._blockData.theme.fonts.fontColor||"#000",fontFamily:this._font.fontFamily||this._blockData.theme.fonts.fontFamily||"sans-serif"}}},{key:"display",get:function(){return Object.assign({},this._props.display)}},{key:"animation",get:function(){return Object.assign({},this._props.animation)}},{key:"legend",get:function(){return{show:!1!==this._legend.show,xPosition:this._legend.xPosition,yPosition:this._legend.yPosition}}},{key:"tooltipShow",get:function(){return this._props.tooltip}},{key:"axis",get:function(){return{color:this._axis.color||this._blockTheme.axis.color,x:this._axis.x,y:this._axis.y,y1:this._axis.y1}}},{key:"label",get:function(){return Object.assign({},this._props.label)}},{key:"grid",get:function(){var t=this._axis.grid;return{showX:null==t?null:"all"===t.show||"x"===t.show,showY:null==t?null:"all"===t.show||"y"===t.show,color:null==t?null:t.color||this._blockTheme.grid&&this._blockTheme.grid.color||"#ccc"}}},{key:"backgroundColor",get:function(){return this._props.backgroundColor||"transparent"}},{key:"colors",get:function(){return this._props.colors}},{key:"title",get:function(){var t=this._title||{};return{show:!1!==t.show,text:t.text||"",xPosition:t.xPosition||"center",yPosition:t.yPosition||"top",fontSize:t.fontSize||24,color:t.color||"#000",fontFamily:t.fontFamily||"noto"}}}]),n}(),O=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t._groups?t.append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1"):d3.select(t).append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1"),e.defs=e.elem.append("defs"),e.group=e.elem.append("g").attr("class","svg-group"),e.mainGroup=e.group.append("g").attr("class","main-group"),e.title=new m(e.group),e.legend=new g(e.group),e.tooltip=new b(t),e.labelTextClass="chart-label-text",e._data=[],e._width=400,e._height=400,e._backgroundColor=null,e._fontSize=12,e._fontColor="#000",e._fontFamily="sans-serif",e._transition=!0,e._duration=500,e._legendShow=!0,e._legendX="center",e._legendY="bottom",e._titleShow=!0,e._titleText="",e._titleX="center",e._titleY="top",e._titleFontSize=24,e._titleColor="#000",e._titleFontFamily="sans-serif",e._marginTop=20,e._marginRight=24,e._marginBottom=20,e._marginLeft=24,e._gapPadding=10,e._titlePadding=10,e._sortValue=0,e._sortedDataCopy=null,e._dataType="2d",e._tooltipShow=!0,e}return u(n,a),l(n,[{key:"_init",value:function(){var t=window.location.hostname,e="U2FsdGVkX1/u6EfnJcBwjl1lkrkHd1SLbqY/JBKMPPGUREtzJjAbYQ==";if(null==window.userId){e=t;var n=locked(t);"421aa90e079fa326b6494f812ad13e79"!=n&&"e5a748477660158b28c438af2cee80f6"!=n&&"31c49882abd53548158d8da55e154557"!=n||this.update()}else{var i=locked(e);window.userId==i&&this.update()}return String.prototype.cestqui=function(){return e},this}},{key:"update",value:function(){return this.styleSvg(),this.sortData(),this.removeLabelText(),this.updateTitle(),this.updateLegend(),this.updateCore(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateTitle",value:function(){var t=this,e=t.title;if(!t._titleShow)return e.hide();var n="center"===t._titleX?"middle":"left"===t._titleX?"start":"end";e.text(t._titleText).color(t._titleColor).fontSize(t._titleFontSize).fontFamily(t._titleFontFamily).fontWeight("bold").textAnchor(n).dy("1em"),e.update(),e.show()}},{key:"updateLegend",value:function(){var t=this,e=t.legend,n=this._width-this._marginLeft-this._marginRight;if(!t._legendShow)return e.hide();e.show(),e.limitedWidth(n).fontSize(t._fontSize).fontFamily(t._fontFamily).fontColor(t._fontColor).horizontalAlign(t._legendX).each(function(t){var e=!1===t.active;d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}),this.configLegend(),e.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy;t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"updateCore",value:function(){}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateCore()}},{key:"removeLabelText",value:function(){this.elem.selectAll("."+this.labelTextClass).remove()}},{key:"styleSvg",value:function(){this.elem.attr("width",this._width).attr("height",this._height).style("background-color",this._backgroundColor).style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("user-select","none"),this.group.call(H,this._marginLeft,this._marginTop)}},{key:"layout",value:function(){var t=this.title,e=this.legend,n=this.mainGroup,i=t.height(),o=e.height(),a=this.heightOfMainGroup,r=this._titleText&&this._titleShow?this._titlePadding:0,l=this._legendShow&&0!=o?this._gapPadding:0,s="top",u="bottom",c=this._titleY,h=this._legendY;c!==s&&c!==u&&(c=s),h!==s&&h!==u&&(h=u);var d=0,_=0,f=0;c===s&&h===s?(d=0,f=(_=i+r)+o+l):c===u&&h===u?(f=0,d=(_=a+l)+o+r):c===s&&h===u?(d=0,_=(f=i+r)+a+l):(_=0,d=(f=o+l)+a+r);var p=this._width-this._marginLeft-this._marginRight,y="center"===this._titleX?p/2:"left"===this._titleX?0:p;t.translate(y,d),e.translate(0,_),n.call(H,0,f)}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"backgroundColor",value:function(t){return arguments.length?(this._backgroundColor=t,this):this._backgroundColor}},{key:"legendShow",value:function(t){return arguments.length?(this._legendShow=t,this):this._legendShow}},{key:"legendX",value:function(t){return arguments.length?(this._legendX=t,this):this._legendX}},{key:"legendY",value:function(t){return arguments.length?(this._legendY=t,this):this._legendY}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"gapPadding",value:function(t){return arguments.length?(this._gapPadding=parseFloat(t),this):this._gapPadding}},{key:"marginTop",value:function(t){return arguments.length?(this._marginTop=parseFloat(t),this):this._marginTop}},{key:"marginRight",value:function(t){return arguments.length?(this._marginRight=parseFloat(t),this):this._marginRight}},{key:"marginBottom",value:function(t){return arguments.length?(this._marginBottom=parseFloat(t),this):this._marginBottom}},{key:"marginLeft",value:function(t){return arguments.length?(this._marginLeft=parseFloat(t),this):this._marginLeft}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"sortValue",value:function(t){return arguments.length?(this._sortValue=parseFloat(t),this):this._sortValue}},{key:"dataType",value:function(t){return arguments.length?(this._dataType=t,this):this._dataType}},{key:"tooltipShow",value:function(t){return arguments.length?(this._tooltipShow=t,this):this._tooltipShow}},{key:"titleShow",value:function(t){return arguments.length?(this._titleShow=t,this):this._titleShow}},{key:"titleText",value:function(t){return arguments.length?(this._titleText=t,this):this._titleText}},{key:"titleColor",value:function(t){return arguments.length?(this._titleColor=t,this):this._titleColor}},{key:"titleFontSize",value:function(t){return arguments.length?(this._titleFontSize=t,this):this._titleFontSize}},{key:"titleFontFamily",value:function(t){return arguments.length?(this._titleFontFamily=t,this):this._titleFontFamily}},{key:"titleX",value:function(t){return arguments.length?(this._titleX=t,this):this._titleX}},{key:"titleY",value:function(t){return arguments.length?(this._titleY=t,this):this._titleY}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"colors",value:function(t){return arguments.length?(this._colors=t,this):this._colors}},{key:"sortData",value:function(){var t=this._data.slice(0),e=this._sortValue,n=this._dataType,i=t.map(function(t){return t.color}),o=void 0;"cross-table"===n?(t.forEach(function(t){t.sum=d3.sum(t.data,function(t){return t.value})}),o=1===e?function(t,e){return t.sum-e.sum}:-1===e?function(t,e){return e.sum-t.sum}:null):o=1===e?function(t,e){return t.value-e.value}:-1===e?function(t,e){return e.value-t.value}:null,this._sortedDataCopy=o?t.sort(o).map(function(t,e){return t.color=i[e],t}):t}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=h;switch(n.dataType){case"cross-table":i=_;break;default:i=h}return n.dataSolveFunc(i),n}},{key:"setPublicOption",value:function(t){this.data(t.data).backgroundColor(t.backgroundColor).width(t.width).height(t.height).colorList(t._blockTheme.colors).colors(t.colors),this.fontFamily(t.font.fontFamily).fontSize(t.font.fontSize).fontColor(t.font.color),this.titleShow(t.title.show).titleText(t.title.text).titleColor(t.title.color).titleFontFamily(t.title.fontFamily).titleFontSize(t.title.fontSize).titleX(t.title.xPosition).titleY(t.title.yPosition),this.legendShow(t.legend.show).legendX(t.legend.xPosition).legendY(t.legend.yPosition),this.tooltipShow(t.tooltipShow),this.dataType(t.dataType)}},{key:"setSelfOption",value:function(t){}},{key:"setOption",value:function(t,e,n){var i=this.buildOption(t,e);this.setPublicOption(i),this.setSelfOption(i),this._init()}},{key:"widthOfNoMargin",get:function(){var t=this._width-this._marginLeft-this._marginRight;return 0<t?t:0}},{key:"heightOfNoMargin",get:function(){var t=this._height-this._marginTop-this._marginBottom;return 0<t?t:0}},{key:"heightOfMainGroup",get:function(){var t=this._titleText&&this._titleShow?this.title.height()+this._titlePadding:0,e=this._legendShow?this.legend.height()+(0==this.legend.height()?0:this._gapPadding):0,n=this.heightOfNoMargin-e-t;return 0<n?n:0}},{key:"activeData",get:function(){return C(this.sortedDataCopy)}},{key:"sortedDataCopy",get:function(){return this._sortedDataCopy}}]),n}(),A=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g"),e.group=e.elem.append("g"),e._data=[],e._transition=!0,e._duration=300,e._onTransitionStart=function(){},e._onTransitionEnd=function(){},e._onMouseover=function(){},e._onMousemove=function(){},e._onMouseout=function(){},e}return u(n,a),l(n,[{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"onTransitionStart",value:function(t){return arguments.length?(this._onTransitionStart="function"==typeof t?t:function(){},this):this._onTransitionStart}},{key:"onTransitionEnd",value:function(t){return arguments.length?(this._onTransitionEnd="function"==typeof t?t:function(){},this):this._onTransitionEnd}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),F=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pie"),e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e._innerRadius=0,e._outerRadius=0,e._startAngle=0,e._endAngle=2*Math.PI,e._cornerRadius=0,e._padAngle=.01,e._padRadius=null,e._areaBorderColor="#fff",e._areaBorderWidth=1,e._innerRadiusRatio=.75,e._sortMethod=null,e}return u(n,A),l(n,[{key:"update",value:function(){var o=this;o._data;o.arcFunc.innerRadius(o._innerRadius).outerRadius(o._outerRadius).cornerRadius(o._cornerRadius).padAngle(o._padAngle).padRadius(o._padRadius),o.pieFunc.value(function(t){return Math.abs(t.value)}).startAngle(o._startAngle).endAngle(o._endAngle).sort(o._sortMethod);var t=o.pieFunc(o._data);o.group.selectAll(".pie-path").remove();var e=o.group.selectAll("path").data(t);if(e.exit().remove(),e.merge(e.enter().append("path")).attr("class","pie-path").style("stroke",o._areaBorderColor).style("stroke-width",o._areaBorderWidth).style("fill",function(t){return t.data.color}).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout).transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attrTween("d",function(n){var i=d3.interpolateNumber(o._innerRadius,o._outerRadius);return function(t){var e=i(t);return o.arcFunc.outerRadius(e),o.arcFunc(n)}}).on("start",o._onTransitionStart).on("end",o._onTransitionEnd),o.group.selectAll(".pie-texts").remove(),o.group.selectAll(".pie-percents").remove(),o.group.selectAll(".pie-numbers").remove(),0==o._labelShow||null==o._labelShow||null==o._positionOptions||null==o._positionChoice||null==o._contentOption||null==o._contentChoice||0==o._positionOptions.indexOf(o._positionChoice)||2==o._positionOptions.indexOf(o._positionChoice)||-1==o._positionOptions.indexOf(o._positionChoice)||0==o._contentChoice.length)o.group.selectAll(".pie-texts text").style("display","none"),o.group.selectAll(".pie-percents text").style("display","none"),o.group.selectAll(".pie-numbers text").style("display","none");else if(1==o._positionOptions.indexOf(o._positionChoice)){var n=o.group.append("g").selectAll("g").data(t);n.exit().remove(),n.enter().append("g").attr("class","pie-text-groups").merge(n).each(function(t,e){d3.select(this).append("g").attr("class","pie-texts").append("text").text(t.data.name).attr("fill",o._fontColor).attr("font-size",o._fontSize).attr("font-family",o._fontFamily).attr("text-anchor","middle").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]-1.3*o._fontSize}),d3.select(this).append("g").attr("class","pie-percents").append("text").text(t.data.percent+"%").attr("fill",o._fontColor).attr("font-size",o._fontSize).attr("font-family",o._fontFamily).attr("text-anchor","middle").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]}),d3.select(this).append("g").attr("class","pie-numbers").append("text").text(t.data.value).attr("fill",o._fontColor).attr("font-size",o._fontSize).attr("font-family",o._fontFamily).attr("text-anchor","middle").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]+1.3*o._fontSize})}),1==o._contentChoice.length?0==o._contentOption.indexOf(o._contentChoice[0])?(o.group.selectAll(".pie-texts text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]}),o.group.selectAll(".pie-percents text").style("display","none"),o.group.selectAll(".pie-numbers text").style("display","none")):1==o._contentOption.indexOf(o._contentChoice[0])?(o.group.selectAll(".pie-percents text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]}),o.group.selectAll(".pie-texts text").style("display","none"),o.group.selectAll(".pie-numbers text").style("display","none")):2==o._contentOption.indexOf(o._contentChoice[0])&&(o.group.selectAll(".pie-numbers text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]}),o.group.selectAll(".pie-percents text").style("display","none"),o.group.selectAll(".pie-texts text").style("display","none")):2==o._contentChoice.length&&(0==o._contentOption.indexOf(o._contentChoice[0])&&1==o._contentOption.indexOf(o._contentChoice[1])||1==o._contentOption.indexOf(o._contentChoice[0])&&0==o._contentOption.indexOf(o._contentChoice[1])?(o.group.selectAll(".pie-texts text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]-o._fontSize/1.7}),o.group.selectAll(".pie-percents text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]+o._fontSize/1.7}),o.group.selectAll(".pie-numbers text").style("display","none")):0==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])||2==o._contentOption.indexOf(o._contentChoice[0])&&0==o._contentOption.indexOf(o._contentChoice[1])?(o.group.selectAll(".pie-texts text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]-o._fontSize/1.7}),o.group.selectAll(".pie-numbers text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]+o._fontSize/1.7}),o.group.selectAll(".pie-percents text").style("display","none")):(1==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])||2==o._contentOption.indexOf(o._contentChoice[0])&&1==o._contentOption.indexOf(o._contentChoice[1]))&&(o.group.selectAll(".pie-percents text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]-o._fontSize/1.7}),o.group.selectAll(".pie-numbers text").style("display","block").attr("x",function(t){return v(t)[0]}).attr("y",function(t){return v(t)[1]+o._fontSize/1.7}),o.group.selectAll(".pie-texts text").style("display","none")))}for(var i=o.group.selectAll(".pie-text-groups"),a=[],r=[],l=0;l<i._groups[0].length;l++){r.push(l);for(var s=l+1;s<i._groups[0].length;s++){rt(at(d3.select(i._groups[0][l])),at(d3.select(i._groups[0][s])))&&(a.push(l),d3.select(i._groups[0][l]).style("opacity","0"))}}for(var u=new Set(a),c=Array.from(u),h=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(c,r),d=0;d<c.length;d++){for(var _=[],f=0;f<h.length;f++){var p=at(d3.select(i._groups[0][c[d]])),y=at(d3.select(i._groups[0][h[f]]));if(_.push(rt(p,y)),rt(p,y)){if(c[d]==h[f])continue;d3.select(i._groups[0][c[d]]).style("opacity","0")}}0==_.filter(function(t){return 1==t}).length&&h.push(c[d])}for(var g=0;g<h.length;g++)d3.select(i._groups[0][h[g]]).style("opacity","1");function v(t){var e=.7*o._outerRadius,n=(t.startAngle+t.endAngle)/2-Math.PI/2;return[Math.cos(n)*e,Math.sin(n)*e]}return o}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}}]),n}(),R=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","outside-text-polygon"),e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e._innerRadius=0,e._outerRadius=0,e._startAngle=0,e._endAngle=2*Math.PI,e._cornerRadius=0,e._padAngle=0,e._padRadius=null,e._areaBorderColor="#fff",e._areaBorderWidth=1,e._sortMethod=null,e._type="normal",e._areaType="normal",e}return u(n,A),l(n,[{key:"update",value:function(){var o=this,t=d3.max(o._data,function(t){return Math.abs(t.value)}),e=o._outerRadius,i=d3.scaleLinear().domain([0,t]).range([0,e]),n=o.group;"normal"==o._type?o.pieFunc.value(function(t){return+t.value}).startAngle(o._startAngle).endAngle(o._endAngle).sort(o._sortMethod):o.pieFunc.value(1).startAngle(o._startAngle).endAngle(o._endAngle).sort(o._sortMethod);var a=o.pieFunc(o._data);function r(t){return t.startAngle+(t.endAngle-t.startAngle)/2}function l(t){var e="normal"==o._type?o._outerRadius:i(Math.abs(t.data.value)),n=(t.startAngle+t.endAngle)/2-Math.PI/2;return[Math.cos(n)*e,Math.sin(n)*e]}n.selectAll(".half-texts").remove(),n.selectAll(".half-percent").remove(),n.selectAll(".half-numbers").remove(),n.selectAll("g").remove();var s=n.append("g").selectAll("g").data(a);s.exit().remove(),s.enter().append("g").attr("class","pie-texts").merge(s).each(function(t,e){d3.select(this).append("g").attr("class","half-texts").append("text").text(t.data.name=="$-"+e?"":t.data.name).attr("dy","-0.6em").style("fill",o._fontColor).style("font-size",o._fontSize).style("font-family",o._fontFamily).attr("x",function(t){var e=l(t);return"normal"==o._areaType?1.2*e[0]+.1*o._outerRadius*(r(t)>Math.PI?-1:1):"half"==o._areaType?1.2*e[0]+.1*o._outerRadius*(r(t)<0?-1:1):void 0}).attr("y",function(t){return 1.2*l(t)[1]}).transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).styleTween("text-anchor",function(t){this._current=this._current||t;var n=d3.interpolate(this._current,t);return this._current=n(0),function(t){var e=n(t);return"normal"==o._areaType?r(e)<Math.PI||r(e)==Math.PI?"start":"end":"half"==o._areaType?0<r(e)||0==r(e)?"start":"end":void 0}}),d3.select(this).append("g").attr("class","half-percent").append("text").text(t.data.percent+"%").attr("dy","0.4em").style("fill",o._fontColor).style("font-size",o._fontSize).style("font-family",o._fontFamily).attr("x",function(t){var e=l(t);return"normal"==o._areaType?1.2*e[0]+.1*o._outerRadius*(r(t)>Math.PI?-1:1):"half"==o._areaType?1.2*e[0]+.1*o._outerRadius*(r(t)<0?-1:1):void 0}).attr("y",function(t){return 1.2*l(t)[1]}).transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).styleTween("text-anchor",function(t){this._current=this._current||t;var n=d3.interpolate(this._current,t);return this._current=n(0),function(t){var e=n(t);return"normal"==o._areaType?r(e)<Math.PI||r(e)==Math.PI?"start":"end":"half"==o._areaType?0<r(e)||0==r(e)?"start":"end":void 0}}),d3.select(this).append("g").attr("class","half-numbers").append("text").text(t.data.value).attr("dy","1.4em").style("fill",o._fontColor).style("font-size",o._fontSize).style("font-family",o._fontFamily).attr("x",function(t){var e=l(t);return"normal"==o._areaType?1.2*e[0]+.1*o._outerRadius*(r(t)>Math.PI?-1:1):"half"==o._areaType?1.2*e[0]+.1*o._outerRadius*(r(t)<0?-1:1):void 0}).attr("y",function(t){return 1.2*l(t)[1]}).transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).styleTween("text-anchor",function(t){this._current=this._current||t;var n=d3.interpolate(this._current,t);return this._current=n(0),function(t){var e=n(t);return"normal"==o._areaType?r(e)<Math.PI||r(e)==Math.PI?"start":"end":"half"==o._areaType?0<r(e)||0==r(e)?"start":"end":void 0}})}).transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attr("x",function(t){return 1.2*l(t)[0]+.1*o._outerRadius*(r(t)>Math.PI?-1:1)}).attr("y",function(t){return 1.2*l(t)[1]});var u=o.group.selectAll("polyline").data(a);u.exit().remove(),u.merge(u.enter().append("polyline")).style("stroke",function(t){return t.data.color}).style("fill","none").transition().duration(o._transition?o._duration:0).ease(d3.easeLinear).attrTween("points",function(t){this._current=this._current||t;var i=d3.interpolate(this._current,t);return this._current=i(0),function(t){var e=i(t),n=l(e);return"normal"==o._areaType?[n,1.2*n[0],1.2*n[1],1.2*n[0]+.1*o._outerRadius*(r(e)>Math.PI?-1:1),1.2*n[1]]:"half"==o._areaType?[n,1.2*n[0],1.2*n[1],1.2*n[0]+.1*o._outerRadius*(r(e)<0?-1:1),1.2*n[1]]:void 0}});n.selectAll(".half-texts text").nodes(),n.selectAll(".half-percent text").nodes(),n.selectAll(".half-numbers text").nodes(),n.selectAll("polyline").nodes();0==o._labelShow||null==o._labelShow||null==o._positionOptions||null==o._positionChoice||null==o._contentOption||null==o._contentChoice||0==o._contentChoice.length||-1==o._positionOptions.indexOf(o._positionChoice)?(n.selectAll(".half-texts text").style("display","none"),n.selectAll(".half-percent text").style("display","none"),n.selectAll(".half-numbers text").style("display","none"),n.selectAll("polyline").style("display","none")):0!=o._positionOptions.indexOf(o._positionChoice)&&2!=o._positionOptions.indexOf(o._positionChoice)||(1==o._contentChoice.length?0==o._contentOption.indexOf(o._contentChoice[0])?(n.selectAll(".half-texts text").style("display","block").attr("dy","0.3em"),n.selectAll(".half-percent text").style("display","none"),n.selectAll(".half-numbers text").style("display","none"),n.selectAll("polyline").style("display","block")):1==o._contentOption.indexOf(o._contentChoice[0])?(n.selectAll(".half-percent text").style("display","block").attr("dy","0.3em"),n.selectAll(".half-texts text").style("display","none"),n.selectAll(".half-numbers text").style("display","none"),n.selectAll("polyline").style("display","block")):2==o._contentOption.indexOf(o._contentChoice[0])&&(n.selectAll(".half-numbers text").style("display","block").attr("dy","0.3em"),n.selectAll(".half-percent text").style("display","none"),n.selectAll(".half-texts text").style("display","none"),n.selectAll("polyline").style("display","block")):2==o._contentChoice.length&&(0==o._contentOption.indexOf(o._contentChoice[0])&&1==o._contentOption.indexOf(o._contentChoice[1])||1==o._contentOption.indexOf(o._contentChoice[0])&&0==o._contentOption.indexOf(o._contentChoice[1])?(n.selectAll(".half-texts text").style("display","block").attr("dy","-0.1em"),n.selectAll(".half-percent text").style("display","block").attr("dy","0.9em"),n.selectAll(".half-numbers text").style("display","none"),n.selectAll("polyline").style("display","block")):0==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])||2==o._contentOption.indexOf(o._contentChoice[0])&&0==o._contentOption.indexOf(o._contentChoice[1])?(n.selectAll(".half-texts text").style("display","block").attr("dy","-0.1em"),n.selectAll(".half-numbers text").style("display","block").attr("dy","0.9em"),n.selectAll(".half-percent text").style("display","none"),n.selectAll("polyline").style("display","block")):(1==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])||2==o._contentOption.indexOf(o._contentChoice[0])&&1==o._contentOption.indexOf(o._contentChoice[1]))&&(n.selectAll(".half-percent text").style("display","block").attr("dy","-0.1em"),n.selectAll(".half-numbers text").style("display","block").attr("dy","0.9em"),n.selectAll(".half-texts text").style("display","none"),n.selectAll("polyline").style("display","block"))));for(var c=n.selectAll(".pie-texts"),h=n.selectAll("polyline"),d=[],_=[],f=0;f<c._groups[0].length;f++){_.push(f);for(var p=f+1;p<c._groups[0].length;p++){rt(at(d3.select(c._groups[0][f])),at(d3.select(c._groups[0][p])))&&(d.push(f),d3.select(c._groups[0][f]).style("opacity","0"),d3.select(h._groups[0][f]).style("opacity","0"))}}for(var y=new Set(d),g=Array.from(y),v=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(g,_),x=0;x<g.length;x++){for(var m=[],k=0;k<v.length;k++){var b=at(d3.select(c._groups[0][g[x]])),S=at(d3.select(c._groups[0][v[k]]));if(m.push(rt(b,S)),rt(b,S)){if(g[x]==v[k])continue;d3.select(c._groups[0][g[x]]).style("opacity","0"),d3.select(h._groups[0][g[x]]).style("opacity","0")}}0==m.filter(function(t){return 1==t}).length&&v.push(g[x])}for(var w=0;w<v.length;w++)d3.select(c._groups[0][v[w]]).style("opacity","1"),d3.select(h._groups[0][v[w]]).style("opacity","1");return o}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"values",value:function(t){return arguments.length?(this._values=t,this):this._values}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"areaType",value:function(t){return arguments.length?(this._areaType=t,this):this._areaType}},{key:"level",value:function(t){return arguments.length?(this._level=t,this):this._level}}]),n}(),D=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","round-corner-donut-chart"),e.core=e.pie=new F(e.mainGroup),e.lineText=new R(e.mainGroup),e._innerRadius=0,e._padAngle=.01,e._startAngle=0,e._endAngle=2*Math.PI,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=10,e._areaBorderColor="#fff",e._areaBorderWidth=0,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){for(var r=this,o=r.pie,t=r.lineText,e=r.widthOfNoMargin,n=(r.legend.height(),[]),i=0;i<r.activeData.length;i++)n.push(r.activeData[i].name);et(n,r._fontSize,r._fontFamily);var a=.74*r.heightOfMainGroup,l=.88*r.widthOfNoMargin;null==r._labelShow||null==r._positionOptions||null==r._positionChoice||null==r._contentOption||null==r._contentChoice||0==r._contentChoice.length?(a=.88*r.heightOfMainGroup,l=.88*r.widthOfNoMargin):0!=r._labelShow&&1!=r._positionOptions.indexOf(r._positionChoice)&&-1!=r._positionOptions.indexOf(r._positionChoice)||(a=.88*r.heightOfMainGroup,l=.88*r.widthOfNoMargin);for(var s=r._startAngle,u=r._endAngle,c=M(l,a,s,u),h=c.radius,d=r._innerRadius||(r._innerRadiusRatio?r._innerRadiusRatio*h:0),_=[],f=0;f<r.activeData.length;f++)_.push(r.activeData[f].value);for(var p=0,y=0;y<r.activeData.length;y++)p+=r.activeData[y].value;for(var g=0;g<r.activeData.length;g++)r.activeData[g].percent=(r.activeData[g].value/p*100).toFixed(1);o.data(r.activeData).innerRadius(d).outerRadius(h).cornerRadius(r._cornerRadius).areaBorderColor(r._areaBorderColor).areaBorderWidth(r._areaBorderWidth).startAngle(s).endAngle(u).padAngle(r._padAngle).transition(r._transition).duration(r._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode),i="arc-path-"+t.data.key.replace(/\s*/g,"")+"-"+r.id,o=L((d+h)*r._labelRadiusRatio,t.startAngle+.025,t.endAngle-.025),a=r.defs.select("#"+i).empty()?r.defs.append("path").attr("d",o).attr("id",i):r.defs.select("#"+i).attr("d",o);0==r._labelShow||null==r._labelShow||null==r._positionOptions||null==r._positionChoice||null==r._contentOption||null==r._contentChoice||0==r._positionOptions.indexOf(r._positionChoice)||0==r._contentChoice.length?r.group.selectAll(".chart-label-text").style("display","none"):1==r._positionOptions.indexOf(r._positionChoice)&&(1==r._contentChoice.length?0==r._contentOption.indexOf(r._contentChoice[0])?z(n,a,t.data.name=="$-"+e?"":t.data.name,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily):1==r._contentOption.indexOf(r._contentChoice[0])?z(n,a,t.data.percent+"%",r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily):2==r._contentOption.indexOf(r._contentChoice[0])&&z(n,a,t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily):2==r._contentChoice.length?0==r._contentOption.indexOf(r._contentChoice[0])&&1==r._contentOption.indexOf(r._contentChoice[1])||1==r._contentOption.indexOf(r._contentChoice[0])&&0==r._contentOption.indexOf(r._contentChoice[1])?z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%",r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==r._contentOption.indexOf(r._contentChoice[0])&&2==r._contentOption.indexOf(r._contentChoice[1])||2==r._contentOption.indexOf(r._contentChoice[0])&&0==r._contentOption.indexOf(r._contentChoice[1])?z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==r._contentOption.indexOf(r._contentChoice[0])&&2==r._contentOption.indexOf(r._contentChoice[1])||2==r._contentOption.indexOf(r._contentChoice[0])&&1==r._contentOption.indexOf(r._contentChoice[1]))&&z(n,a,t.data.percent+"%  "+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==r._contentChoice.length&&z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%  "+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"))}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(h,1.05*h);return function(t){var e=n(t);return o.arcFunc.outerRadius(e),o.arcFunc(i)}});var e=[{text:""+(i.data.name=="$-"+t?"":i.data.name),color:i.data.color},{text:i.data.valueLabel+": "+i.data.value}];r.tooltip.data(e).update().show()}).onMousemove(function(){r.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*h,h);return function(t){var e=n(t);return o.arcFunc.outerRadius(e),o.arcFunc(i)}}),r.tooltip.hide()});var v=c.cx+(e-l)/2,x=r.heightOfMainGroup/2;null!=r._labelShow&&(0!=r._labelShow&&0==r._positionOptions.indexOf(r._positionChoice)?(t.data(r.activeData).innerRadius(d).outerRadius(h).cornerRadius(r._cornerRadius).startAngle(s).endAngle(u).fontSize(r._textLabel.fontSize).fontColor(r._textLabel.color).fontFamily(r._textLabel.fontFamily).labelShow(r._labelShow).positionOptions(r._positionOptions).positionChoice(r._positionChoice).contentOption(r._contentOption).contentChoice(r._contentChoice).values(_).transition(r._transition).duration(r._duration),r.lineText.translate(v||0,x).update(),r.group.select(".outside-text-polygon").attr("display","block")):0!=r._labelShow&&1!=r._positionOptions.indexOf(r._positionChoice)&&-1!=r._positionOptions.indexOf(r._positionChoice)||r.group.select(".outside-text-polygon").attr("display","none")),r.pie.translate(v||0,x).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(o(e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._contentChoice=n.contentChoice?n.contentChoice:this._contentChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),n}(),j=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pie-chart"),e.core=e.pie=new F(e.mainGroup),e.lineText=new R(e.mainGroup),e._innerRadius=0,e._cornerRadius=null,e._padAngle=0,e._startAngle=0,e._endAngle=2*Math.PI,e._marginTop=20,e._marginRight=24,e._marginBottom=20,e._marginLeft=24,e._gapPadding=10,e._labelRadiusRatio=.8,e._innerRadiusRatio=null,e._areaBorderWidth=1,e._areaBorderColor="#fff",e._labelShow=!1,e._positionOptions=["","",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){for(var r=this,l=r.pie,t=r.lineText,e=r.widthOfNoMargin,n=(r.legend.height(),[]),i=0;i<r.activeData.length;i++)n.push(r.activeData[i].name);et(n,r._fontSize,r._fontFamily);var o=.74*r.heightOfMainGroup,a=.74*r.widthOfNoMargin;null==r._labelShow||null==r._positionOptions||null==r._positionChoice||null==r._contentOption||null==r._contentChoice||0==r._contentChoice.length?(o=.88*r.heightOfMainGroup,a=.88*r.widthOfNoMargin):0!=r._labelShow&&0!=r._positionOptions.indexOf(r._positionChoice)&&1!=r._positionOptions.indexOf(r._positionChoice)&&-1!=r._positionOptions.indexOf(r._positionChoice)||(o=.88*r.heightOfMainGroup,a=.88*r.widthOfNoMargin);for(var s=r._startAngle,u=r._endAngle,c=M(a,o,s,u),h=c.radius,d=r._innerRadius||(r._innerRadiusRatio?r._innerRadiusRatio*h:0),_=[],f=0;f<r.activeData.length;f++)_.push(r.activeData[f].value);for(var p=0,y=0;y<r.activeData.length;y++)p+=r.activeData[y].value;for(var g=0;g<r.activeData.length;g++)r.activeData[g].percent=(r.activeData[g].value/p*100).toFixed(1);var v=r.activeData.sort(function(t,e){return e.key.slice(-1)-t.key.slice(-1)});v.unshift(v[v.length-1]),v.pop(v[v.length-1]),l.data(v).fontSize(r._textLabel.fontSize).fontColor(r._textLabel.color).fontFamily(r._textLabel.fontFamily).labelShow(r._labelShow).positionOptions(r._positionOptions).positionChoice(r._positionChoice).contentOption(r._contentOption).contentChoice(r._contentChoice).innerRadius(d).outerRadius(h).cornerRadius(r._cornerRadius).areaBorderColor(r._areaBorderColor).areaBorderWidth(r._areaBorderWidth).startAngle(s).endAngle(u).padAngle(r._padAngle).transition(r._transition).duration(r._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode);if(1!=l.data().length){var i="arc-path-"+t.data.key.replace(/\s*/g,"")+"-"+r.id,o=L((d+h)*r._labelRadiusRatio,t.startAngle+.025,t.endAngle-.025),a=r.defs.select("#"+i).empty()?r.defs.append("path").attr("d",o).attr("id",i):r.defs.select("#"+i).attr("d",o);0==r._labelShow||null==r._labelShow||null==r._positionOptions||null==r._positionChoice||null==r._contentOption||null==r._contentChoice||1==r._positionOptions.indexOf(r._positionChoice)||2==r._positionOptions.indexOf(r._positionChoice)||0==r._contentChoice.length?r.group.selectAll(".chart-label-text").style("display","none"):0==r._positionOptions.indexOf(r._positionChoice)&&(1==r._contentChoice.length?0==r._contentOption.indexOf(r._contentChoice[0])?z(n,a,t.data.name=="$-"+e?"":t.data.name,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily):1==r._contentOption.indexOf(r._contentChoice[0])?z(n,a,t.data.percent+"%",r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily):2==r._contentOption.indexOf(r._contentChoice[0])&&z(n,a,t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily):2==r._contentChoice.length?0==r._contentOption.indexOf(r._contentChoice[0])&&1==r._contentOption.indexOf(r._contentChoice[1])||1==r._contentOption.indexOf(r._contentChoice[0])&&0==r._contentOption.indexOf(r._contentChoice[1])?z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%",r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==r._contentOption.indexOf(r._contentChoice[0])&&2==r._contentOption.indexOf(r._contentChoice[1])||2==r._contentOption.indexOf(r._contentChoice[0])&&0==r._contentOption.indexOf(r._contentChoice[1])?z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==r._contentOption.indexOf(r._contentChoice[0])&&2==r._contentOption.indexOf(r._contentChoice[1])||2==r._contentOption.indexOf(r._contentChoice[0])&&1==r._contentOption.indexOf(r._contentChoice[1]))&&z(n,a,t.data.percent+"%  "+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==r._contentChoice.length&&z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%  "+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily,"52%").attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"))}else n.append("text").attr("class",r.labelTextClass).attr("dy","0.35em").style("text-anchor","middle").text(t.data.name=="$-"+e?"":t.data.name).style("pointer-events","none")}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(h,1.05*h);return function(t){var e=n(t);return l.arcFunc.outerRadius(e),l.arcFunc(i)}});var e=[{text:""+(i.data.name=="$-"+t?"":i.data.name),color:i.data.color},{text:i.data.valueLabel+": "+i.data.value}];r.tooltip.data(e).update().show()}).onMousemove(function(){r.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*h,h);return function(t){var e=n(t);return l.arcFunc.outerRadius(e),l.arcFunc(i)}}),r.tooltip.hide()});var x=c.cx+(e-a)/2,m=r.heightOfMainGroup/2;if(null!=r._labelShow)if(0!=r._labelShow&&2==r._positionOptions.indexOf(r._positionChoice)){var k=r.activeData.sort(function(t,e){return e.key.slice(-1)-t.key.slice(-1)});k.unshift(k[k.length-1]),k.pop(k[k.length-1]),t.data(k).innerRadius(d).outerRadius(h).cornerRadius(r._cornerRadius).startAngle(s).endAngle(u).fontSize(r._textLabel.fontSize).fontColor(r._textLabel.color).fontFamily(r._textLabel.fontFamily).labelShow(r._labelShow).positionOptions(r._positionOptions).positionChoice(r._positionChoice).contentOption(r._contentOption).contentChoice(r._contentChoice).values(_).transition(r._transition).duration(r._duration),r.lineText.translate(x||0,m).update(),r.group.selectAll(".outside-text-polygon").attr("display","block")}else 0!=r._labelShow&&0!=r._positionOptions.indexOf(r._positionChoice)&&1!=r._positionOptions.indexOf(r._positionChoice)&&-1!=r._positionOptions.indexOf(r._positionChoice)||r.group.selectAll(".outside-text-polygon").attr("display","none");r.pie.translate(x||0,m).update()}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label,i=t.animation;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(o(e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._contentChoice=n.contentChoice?n.contentChoice:this._contentChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(i).length&&(this._duration=i.duration?i.duration:this._duration,this._startDelay=i.startDelay?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause)}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),n}(),N=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._padAngle=.01,e._labelRadiusRatio=.8,e._labelRadiusRatio=.8,e._innerRadiusRatio=null,e._areaBorderWidth=1,e._areaBorderColor="#fff",e._cornerRadius=10,e._labelShow=!0,e._positionOptions=["","",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,j),l(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(o(e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._contentChoice=n.contentChoice?n.contentChoice:this._contentChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}}]),n}(),G=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","wave-circle"),e.group=e.elem.append("g"),e._outerDonut=e.group.append("path"),e._innerCircle=e.group.append("circle"),e._textElem=e.group.append("text"),e._clipTextElem=e.group.append("text"),e._waveClip=e.group.append("defs").append("clipPath"),e._waveClipPath=e._waveClip.append("path"),e._radius=50,e._value=60,e._clipId=i("wave-clip"),e._waveCount=3,e._waveColor="#178BCA",e._outerCircleColor=null,e._minValue=0,e._maxValue=100,e._circleThickness=.05,e._circleFillGap=.05,e._waveHeightRatio=.05,e._waveRiseTime=1e3,e._waveAnimateTime=1500,e._waveRise=!0,e._textSize=.5,e._textSuffix="%",e._textColor="#045681",e._waveTextColor="#A4DBf8",e}return u(n,a),l(n,[{key:"update",value:function(){for(var i=this,t=i._radius,e=i._radius,n=i._circleThickness*i._radius,o=i._circleFillGap*i._radius,a=i._radius-n-o,r=i._textSize*i._radius,l=2*i._radius/i._waveCount,s=i._waveCount+1,u=l*s,c=i._waveHeightRatio*i._radius,h=(1-(i.value<i._minValue?i._minValue:i.value>i._maxValue?i._maxValue:i.value)/(i._maxValue-i._minValue))*i._radius*2,d=[],_=0;_<100;_++){var f=_*(s*Math.PI*2)/100,p=Math.sin(f);d.push({x:f,y:p})}var y,g,v=d3.scaleLinear().domain([0,2*Math.PI*s]).range([0,u]),x=d3.scaleLinear().domain([-1,1]).range([0,c]),m=d3.area().x(function(t){return v(t.x)}).y0(function(t){return x(t.y)}).y1(function(t){return 2*i._radius});return i._waveClip.attr("id",i._clipId).call(H,0,h),i._waveClipPath.datum(d).attr("d",m),i._outerDonut.attr("d",d3.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(i._radius-n).outerRadius(i._radius)).style("fill",i._outerCircleColor||i._waveColor).call(H,t,e),i._innerCircle.attr("cx",t).attr("cy",e).attr("r",a).style("fill",i._waveColor).attr("clip-path","url("+k("#"+i._clipId)+")"),i._textElem.attr("x",t).attr("y",e).attr("text-anchor","middle").attr("font-size",r+"px").attr("dy","0.35em").style("fill",i._textColor).text(i.value+i._textSuffix),i._clipTextElem.attr("x",t).attr("y",e).attr("text-anchor","middle").attr("font-size",r+"px").attr("dy","0.35em").style("fill",i._waveTextColor).text(i.value+i._textSuffix).attr("clip-path","url("+k("#"+i._clipId)+")"),y=d3.transition().duration(i._waveRiseTime).ease(d3.easeLinear),g=function(){var e=this,n=d3.interpolate(i._minValue,i.value);return function(t){e.textContent=d3.format("d")(n(t))+i._textSuffix}},i._waveClip.call(H,0,2*i._radius).transition(y).call(H,0,h),i._textElem.text("0"+i._textSuffix).transition(y).tween("text",g),i._clipTextElem.text("0"+i._textSuffix).transition(y).tween("text",g),function t(){i._waveClipPath.attr("transform","translate("+(-u+2*i._radius)+",0)").transition().duration(i._waveAnimateTime).ease(d3.easeLinear).attr("transform","translate(0,0)").on("end",t)}(),i}},{key:"value",value:function(t){return arguments.length?(this.value=t,this):this.value}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"waveColor",value:function(t){return arguments.length?(this._waveColor=t,this):this._waveColor}},{key:"waveCount",value:function(t){return arguments.length?(this._waveCount=t,this):this._waveCount}}]),n}(),B=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","wave-circle-chart"),e._circleMargin=2,e._labelMargin=2,e._maxCountOfOneLine=5,e}return u(n,O),l(n,[{key:"updateCore",value:function(){var e=this,t=e.activeData,n=t.length,o=e.widthOfNoMargin,i=e.heightOfMainGroup,a=Math.min(e._maxCountOfOneLine,n),r=Math.ceil(n/a),l=o/a,s=i/r,u=1.2*e.fontSize()+2*e._labelMargin,c=s-u,h=(Math.min(l,c)-2*e._circleMargin)/2,d=e.mainGroup.selectAll("g.wave-circle-item").data(t,function(t){return t.name});if(d.exit().remove(),t.length){var _=d.enter().append("g").attr("class","wave-circle-item");_.append("g"),_.append("text").attr("class",e.labelTextClass);var f=_.merge(d);f.select("g").call(H,e._circleMargin+l/2-h,e._circleMargin+c/2-h).each(function(t,e){d3.select(this).selectAll("*").remove(),new G(d3.select(this)).radius(h).waveColor(t.color).value(t.value).update()}),f.select("."+this.labelTextClass).call(H,l/2,2*e._circleMargin+c/2+h+e._labelMargin).attr("dy","0.85em").style("text-anchor","middle").style("fill",e._fontColor).text(function(t){return t.showLegend?I(t.name,l,e._fontSize,e._fontFamily):""});var p=n%a,y=(Math.ceil(n/a)-1)*a;f.attr("transform",function(t,e){var n=e%a*l,i=Math.floor(e/a)*s;return p&&y<=e&&(n=o/p*(e%a+.5)-h),"translate("+n+","+i+")"})}}},{key:"removeLabelText",value:function(){}},{key:"maxCountOfOneLine",value:function(t){return arguments.length?(this._maxCountOfOneLine=t,this):this._maxCountOfOneLine}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}}]),n}(),E=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rose-pie"),e._stroke="#fff",e._strokeWidth=1,e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._radius=0,e._cornerRadius=0,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n._data,e=n._startAngle,i=n._endAngle,o=d3.max(t,function(t){return Math.abs(t.value)}),a=n._radius,r=d3.scaleLinear().domain([0,o]).range([0,a]),l=n.arcFunc.innerRadius(0).outerRadius(function(t){return r(Math.abs(t.data.value))}).cornerRadius(n._cornerRadius),s=n.pieFunc.value(1).startAngle(e).endAngle(i).sort(n._sortMethod),u=n.group.selectAll("g.arc-group").data(s(t));u.exit().remove();var c=u.enter().append("g").attr("class","arc-group");if(c.append("path"),u.merge(c).on("mouseover",n._onMouseover).on("mousemove",n._onMousemove).on("mouseout",n._onMouseout).select("path").style("stroke",n._stroke).style("stroke-width",n._strokeWidth).style("fill",function(t){return t.data.color}).transition().duration(n._transition?n._duration:0).ease(d3.easeLinear).attrTween("d",function(n){var i=d3.interpolateNumber(0,r(Math.abs(n.data.value)));return function(t){var e=i(t);return l.outerRadius(e),l(n)}}).on("start",n._onTransitionStart).on("end",n._onTransitionEnd),n.group.selectAll(".pie-texts").remove(),n.group.selectAll(".pie-percents").remove(),n.group.selectAll(".pie-numbers").remove(),0==n._labelShow||null==n._labelShow||null==n._positionOptions||null==n._positionChoice||null==n._contentOption||null==n._contentChoice||0==n._positionOptions.indexOf(n._positionChoice)||2==n._positionOptions.indexOf(n._positionChoice)||-1==n._positionOptions.indexOf(n._positionChoice)||0==n._contentChoice.length)n.group.selectAll(".pie-texts text").style("display","none"),n.group.selectAll(".pie-percents text").style("display","none"),n.group.selectAll(".pie-numbers text").style("display","none");else if(1==n._positionOptions.indexOf(n._positionChoice)){var h=n.group.append("g").selectAll("g").data(s(t));h.exit().remove(),h.enter().append("g").attr("class","pie-text-groups").merge(h).each(function(t,e){d3.select(this).append("g").attr("class","pie-texts").append("text").text(t.data.name).attr("fill",n._fontColor).attr("font-size",n._fontSize).attr("font-family",n._fontFamily).attr("text-anchor","middle").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]-1.3*n._fontSize}),d3.select(this).append("g").attr("class","pie-percents").append("text").text(t.data.percent+"%").attr("fill",n._fontColor).attr("font-size",n._fontSize).attr("font-family",n._fontFamily).attr("text-anchor","middle").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]}),d3.select(this).append("g").attr("class","pie-numbers").append("text").text(t.data.value).attr("fill",n._fontColor).attr("font-size",n._fontSize).attr("font-family",n._fontFamily).attr("text-anchor","middle").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]+1.3*n._fontSize})}),1==n._contentChoice.length?0==n._contentOption.indexOf(n._contentChoice[0])?(n.group.selectAll(".pie-texts text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]}),n.group.selectAll(".pie-percents text").style("display","none"),n.group.selectAll(".pie-numbers text").style("display","none")):1==n._contentOption.indexOf(n._contentChoice[0])?(n.group.selectAll(".pie-percents text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]}),n.group.selectAll(".pie-texts text").style("display","none"),n.group.selectAll(".pie-numbers text").style("display","none")):2==n._contentOption.indexOf(n._contentChoice[0])&&(n.group.selectAll(".pie-numbers text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]}),n.group.selectAll(".pie-percents text").style("display","none"),n.group.selectAll(".pie-texts text").style("display","none")):2==n._contentChoice.length&&(0==n._contentOption.indexOf(n._contentChoice[0])&&1==n._contentOption.indexOf(n._contentChoice[1])||1==n._contentOption.indexOf(n._contentChoice[0])&&0==n._contentOption.indexOf(n._contentChoice[1])?(n.group.selectAll(".pie-texts text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]-n._fontSize/1.7}),n.group.selectAll(".pie-percents text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]+n._fontSize/1.7}),n.group.selectAll(".pie-numbers text").style("display","none")):0==n._contentOption.indexOf(n._contentChoice[0])&&2==n._contentOption.indexOf(n._contentChoice[1])||2==n._contentOption.indexOf(n._contentChoice[0])&&0==n._contentOption.indexOf(n._contentChoice[1])?(n.group.selectAll(".pie-texts text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]-n._fontSize/1.7}),n.group.selectAll(".pie-numbers text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]+n._fontSize/1.7}),n.group.selectAll(".pie-percents text").style("display","none")):(1==n._contentOption.indexOf(n._contentChoice[0])&&2==n._contentOption.indexOf(n._contentChoice[1])||2==n._contentOption.indexOf(n._contentChoice[0])&&1==n._contentOption.indexOf(n._contentChoice[1]))&&(n.group.selectAll(".pie-percents text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]-n._fontSize/1.7}),n.group.selectAll(".pie-numbers text").style("display","block").attr("x",function(t){return C(t)[0]}).attr("y",function(t){return C(t)[1]+n._fontSize/1.7}),n.group.selectAll(".pie-texts text").style("display","none")))}for(var d=n.group.selectAll(".pie-text-groups"),_=[],f=[],p=0;p<d._groups[0].length;p++){f.push(p);for(var y=p+1;y<d._groups[0].length;y++){rt(at(d3.select(d._groups[0][p])),at(d3.select(d._groups[0][y])))&&(_.push(p),d3.select(d._groups[0][p]).style("opacity","0"))}}for(var g=new Set(_),v=Array.from(g),x=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(v,f),m=0;m<v.length;m++){for(var k=[],b=0;b<x.length;b++){var S=at(d3.select(d._groups[0][v[m]])),w=at(d3.select(d._groups[0][x[b]]));if(k.push(rt(S,w)),rt(S,w)){if(v[m]==x[b])continue;d3.select(d._groups[0][v[m]]).style("opacity","0")}}0==k.filter(function(t){return 1==t}).length&&x.push(v[m])}for(var O=0;O<x.length;O++)d3.select(d._groups[0][x[O]]).style("opacity","1");function C(t){var e=.7*r(Math.abs(t.data.value)),n=(t.startAngle+t.endAngle)/2-Math.PI/2;return[Math.cos(n)*e,Math.sin(n)*e]}}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}}]),n}(),Y=function(t){function e(){r(this,e);var t=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._showX=!0,t._showY=!0,t._stroke="#ccc",t._strokeDasharray="2 2",t}return u(e,a),l(e,[{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}}]),e}(),X="grid-arc-path",Z="grid-line",Q=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","polar-grid"),e.group=e.elem.append("g"),e._radius=100,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=5,e}return u(n,Y),l(n,[{key:"update",value:function(){var n=this,o=n._startAngle,a=n._endAngle,r=n._radius,l=n.group.style("fill","none").style("stroke",n._stroke).style("stroke-dasharray",n._strokeDasharray);!function(){if(!n._showX)return l.selectAll("."+X).remove();var i=n._donutCount,t=l.selectAll("."+X).data(d3.range(i));t.exit().remove(),t.enter().append("path").attr("class",X).merge(t).attr("d",function(t,e){var n=r/i*(e+1);return L(n,o,a)})}(),function(){if(!n._showY)return l.selectAll("."+Z).remove();var t=n._sectorCount||1,i=(a-o)/t,e=l.selectAll("."+Z).data(d3.range(t+1));e.exit().remove(),e.enter().append("line").attr("class",Z).merge(e).attr("x1",0).attr("y1",0).attr("x2",function(t,e){var n=o+i*e;return Math.cos(n-Math.PI/2)*r}).attr("y2",function(t,e){var n=o+i*e;return Math.sin(n-Math.PI/2)*r})}()}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=parseFloat(t),this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}}]),n}(),q=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.grid=null,e._gridStroke="#ccc",e._gridStrokeDasharray="3 3",e._gridShowX=!0,e._gridShowY=!0,e}return u(n,O),l(n,[{key:"gridStroke",value:function(t){return arguments.length?(this._gridStroke=t,this):this._gridStroke}},{key:"gridStrokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}},{key:"gridShowX",value:function(t){return arguments.length?(this._gridShowX=t,this):this._gridShowX}},{key:"gridShowY",value:function(t){return arguments.length?(this._gridShowY=t,this):this._gridShowY}},{key:"setPublicOption",value:function(t){s(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setPublicOption",this).call(this,t);var e=t.grid;this.gridStroke(e.color).gridShowX(e.showX).gridShowY(e.showY)}}]),n}(),U=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rose-chart"),e.core=e.rose=new E(e.mainGroup),e.grid=new Q(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e._labelShow=!0,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,q),l(n,[{key:"updateCore",value:function(){var c=this,h=c.rose,t=c.grid,e=c._startAngle,n=c._endAngle,i=c.widthOfNoMargin,o=c.heightOfMainGroup,d=c._fontSize,a=.8*i,r=.8*o,l=M(a,r,e,n),s=l.radius,u=l.cx,_=l.cy,f=s+10,p=f+d;t.donutCount(6).sectorCount(c.activeData.length).startAngle(e).endAngle(n).radius(f).stroke(c._gridStroke).strokeDasharray(c._gridStrokeDasharray).showX(c._gridShowX).showY(c._gridShowY),h.data(c.activeData).radius(s).startAngle(e).endAngle(n).cornerRadius(c._cornerRadius).stroke(c._stroke).strokeWidth(c._strokeWidth).sortMethod(c._sortMethod).transition(c._transition).duration(c._duration).onTransitionEnd(function(t,e){var n=h.arcFunc.outerRadius()(t),i=d3.select(this.parentNode),o=t.startAngle,a=t.endAngle,r="arc-path-"+t.data.key+"-"+c.id,l=L(n-d,o+.015,a-.015);z(i,c.defs.select("#"+r).empty()?c.defs.append("path").attr("d",l).attr("id",r):c.defs.select("#"+r).attr("d",l),t.data.value.toString(),c._textLabel.fontSize,c._textLabel.fontFamily).classed(c.labelTextClass,!0).style("pointer-events","none").style("fill",c._textLabel.color).style("font-size",c._textLabel.fontSize).style("font-family",c._textLabel.fontFamily),0==c._labelShow?i.selectAll("text").style("display","none"):i.selectAll("text").style("display","block");var s="outer-arc-path-"+t.data.key+"-"+c.id,u=L(p,o+.015,a-.015);z(i,c.defs.select("#"+s).empty()?c.defs.append("path").attr("d",u).attr("id",s):c.defs.select("#"+s).attr("d",u),t.data.name=="$-"+e?"":t.data.name,d,c._fontFamily).attr("class",c.labelTextClass).style("pointer-events","none").style("fill",c._fontColor)}).onMouseover(function(t,e){d3.select(this).transition().style("opacity",.8);var n=[{text:""+(t.data.name=="$-"+e?"":t.data.name),color:t.data.color},{text:t.data.valueLabel+": "+t.data.value}];c.tooltip.data(n).update().show()}).onMousemove(function(){c.tooltip.move()}).onMouseout(function(t){d3.select(this).transition().style("opacity",1),c.tooltip.hide()});var y=(i-a)/2+u,g=(o-r)/2+_,v=l.quadrant,x=(p-s)/2;switch(v){case 4:y+=x,g+=x;break;case 1:y-=x,g+=x;break;case 2:y-=x,g-=x;break;case 3:y+=x,g-=spcae}t.translate(y,g).update(),h.translate(y,g).update()}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._textLabel=n.textLabel?n.textLabel:this._textLabel),this.cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).stroke(e.areaBorderColor||this._stroke).strokeWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._strokeWidth))}}]),n}(),J=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._startAngle=3*Math.PI/2,e._endAngle=2*Math.PI,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e._labelShow=!1,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,U),l(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._textLabel=n.textLabel?n.textLabel:this._textLabel),this.cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).stroke(e.areaBorderColor||this._stroke).strokeWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._strokeWidth))}}]),n}(),K="icon-bar-group",$="icon-bar-clip-path",nt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-bar"),e.defs=e.elem.append("defs"),e._width=400,e._height=400,e._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},e._backFill="#ccc",e._countOfOneRow=20,e._padding=2,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n._data,e=n._width,i=n._height,o=n._icon,a=n._countOfOneRow,r=n._padding,l=t.length,s=d3.max(t,function(t){return t.value}),u=e/a,c=i/Math.max(1,l),h=Math.min((u-2*r)/o.width,(c-2*r)/o.height),d=(u-2*r)*h,_=o.height*h,f=function(t){return a<=s?a*t.value/s:t.value},p=n.defs,y="icon-"+n.id;p.select("#"+y).empty()&&p.append("path").attr("id",y).attr("d",o.path);var g=p.selectAll("."+$).data(t,function(t){return t.name});g.exit().remove();var v=g.enter().append("clipPath").attr("class",$).attr("id",function(t,e){return"icon-clip-"+e+"-"+n.id});v.append("rect"),v.merge(g).select("rect").attr("x",0).attr("y",-1).attr("width",function(t){return f(t)*u}).attr("height",c);var x=n.group.selectAll("."+K).data(t,function(t){return t.key});x.exit().remove(),x.selectAll("*").remove();var m=x.enter().append("g").attr("class",K).merge(x).attr("transform",function(t,e){return"translate(0, "+c*e+")"}).each(n._onTransitionStart).each(n._onTransitionEnd).on("mouseover",n._onMouseover).on("mousemove",n._onMousemove).on("mouseout",n._onMouseout),k=m.append("rect").attr("class","icon-bar-back-rect"),b=m.append("g").attr("class","icon-bar-back-group").call(H,0,(c-_)/2),S=m.append("g").attr("class","icon-bar-front-group").call(H,0,(c-_)/2).attr("clip-path",function(t,e){return"url(#icon-clip-"+e+"-"+n.id+")"});return k.attr("width",e).attr("height",c).style("opacity",0),b.selectAll("g").data(d3.range(a)).enter().append("g").attr("transform",function(t,e){return"translate("+(u*e+Math.max((u-d)/2,r))+",0)"}).append("path").attr("d",o.path).style("fill",n._backFill).attr("transform","scale("+h+")"),S.each(function(t,e){d3.select(this).selectAll("g").data(function(t){return d3.range(Math.ceil(f(t)))}).enter().append("g").attr("transform",function(t,e){return"translate("+(u*e+Math.max((u-d)/2,r))+",0)"}).append("path").attr("d",o.path).style("fill",t.color).style("stroke-width",1/h).attr("transform","scale("+h+")")}),n}},{key:"backFill",value:function(t){return arguments.length?(this._backFill=t,this):this._backFill}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"padding",value:function(t){return arguments.length?(this._padding=t,this):this._padding}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),n}(),it=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-bar-chart"),e.core=e.iconBar=new nt(e.mainGroup),e._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},e._iconBackFill="#ccc",e._countOfOneRow=10,e._iconPadding=2,e._innerPadding=5,e._labelShow=!1,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){var o=this,a=o.iconBar,i=o.tooltip,t=o.activeData,e=o.widthOfNoMargin,n=o.heightOfMainGroup,r=o._fontSize,l=.25*e,s=t.length?d3.max(t,function(t,e){return V(t.name=="$-"+e?"":t.name,r,o._fontFamily)}):0,u=Math.min(l,s),c=t.length?d3.max(t,function(t){return V(t.value,o._textLabel.fontSize,o._textLabel.fontFamily)}):0,h=o._labelShow?Math.min(l,c):0;a.data(o.activeData).width(o.widthOfNoMargin-u-h-2*o._innerPadding).height(n).backFill(o._iconBackFill).countOfOneRow(o._countOfOneRow).icon(o._icon).padding(o._iconPadding),a.translate(u+o._innerPadding,0).onMouseover(function(t,e){var n=[{text:""+(t.name=="$-"+e?"":t.name),color:t.color},{text:t.valueLabel+": "+t.value}];i.data(n).update().show(),d3.select(this).select(".icon-bar-front-group").selectAll("path").style("stroke","#000")}).onMousemove(function(t,e){i.move()}).onMouseout(function(t,e){i.hide(),d3.select(this).select(".icon-bar-front-group").selectAll("path").style("stroke","none")}).onTransitionStart(function(t,e){var n=d3.select(this),i=o.heightOfMainGroup/a.data().length;n.append("text").attr("class",o.labelTextClass).attr("x",-o._innerPadding).attr("y",i/2).attr("dy","0.35em").style("text-anchor","end").style("fill",o._fontColor).text(I(t.name=="$-"+e?"":t.name,u,r,o._fontFamily)),o._labelShow&&n.append("text").attr("class",o.labelTextClass).attr("x",o.widthOfNoMargin-u-h-o._innerPadding).attr("y",i/2).attr("dy","0.35em").style("text-anchor","start").style("fill",o._textLabel.color).style("font-size",o._textLabel.fontSize).style("font-family",o._textLabel.fontFamily).text(I(t.value,h,o._textLabel.fontSize,o._textLabel.fontFamily))}),a.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"iconBackFill",value:function(t){return arguments.length?(this._iconBackFill=t,this):this._iconBackFill}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"iconPadding",value:function(t){return arguments.length?(this._iconPadding=t,this):this._iconPadding}}]),n}(),ot="radial-bar-group",lt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radial-bar"),e.arcFunc=d3.arc(),e._innerRadius=0,e._outerRadius=100,e._lineRatio=.7,e._startAngle=0,e._endAngle=2*Math.PI*.75,e._cornerRadius=0,e._showMark=!1,e._markRadius=5,e._minLineWidth=2,e}return u(n,A),l(n,[{key:"update",value:function(){var t=this,e=t._data,n=t._outerRadius,i=t._innerRadius,o=t._startAngle,a=t._endAngle,r=t._lineRatio,l=t.group,s=t.arcFunc,u=e.length,c=d3.max(e,function(t){return Math.abs(t.value)}),h=(n-i)/u,d=Math.max(h*r,t._minLineWidth),_=function(t,e){return i+h*(e+1)-d/2},f=d3.scaleLinear().domain([0,c]).range([o,a]),p=function(t){return f(Math.abs(t))};s.innerRadius(function(t,e){return _(0,e)-d/2}).outerRadius(function(t,e){return _(0,e)+d/2}).startAngle(o).endAngle(function(t){return p(t.value)}).cornerRadius(t._cornerRadius);var y=l.selectAll("."+ot).data(e,function(t){return t.key});y.exit().remove();var g=y.enter().append("g").attr("class",ot);g.append("path").attr("class","arc-path"),t._showMark&&g.append("circle").attr("class","mark-circle");var v=g.merge(y).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._showMark?v.select("circle").attr("cx",function(t,e){return _(0,e)*Math.cos(p(t.value)-Math.PI/2)}).attr("cy",function(t,e){return _(0,e)*Math.sin(p(t.value)-Math.PI/2)}).attr("r",t._markRadius).style("fill",function(t){return t.color}).style("opacity",1):v.select("circle").style("opacity",0),v.select("path").style("fill",function(t){return t.color}).attr("d",function(t,e){return s({value:0},e)}).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attrTween("d",function(e,n){var i=d3.interpolate(o,p(e.value));return function(t){return s.endAngle(i(t)),s(e,n)}}).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"lineRatio",value:function(t){return arguments.length?(this._lineRatio=t,this):this._lineRatio}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"showMark",value:function(t){return arguments.length?(this._showMark=t,this):this._showMark}},{key:"markRadius",value:function(t){return arguments.length?(this._markRadius=t,this):this._markRadius}},{key:"minLineWidth",value:function(t){return arguments.length?(this._minLineWidth=t,this):this._minLineWidth}}]),n}(),st=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radial-bar-chart"),e.core=e.radialBar=new lt(e.mainGroup),e._innerRadiusRatio=.1,e._startAngle=0,e._endAngle=2*Math.PI*.75,e._showMark=!1,e._markRadius=10,e._minLineWidth=2,e._lineRatio=.7,e._cornerRadius=0,e._labelShow=!0,e._positionOptions=["","",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){var t=this,i=t.tooltip,e=t.radialBar,n=t.widthOfNoMargin,o=t.heightOfMainGroup,a=Math.min(n,o)/2,r=a*t._innerRadiusRatio,l=[];if("linear"==t._colors.type){var s=[isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]],isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]]],u=d3.scaleLinear().domain([t.activeData.length-1,0]).range(s);l=function(t){for(var e,n,i=t.length,o=0;o<i-1;o++){for(var a=(e=o)+1;a<i;a++)t[a].value<t[e].value&&(e=a);n=t[o],t[o]=t[e],t[e]=n}return t}(t.activeData).map(function(t,e){return t.color=u(e),t})}else l=t.activeData.sort(function(t,e){return t.value-e.value});e.data(l).innerRadius(r).outerRadius(a).startAngle(t._startAngle).endAngle(t._endAngle).lineRatio(t._lineRatio).cornerRadius(t._cornerRadius).showMark(t._showMark).markRadius(t._markRadius).minLineWidth(t._minLineWidth).transition(t._transition).duration(t._duration).onMouseover(function(t,e){d3.select(this).style("opacity",.8);var n=[{text:""+(t.showLegend?t.name:""),color:t.color},{text:t.valueLabel+": "+t.value}];i.data(n).update().show()}).onMousemove(function(){i.move()}).onMouseout(function(){d3.select(this).style("opacity",1),i.hide()}).onTransitionStart(t._onTransitionStart()).onTransitionEnd(t._onTransitionEnd()),e.translate(n/2,o/2).update()}},{key:"configLegend",value:function(){var t=this,i=[];if("linear"==t._colors.type){var e=[isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]],isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]]],n=d3.scaleLinear().domain([t.activeData.length-1,0]).range(e);i=function(t){for(var e,n,i=t.length,o=0;o<i-1;o++){for(var a=(e=o)+1;a<i;a++)t[a].value<t[e].value&&(e=a);n=t[o],t[o]=t[e],t[e]=n}return t}(t.activeData).map(function(t,e){return t.color=n(e),t}).filter(function(t,e){return 1==t.showLegend})}else i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"lineRatio",value:function(t){return arguments.length?(this._lineRatio=t,this):this._lineRatio}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"showMark",value:function(t){return arguments.length?(this._showMark=t,this):this._showMark}},{key:"markRadius",value:function(t){return arguments.length?(this._markRadius=t,this):this._markRadius}},{key:"minLineWidth",value:function(t){return arguments.length?(this._minLineWidth=t,this):this._minLineWidth}},{key:"_onTransitionStart",value:function(){var a=this;return function(t,e){var n=d3.select(this.parentNode),i=a.radialBar.arcFunc,o=(i.innerRadius()(t,e)+i.outerRadius()(t,e))/2;n.append("text").attr("class",a.labelTextClass).attr("x","-5px").attr("y",-o).attr("dy","0.35em").style("text-anchor","end").style("fill",a._fontColor).text(t.showLegend?t.name:"")}}},{key:"_onTransitionEnd",value:function(){var d=this;return d.group.selectAll(".radial-bar-texts").remove(),function(t,e){var n=d3.select(this.parentNode),i=d.radialBar.arcFunc,o=(i.innerRadius()(t,e)+i.outerRadius()(t,e))/2,a=i.startAngle()(t,e),r=i.endAngle()(t,e),l=r>Math.PI/2&&r<=3*Math.PI/2,s="arc-path-"+t.key+"-"+d.id;if(0==d._labelShow||null==d._labelShow||null==d._positionOptions||null==d._positionChoice)d.group.selectAll(".radial-bar-texts").style("display","none");else if(0==d._positionOptions.indexOf(d._positionChoice)){var u=L(o,a,r-.05,!l);z(n,d.defs.select("#"+s).empty()?d.defs.append("path").attr("d",u).attr("id",s):d.defs.select("#"+s).attr("d",u),t.value,d._textLabel.fontSize,d._textLabel.fontFamily,l?"0%":"100%").attr("class","radial-bar-texts").style("text-anchor",l?"start":"end").style("pointer-events","none").style("fill",d._textLabel.color).style("font-size",d._textLabel.fontSize).style("font-family",d._textLabel.fontFamily).style("display",d._labelShow?"block":"none")}else if(1==d._positionOptions.indexOf(d._positionChoice)){var c=L(o,r,2*Math.PI,!l);z(n,d.defs.select("#"+s).empty()?d.defs.append("path").attr("d",c).attr("id",s):d.defs.select("#"+s).attr("d",c),t.value,d._textLabel.fontSize,d._textLabel.fontFamily,l?"95%":"5%").attr("class","radial-bar-texts").style("text-anchor",l?"end":"start").style("pointer-events","none").style("fill",d._textLabel.color).style("font-size",d._textLabel.fontSize).style("font-family",d._textLabel.fontFamily).style("display",d._labelShow?"block":"none")}else if(2==d._positionOptions.indexOf(d._positionChoice)){var h=L(o,a,a+Math.PI);z(n,d.defs.select("#"+s).empty()?d.defs.append("path").attr("d",h).attr("id",s):d.defs.select("#"+s).attr("d",h),t.value,d._textLabel.fontSize,d._textLabel.fontFamily,"0%").attr("class","radial-bar-texts").attr("dx",d._fontSize/2).style("text-anchor","start").style("pointer-events","none").style("fill",d._textLabel.color).style("font-size",d._textLabel.fontSize).style("font-family",d._textLabel.fontFamily).style("display",d._labelShow?"block":"none")}}}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&this.lineRatio(o(e.barWidthPercent?e.barWidthPercent:this._lineRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius))}}]),n}(),ut=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radial-line-chart"),e._lineRatio=0,e._innerRadiusRatio=.2,e._showMark=!0,e._markRadius=5,e._minLineWidth=2,e._labelShow=!1,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,st),l(n,[{key:"_onTransitionEnd",value:function(){var u=this;return function(t,e){var n=d3.select(this.parentNode),i=u.radialBar.arcFunc,o=(i.innerRadius()(t,e)+i.outerRadius()(t,e))/2,a=(i.startAngle()(t,e),i.endAngle()(t,e)),r=a>Math.PI/2&&a<=3*Math.PI/2,l="arc-path-"+t.key+"-"+u.id,s=L(o,a,2*Math.PI,!r);z(n,u.defs.select("#"+l).empty()?u.defs.append("path").attr("d",s).attr("id",l):u.defs.select("#"+l).attr("d",s),t.value,u._textLabel.fontSize,u._textLabel.fontFamily,r?"95%":"5%").attr("class",u.labelTextClass).style("text-anchor",r?"end":"start").style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily).style("display",u._labelShow?"block":"none")}}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._textLabel=n.textLabel?n.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&this.markRadius(o(e.endPointRadius?e.endPointRadius:this._markRadius)).minLineWidth(o(e.lineWidth?e.lineWidth:this._minLineWidth)).lineRatio(0)}}]),n}(),ct=function(t){function o(t){r(this,o);var e=c(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.xAxis=null,e.yAxis=null,e.yAxisDoubleY=null,e.xScale=null,e.yScale=null,e._marginTop=20,e._marginRight=24,e._marginBottom=20,e._marginLeft=24,e._gapPadding=20,e._titlePadding=20,e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._xRange=null,e._yRange=null,e._xDomain=null,e._yDomain=null,e._clipShow=null,e._xTitle="",e._yTitle="",e._axisLineStroke=null,e._xTickShow=!0,e._yTickShow=!0,e}return u(o,q),l(o,[{key:"update",value:function(){return this._marginLeft=this._yTitle?0:24,(this._yLeftName||this._yRightName)&&(this._marginLeft=this._yLeftName?0:24,this._marginRight=this._yRightName?0:24),this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this._legendShow&&0!=this.legend.height()?this._gapPadding=this._xTitle&&"bottom"==this._legendY?8:20:this._gapPadding=0,this.updateTitle(),this.updateAxis(),this.updateCore(),this.updateScale(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,a=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),o.domain(t._yDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration);n.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);n.tickCount(d),n.compute(),i.range([0,c-n.width]),e.compute(),o.range([h-e.height,0]);var _=n.width,f=h-e.height,p=n.width;e.translate(_,f).update(),n.translate(p,0).update()}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"updateScale",value:function(){}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yRange||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=void 0;if(t.length){var o=d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),a=1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})});i=o<0?a<=0?[o,0]:[o,a]:[0,a]}else i=[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?isNaN(parseFloat(e[0]))?i[1]:i[1]<e[0]?1.5*e[0]:i[1]:parseFloat(e[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"xRange",value:function(t){return arguments.length?(this._xRange=t,this):this._xRange}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"clipShow",value:function(t){return arguments.length?(this._clipShow=t,this):this._clipShow}},{key:"clipShowX",value:function(t){return arguments.length?(this._clipShowX=t,this):this._clipShowX}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"yLeftName",value:function(t){return arguments.length?(this._yLeftName=t,this):this._yLeftName}},{key:"yLeftTitle",value:function(t){return arguments.length?(this._yLeftTitle=t,this):this._yLeftTitle}},{key:"yRightName",value:function(t){return arguments.length?(this._yRightName=t,this):this._yRightName}},{key:"yRightTitle",value:function(t){return arguments.length?(this._yRightTitle=t,this):this._yRightTitle}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"times",value:function(t){return arguments.length?(this._times=t,this):this._times}},{key:"setPublicOption",value:function(t){s(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.x||{},i=e.y||{};this.axisLineStroke(e.color).xTitle(n.name).yTitle(i.name).xTickShow(n.labelShow).yTickShow(i.labelShow).xRange(n.range).yRange(i.range).clipShow(i.range).clipShowX(n.range)}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return 0<e?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.heightOfMainGroup-t;return 0<e?e:0}}]),o}(),ht=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","axis"),e.group=e.elem.append("g"),e.axisFunc=null,e._orient="bottom",e._type="category",e._scaleFunc=null,e._tickSize=6,e._tickPadding=3,e._tickCount=null,e._tickFormat=null,e._minTickDistance=null,e._axisLineShow=!0,e._tickShow=!0,e._title="",e._titleShow=!0,e._titlePadding=5,e._fontSize=12,e._fontColor="#000",e._fontFamily="sans-serif",e._lineStroke="#000",e._transition=!0,e._duration=500,e._tickValues=[],e._tickValueTexts=[],e}return u(n,a),l(n,[{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"scaleFunc",value:function(t){return arguments.length?(this._scaleFunc=t,this):this._scaleFunc}},{key:"tickSize",value:function(t){return arguments.length?(this._tickSize=t,this):this._tickSize}},{key:"tickPadding",value:function(t){return arguments.length?(this._tickPadding=t,this):this._tickPadding}},{key:"tickFormat",value:function(t){return arguments.length?(this._tickFormat=t,this):this._tickFormat}},{key:"tickCount",value:function(t){return arguments.length?(this._tickCount=t,this):this._tickValues.length||this._tickCount}},{key:"minTickDistance",value:function(t){return arguments.length?(this._minTickDistance=t,this):this._minTickDistance}},{key:"tickLineShow",value:function(t){return arguments.length?(this._tickLineShow=t,this):this._tickLineShow}},{key:"axisLineShow",value:function(t){return arguments.length?(this._axisLineShow=t,this):this._axisLineShow}},{key:"title",value:function(t){return arguments.length?(this._title=t,this):this._title}},{key:"titlePadding",value:function(t){return arguments.length?(this._titlePadding=t,this):this._titlePadding}},{key:"titleShow",value:function(t){return arguments.length?(this._titleShow=t,this):this._titleShow}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"xRange",value:function(t){return arguments.length?(this._xRange=t,this):this._xRange}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"lineStroke",value:function(t){return arguments.length?(this._lineStroke=t,this):this._lineStroke}},{key:"tickLabelShow",value:function(t){return arguments.length?(this._tickLabelShow=t,this):this._tickLabelShow}},{key:"tickShow",value:function(t){return arguments.length?(this._tickShow=t,this):this._tickShow}},{key:"titleHeight",get:function(){return this._title&&this._titleShow?1.25*this._fontSize+this._titlePadding:0}},{key:"tickLocations",get:function(){var e=this;return this._tickValues.map(function(t){return e._scaleFunc(t)})}}]),n}(),dt="axis-group",_t="x-title",ft=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-x-line"),e._orient="bottom",e._type="category",e._allowedMaxTextHeight=30,e._tickTextRotate=0,e._tickTextHeight=0,e}return u(n,ht),l(n,[{key:"update",value:function(){var n=this,i=n._orient,t=n._scaleFunc,e=n.group,o=n._fontSize,a=n._tickTextRotate,r=n._tickValueTexts,l=void 0;(l=n.axisFunc="top"===i?d3.axisTop(t):d3.axisBottom(t)).tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding);var s=e.select("."+dt).empty()?e.append("g").attr("class",dt):e.select("."+dt);s.style("font-size",o+"px").style("font-family",n._fontFamily).transition().duration(n._transition?n._duration:0).call(l).on("start",function(t,e){s.selectAll(".tick text").style("fill",n._fontColor).attr("dx",0).attr("dy","0.8em").attr("transform","rotate(0)").style("text-anchor","middle").text(function(t,e){return r[e]}).filter(function(){return a}).attr("dx","-0.5em").style("text-anchor","end").attr("transform","rotate("+n._tickTextRotate+")").filter(function(){return"top"!==i}).attr("dy","0.5em"),s.selectAll(".tick line").style("stroke",n._lineStroke),s.select("path").style("stroke",n._lineStroke).style("display",n._axisLineShow?"block":"none")}),n._rotateFlag&&(s.selectAll(".tick text").remove(),s.selectAll(".tick").append("text").style("fill",n._fontColor).attr("dx",0).attr("dy","0.71em").attr("transform","rotate(0)").style("text-anchor","middle").text(function(t,e){return r[e]}).filter(function(){return a}).attr("dx","-0.5em").style("text-anchor","end").attr("transform","rotate("+n._tickTextRotate+")").filter(function(){return"top"!==i}).attr("dy","0.5em"));var u=n.group.selectAll(".axis-x-line .tick text").nodes().filter(function(t,e){return"&-"==String(t.__data__).slice(0,2)}),c=n.group.selectAll(".axis-x-line .tick text").nodes().filter(function(t,e){return"$-"==String(t.__data__).slice(0,2)});d3.selectAll(u).remove(),d3.selectAll(c).remove();var h=Math.abs(t.range()[0]-t.range()[1]);if(n._titleShow&&n._title){var d=e.select("."+_t).empty()?e.append("g").attr("class",_t):e.select("."+_t),_=d.select("text").empty()?d.append("text"):d.select("text"),f=h/r.length,p=d3.max(r,function(t){return V(t,o,n._fontFamily)});d.call(H,h/2+Math.abs(t.range()[0]),this._tickShow?this._tickSize+this._tickPadding+(p<.8*f?this._tickTextHeight:1.2*this._tickTextHeight):0),_.attr("text-anchor","middle").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dy",n._tickShow?1.125*o/2+6:1.125*o/2+12).text(n._title)}else e.select("."+_t).remove()}},{key:"compute",value:function(){var e=this,n=[],i=[],o=0,a=0,t=!1;function r(){e._tickTextRotate=o,e._tickValues=n,e._tickValueTexts=i,e._tickTextHeight=a,e._rotateFlag=t}var l=e._scaleFunc,s=e._type,u=e._fontSize,c=(e._minTickDistance,e._allowedMaxTextHeight),h=Math.abs(l.range()[0]-l.range()[1]),d=void 0,_=void 0;if(n="category"===s?l.domain():l.ticks(e._tickCount),"number"===s&&0!=e._xRange.length&&n.push(e._xRange[0]),function(){var t=!1;d=h/n.length,(_=d3.max(n.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,u,e._fontFamily)})||0)<.8*d&&(i=n,a=(o=0)==_?0:1.125*u,r(),t=!0);return t}())return e;o="top"===e._orient?45:-45;var f=Math.abs(Math.sin(Math.PI/4));_*f<c?(a=_*f,i=n,t=!1):(a=c,i=n.map(function(t){return I(t,a/f,u,e._fontFamily)}),t=!0);Math.abs(Math.cos(Math.PI/4));var p=h/n.length;if("category"===s&&p<2*u){var y=Math.ceil(2*u/p);n=n.filter(function(t,e){return e%y==0})}return r(),e}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"height",get:function(){var e=this,t=this._scaleFunc,n=Math.abs(t.range()[0]-t.range()[1])/this._tickValueTexts.length,i=d3.max(this._tickValueTexts.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,e._fontSize,e._fontFamily)}),o=0;return this.isShow&&(o=(this._tickShow?(i?this._tickSize+this._tickPadding:0)+(i<.8*n?this._tickTextHeight:1.2*this._tickTextHeight):0)+(this._title&&this._titleShow?this._titlePadding+1.25*this._fontSize:0)),o}}]),n}(),pt="axis-group",yt="y-title",gt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-line"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e._tickPadding=2,e}return u(n,ht),l(n,[{key:"update",value:function(){var e=this,t=this,n=t._orient,i=t._scaleFunc,o=t.group,a=t._fontSize,r=t._tickValueTexts,l=void 0;l=t.axisFunc="right"===n?d3.axisRight(i):d3.axisLeft(i);var s=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(s=d3.format("d")),l.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(s);var u=o.select("."+pt).empty()?o.append("g").attr("class",pt):o.select("."+pt);u.transition().duration(t._transition?t._duration:0).call(l).on("start",function(){u.selectAll(".tick text").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return r[e]}),u.selectAll(".tick line").style("stroke",t._lineStroke).style("display","none"),u.select("path").style("stroke",t._lineStroke).style("display","none")});var c=t.group.selectAll(".axis-y-line .tick text").nodes().filter(function(t,e){return"&-"==String(t.__data__).slice(0,2)||"$-"==String(t.__data__).slice(0,2)});d3.selectAll(c).remove();var h=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var d=o.select("."+yt).empty()?o.append("g").attr("class",yt):o.select("."+yt),_=d.select("text").empty()?d.append("text"):d.select("text"),f=(V(t._title,a,t._fontFamily),d3.max(this._tickValueTexts.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,e._fontSize,e._fontFamily)}));d.call(H,-(this._tickShow?(f?this._tickSize+this._tickPadding:5)+this._tickTextWidth:0),h/2),_.attr("y",-5).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(t._title)}else o.select("."+yt).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,a=e._type,r=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===a?o.domain():o.ticks(e._tickCount),"number"===a&&0!=e._yRange.length&&t.push(-1==String(e._yRange[0]).indexOf(".")?e._yRange[0]:e._yRange[0].toFixed(0));var s=d3.max(t.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,r,e._fontFamily)})||0;return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,r,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var e=this,t=d3.max(this._tickValueTexts.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,e._fontSize,e._fontFamily)}),n=0;return this.isShow&&(n=this._tickShow?(t?this._tickSize+this._tickPadding:0)+this._tickTextWidth+(this._titleShow&&this._title?1.125*this._fontSize+11:0):this._titleShow&&this._title?1.125*this._fontSize+11:0),n}}]),n}(),vt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("line").attr("class","guide-line"),e._x1=0,e._y1=0,e._x2=0,e._y2=100,e._stroke="#000",e._strokeDasharray="3 3",e}return u(n,a),l(n,[{key:"update",value:function(){var t=this;return t.elem.attr("x1",t._x1).attr("y1",t._y1).attr("x2",t._x2).attr("y2",t._y2).style("stroke",t._stroke).style("stroke-dasharray",t._strokeDasharray).style("pointer-events","none"),t}},{key:"x1",value:function(t){return arguments.length?(this._x1=t,this):this._x1}},{key:"y1",value:function(t){return arguments.length?(this._y1=t,this):this._y1}},{key:"x2",value:function(t){return arguments.length?(this._x2=t,this):this._x2}},{key:"y2",value:function(t){return arguments.length?(this._y2=t,this):this._y2}},{key:"x",value:function(t){return arguments.length?(this._x1=this._x2=t,this):[this._x1,this._x2]}},{key:"y",value:function(t){return arguments.length?(this._y1=this._y2=t,this):[this._y1,this._y2]}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}}]),n}(),xt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","scatter-plot"),e._xScale=null,e._yScale=null,e._radius=function(){return 3},e._fill=null,e._stroke=null,e._strokeWidth=2,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n.group,e=n._data,i=n._xScale,o=n._yScale;t.selectAll(".scatter-plot").remove();var a=t.selectAll("g").data(e,function(t){return t.name});a.exit().remove(),a.enter().append("g").merge(a).each(function(t){var e=d3.select(this).selectAll("circle").data(t.data);e.exit().remove(),e.enter().append("circle").attr("class","scatter-plot").attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.value)||0}).merge(e).style("fill",n._fill||t.color).style("stroke",n._stroke||t.color).style("stroke-width",n._strokeWidth).attr("r",n._radius).attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.value)||0})});for(var r=t.selectAll(".scatter-plot").nodes(),l=0;l<r.length;l++)""==r[l].__data__.value||isNaN(r[l].__data__.value)?d3.select(r[l]).style("opacity","0"):d3.select(r[l]).style("opacity","1");return n}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}(),mt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","overlap-area-plot"),e._xScale=null,e._yScale=null,e._areaFunc=null,e._curve=d3.curveLinear,e._stroke=null,e._lineWidth=2,e._strokeDasharry="",e._fillOpacity=.7,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n._data,i=n._areaFunc||d3.area().x(function(t){return n._xScale(t.name)}).y0(n._yScale.range()[0]).y1(function(t){return n._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});i.curve(n._curve);var o=n._lineFunc||d3.line().x(function(t){return n._xScale(t.name)}).y(function(t){return n._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});o.curve(n._curve);var e=n.group;e.selectAll(".overlap-area").remove(),e.selectAll(".overlap").remove(),e.selectAll(".overlap-line").remove();var a=e.append("g").attr("class","overlap-area").selectAll("g").data(t,function(t){return t.name});return a.exit().remove(),a.enter().append("g").merge(a).each(function(t,e){d3.select(this).append("g").append("path").attr("class","overlap").style("fill",t.color).style("fill-opacity",n._fillOpacity).transition().duration(n._transition?n._duration:0).attr("d",i(t.data)),d3.select(this).append("g").append("path").attr("class","overlap-line").style("fill","none").style("stroke",n._stroke||t.color||"#000").style("stroke-width",n._lineWidth).style("stroke-opacity",1).style("stroke-dasharray",n._strokeDasharry).transition().duration(n._transition?n._duration:0).attr("d",o(t.data))}),n}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}}]),n}(),kt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-texts"),e._xScale=null,e._yScale=null,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n._data,e=n.group,i=n._xScale,o=n._yScale,a=e.selectAll("g").data(t,function(t){return t.name});a.exit().remove(),a.enter().append("g").attr("class","ranking-text-group").merge(a).each(function(t){var e=d3.select(this).selectAll("text").data(t.data);e.exit().remove(),e.enter().append("text").attr("x",function(t){return i(t.name)+("mix"==n._type?i.bandwidth()/2:0)||0}).attr("y",function(t){return t.total?o(t.total)||0:o(t.value)||0}).merge(e).text(function(t){return isNaN(parseFloat(t.value))?"":t.value}).style("fill",n._fontColor).style("font-size",n._fontSize).style("font-family",n._fontFamily).attr("x",function(t){return i(t.name)+("mix"==n._type?i.bandwidth()/2:0)||0}).attr("y",function(t){return t.total?o(t.total)||0:o(t.value)||0}).attr("text-anchor","middle").style("display",n._labelShow?"block":"none")}),null==n._labelShow||null==n._positionOptions||null==n._positionChoice||-1==n._positionOptions.indexOf(n._positionChoice)?e.selectAll(".ranking-text-group text").style("display","none"):0==n._positionOptions.indexOf(n._positionChoice)?e.selectAll(".ranking-text-group text").attr("dy",.4*-n._fontSize):1==n._positionOptions.indexOf(n._positionChoice)&&e.selectAll(".ranking-text-group text").attr("dy",1.3*n._fontSize);for(var r=e.selectAll(".ranking-text-group text"),l=[],s=[],u=0;u<r._groups[0].length;u++){s.push(u);for(var c=u+1;c<r._groups[0].length;c++){rt(at(d3.select(r._groups[0][u])),at(d3.select(r._groups[0][c])))&&(l.push(u),d3.select(r._groups[0][u]).style("opacity","0"))}}for(var h=new Set(l),d=Array.from(h),_=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(d,s),f=0;f<d.length;f++){for(var p=[],y=0;y<_.length;y++){var g=at(d3.select(r._groups[0][d[f]])),v=at(d3.select(r._groups[0][_[y]]));if(p.push(rt(g,v)),rt(g,v)){if(d[f]==_[y])continue;d3.select(r._groups[0][d[f]]).style("opacity","0")}}0==p.filter(function(t){return 1==t}).length&&_.push(d[f])}for(var x=0;x<_.length;x++)d3.select(r._groups[0][_[x]]).style("opacity","1");return n}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),bt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("clipPath").attr("id",e.id),e.rect=e.elem.append("rect"),e._width=100,e._height=100,e._transition=!0,e._duration=500,e._paddingVertical=[5,0],e._paddingHorizontal=[20,20],e}return u(n,a),l(n,[{key:"update",value:function(){var t=this,e=t.rect,n=t._width,i=t._paddingVertical,o=t._paddingHorizontal;return e.attr("x",-n-o[0]).attr("y",-i[0]).attr("width",n+o[0]+o[1]).attr("height",t._height+i[0]+i[1]),e.transition().duration(t._transition?t._duration:0).attr("x",-o[0]),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"paddingVertical",value:function(t){return arguments.length?(this._paddingVertical=t,this):this._paddingVertical}},{key:"paddingHorizontal",value:function(t){return arguments.length?(this._paddingHorizontal=t,this):this._paddingHorizontal}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),n}(),St=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("clipPath").attr("id",e.id),e.rect=e.elem.append("rect").attr("class","x"+e.id),e._width=100,e._height=100,e._transition=!0,e._duration=500,e._paddingVertical=[0,0],e._paddingHorizontal=[0,0],e}return u(n,a),l(n,[{key:"update",value:function(){var t=this,e=t.rect,n=t._width,i=t._paddingVertical,o=t._paddingHorizontal;return e.attr("x",-n-o[0]).attr("y",-i[0]).attr("width",n+o[0]+o[1]).attr("height",t._height+i[0]+i[1]),e.transition().duration(t._transition?t._duration:0).attr("x",-o[0]),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"paddingVertical",value:function(t){return arguments.length?(this._paddingVertical=t,this):this._paddingVertical}},{key:"paddingHorizontal",value:function(t){return arguments.length?(this._paddingHorizontal=t,this):this._paddingHorizontal}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),n}(),wt="grid-x-line",Ot="grid-y-line",Ct=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","plane-grid"),e.group=e.elem.append("g"),e._width=400,e._height=400,e._xTickLocations=[],e._yTickLocations=[],e}return u(n,Y),l(n,[{key:"update",value:function(){var e=this,n=e._width,i=e._height,o=e.group.style("fill","none").style("stroke",e._stroke).style("stroke-dasharray",e._strokeDasharray).style("pointer-events","none");!function(){if(!e._showX)return o.selectAll("."+wt).remove();var t=o.selectAll("."+wt).data(e._yTickLocations);t.exit().remove(),t.enter().append("line").attr("class",wt).merge(t).attr("x1",0).attr("y1",function(t){return t+.5}).attr("x2",n).attr("y2",function(t){return t+.5})}(),function(){if(!e._showY)return o.selectAll("."+Ot).remove();var t=o.selectAll("."+Ot).data(e._xTickLocations);t.exit().remove(),t.enter().append("line").attr("class",Ot).merge(t).attr("y1",0).attr("x1",function(t){return t}).attr("y2",i).attr("x2",function(t){return t})}()}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"xTickLocations",value:function(t){return arguments.length?(this._xTickLocations=t,this):this._xTickLocations}},{key:"yTickLocations",value:function(t){return arguments.length?(this._yTickLocations=t,this):this._yTickLocations}}]),n}(),At=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem=t.append("g").attr("class","bands-overlay").style("opacity",0),e._data=[],e._bandHeight=100,e._bandWidth=50,e._isScalePoint=!0,e._isHorizontal=!1,e._onMouseover=function(){},e._onMousemove=function(){},e._onMouseout=function(){},e}return u(n,a),l(n,[{key:"update",value:function(){var t=this,e=t._data,n=t.elem,i=t._bandWidth,o=t._bandHeight,a=t._isScalePoint,r=t._isHorizontal,l=a?i/2:0,s=n.selectAll("rect").data(e);return s.exit().remove(),s.enter().append("rect").merge(s).attr("x",function(t,e){return r?0:i*e-l}).attr("y",function(t,e){return r?o*e-l:0}).attr("width",i).attr("height",o).style("fill","#000").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"bandWidth",value:function(t){return arguments.length?(this._bandWidth=t,this):this._bandWidth}},{key:"bandHeight",value:function(t){return arguments.length?(this._bandHeight=t,this):this._bandHeight}},{key:"isScalePoint",value:function(t){return arguments.length?(this._isScalePoint=t,this):this._isScalePoint}},{key:"isHorizontal",value:function(t){return arguments.length?(this._isHorizontal=t,this):this._isHorizontal}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}();function Ft(t,e){var n=0,i=!1,o=[];if(e.forEach(function(t){"objCol"===t.function?(n=t.index,i=t.isLegend):"vCol"===t.function&&0==t.configurable&&o.push(t.index)}),P(t,[n],2))return[];for(var a=W(t,e),r={},l=[],s=a.length,u=a[0],c=[],h=[],d=1;d<s;d++)h.push(a[d].length);h.sort(function(t,e){return e-t});for(var _=0;_<s;_++)for(var f=0;f<h[0];f++)c.push(isNaN(parseFloat(a[_][f])));if(0==c.filter(function(t,e){return 0==t}).length)return[];if(i){for(var p=[],y=1;y<s;y++)p.push(a[y].length);p.sort(function(t,e){return e-t});for(var g=1;g<s;g++){var v=a[g],x=v[n];if(""!=x&&null!=x&&null!=x||(x="$-"+g),x){for(var m={name:x,showLegend:x!="$-"+g,data:[]},k=0;k<p[0];k++){var b=u[k];""!=b&&null!=b&&null!=b||(b="&-"+k),k!==n&&m.data.push({name:b,showAxisText:b!="&-"+k,value:v[k]})}l.push(m)}}}else{for(var S=[],w=1;w<s;w++)S.push(a[w].length);S.sort(function(t,e){return e-t});for(var O=1;O<S[0];O++)if(O!==n){var C=u[O];""!=u[O]&&null!=u[O]&&null!=u[O]||(C="$-"+O),r[C+"-"+O]={name:C,showLegend:C!="$-"+O,data:[]}}for(var A=1;A<s;A++){var F=a[A],L=F[n];if(""!=L&&null!=L&&null!=L||(L="&-"+A),L)for(var M=0;M<S[0];M++){var z=u[M];""!=u[M]&&null!=u[M]&&null!=u[M]||(z="$-"+M),M!==n&&z&&r[z+"-"+M].data.push({name:L,showAxisText:L!="&-"+A,value:F[M]})}}for(var R in r)l.push(r[R])}return l.forEach(function(t,e){t.key=T(t.name)+"-"+e}),l}var Lt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","overlap-area-chart"),e.grid=new Ct(e.coreGroup),e.areaPlot=new mt(e.coreGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.guideScatter=new xt(e.coreGroup),e.stackText=new kt(e.coreGroup),e.clipArea=new bt(e.defs),e.AnimationArea=new St(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yLabel="",e._xLabel="",e._sortValue=null,e._curve=d3.curveCardinal,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var t=this,n=t.activeData,e=t.grid,i=t.areaPlot,r=t.guideScatter,o=t.stackText,l=t.tooltip,a=t.overlay,s=t.guideLine,u=t.clipArea,c=(t.AnimationArea,t.xScale),h=t.yScale,d=t.widthOfCore,_=t.heightOfCore;Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.value})}),0);e.width(d).height(_).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(c).yScale(h).curve(t._curve),r.data(n).xScale(c).yScale(h).radius(3.5).stroke("#fff").strokeWidth(2),s.y1(0).y2(_).stroke("#c6c6c6").strokeDasharray("0 0"),a.data(c.domain()).isScalePoint(!0).bandWidth(c.step()).bandHeight(_).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),l.data(o).update(),s.x(c(i)).update(),r.data(a).update(),l.show(),s.show(),r.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),s.hide(),r.hide()}),o.data(n).xScale(c).yScale(h).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice),t.coreGroup.call(H,t.yAxis.width+.5,0),0!=t._clipShow.length?(u.width(d).height(_).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+u.id+")")):(u.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","")),u.update(),r.elem.style("pointer-events","none");var f=t.group.selectAll(".overlap-area-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(f).remove(),e.update(),a.update(),i.update(),o.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=Ft;return n.dataSolveFunc(i),n}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}}]),n}(),Mt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","multiple-line-plot"),e._xScale=null,e._yScale=null,e._lineFunc=null,e._stroke=null,e._lineWidth=2,e._strokeDasharry="",e._curve=d3.curveLinear,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._lineFunc||d3.line().x(function(t){return e._xScale(t.name)+e._xScale.bandwidth()/2}).y(function(t){return e._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});n.curve(e._curve);var i=e.group.selectAll("path").data(t,function(t){return t.key});return i.exit().remove(),i.enter().append("path").merge(i).style("fill","none").style("stroke",function(t){return e._stroke||t.color||"#000"}).style("stroke-width",e._lineWidth).style("stroke-dasharray",e._strokeDasharry).transition().duration(e._transition?e._duration:0).attr("d",function(t){return n(t.data)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),zt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","line-scatter-plot"),e._xScale=null,e._yScale=null,e._radius=function(){return 3},e._fill=null,e._stroke=null,e._strokeWidth=2,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n.group,e=n._data,i=n._xScale,o=n._yScale;t.selectAll(".scatter-plot").remove();var a=t.selectAll("g").data(e,function(t){return t.name});a.exit().remove(),a.enter().append("g").merge(a).each(function(t){var e=d3.select(this).selectAll("circle").data(t.data);e.exit().remove(),e.enter().append("circle").attr("class","scatter-plot").attr("cx",function(t){return i(t.name)+i.bandwidth()/2||0}).attr("cy",function(t){return o(t.value)||0}).merge(e).style("fill",n._fill||t.color).style("stroke",n._stroke||t.color).style("stroke-width",n._strokeWidth).attr("r",n._radius).attr("cx",function(t){return i(t.name)+i.bandwidth()/2||0}).attr("cy",function(t){return o(t.value)||0})});for(var r=t.selectAll(".scatter-plot").nodes(),l=0;l<r.length;l++)""==r[l].__data__.value||isNaN(r[l].__data__.value)?d3.select(r[l]).style("opacity","0"):d3.select(r[l]).style("opacity","1");return n}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}(),Rt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.grid=new Ct(e.coreGroup),e.linePlot=new Mt(e.coreGroup),e.scatterPlot=new zt(e.coreGroup),e.clipArea=new bt(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.guideScatter=new zt(e.coreGroup),e.stackText=new kt(e.coreGroup),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._showPoints=!0,e._curve=d3.curveCardinal,e._strokeWidth=2,e._endPointRadius=3.5,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var t=this,n=t.activeData,e=t.grid,i=t.linePlot,o=t.scatterPlot,a=t.clipArea,r=t.tooltip,l=t.overlay,s=t.guideLine,u=t.guideScatter,c=t.stackText,h=t.xScale,d=t.yScale,_=t.widthOfCore,f=t.heightOfCore;Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.value})}),0);e.width(_).height(f).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(0==t._yDomain[0]?t.yAxis.tickLocations.slice(1):t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(h).yScale(d).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).curve(t._curve).strokeWidth(t._strokeWidth),o.data(n).xScale(h).yScale(d).radius(t._endPointRadius).stroke("#fff").strokeWidth(1),s.y1(0).y2(f).strokeDasharray(t._gridStrokeDasharray),u.xScale(h).yScale(d).fill("#fff"),l.data(h.domain()).isScalePoint(!1).bandWidth(h.step()).bandHeight(f).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),r.data(o).update().show(),s.x(h(i)+h.bandwidth()/2).update().show(),u.data(a).update().show()}).onMousemove(function(){r.move()}).onMouseout(function(){r.hide(),s.hide(),u.hide()}),c.data(n).xScale(h).yScale(d).type("mix").fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice),t.coreGroup.call(H,t.yAxis.width+.5,0),0!=t._clipShow.length?a.width(_).height(f).paddingVertical([0,0]).transition(t._transition).duration(t._duration):a.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+a.id+")"),a.update(),u.elem.style("pointer-events","none");var p=t.group.selectAll(".axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(p).remove(),l.update(),e.update(),i.update(),o.update().show(),c.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};this.strokeWidth(o(e.lineWidth)).curve(i[e.lineType]||d3.curveLinear)}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=Ft;return n.dataSolveFunc(i),n}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}(),Tt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","step-line-chart"),e._showPoints=!1,e._curve=d3.curveStepAfter,e._strokeWidth=2,e._labelShow=!1,e._endPointRadius=0,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,Rt),l(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&this.strokeWidth(o(e.lineWidth?e.lineWidth:this._strokeWidth)).curve(i[e.lineType]||this._curve)}}]),n}();function Pt(t,e){return t.sourceLinks.length?t.depth:e-1}function Wt(t){return function(){return t}}function Dt(t,e){return Nt(t.source,e.source)||t.index-e.index}function jt(t,e){return Nt(t.target,e.target)||t.index-e.index}function Nt(t,e){return t.y0-e.y0}function Gt(t){return t.value}function Bt(t){return(t.y0+t.y1)/2}function Et(t){return Bt(t.source)*t.value}function Ht(t){return Bt(t.target)*t.value}function Vt(t){return t.index}function It(t){return t.nodes}function Yt(t){return t.links}function Xt(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function Zt(){var a=0,s=0,r=1,u=1,l=24,c=8,e=Vt,h=Pt,n=It,i=Yt,d=32;function o(){var t={nodes:n.apply(null,arguments),links:i.apply(null,arguments)};return function(t){t.nodes.forEach(function(t,e){t.index=e,t.sourceLinks=[],t.targetLinks=[]});var o=d3.map(t.nodes,e);t.links.forEach(function(t,e){t.index=e;var n=t.source,i=t.target;"object"!==(void 0===n?"undefined":f(n))&&(n=t.source=Xt(o,n)),"object"!==(void 0===i?"undefined":f(i))&&(i=t.target=Xt(o,i)),n.sourceLinks.push(t),i.targetLinks.push(t)})}(t),t.nodes.forEach(function(t){t.value=Math.max(d3.sum(t.sourceLinks,Gt),d3.sum(t.targetLinks,Gt))}),function(t){var e,n,i;for(e=t.nodes,n=[],i=0;e.length;++i,e=n,n=[])e.forEach(function(t){t.depth=i,t.sourceLinks.forEach(function(t){n.indexOf(t.target)<0&&n.push(t.target)})});for(e=t.nodes,n=[],i=0;e.length;++i,e=n,n=[])e.forEach(function(t){t.height=i,t.targetLinks.forEach(function(t){n.indexOf(t.source)<0&&n.push(t.source)})});var o=(r-a-l)/(i-1);t.nodes.forEach(function(t){t.x1=(t.x0=a+Math.max(0,Math.min(i-1,Math.floor(h.call(null,t,i))))*o)+l})}(t),function(t){var e=d3.nest().key(function(t){return t.x0}).sortKeys(d3.ascending).entries(t.nodes).map(function(t){return t.values});n=d3.min(e,function(t){return(u-s-(t.length-1)*c)/d3.sum(t,Gt)}),e.forEach(function(t){t.forEach(function(t,e){t.y1=(t.y0=e)+t.value*n})}),t.links.forEach(function(t){t.width=t.value*n}),l();var n;for(var i=1,o=d;0<o;--o)r(i*=.99),l(),a(i),l();function a(n){e.forEach(function(t){t.forEach(function(t){if(t.targetLinks.length){var e=(d3.sum(t.targetLinks,Et)/d3.sum(t.targetLinks,Gt)-Bt(t))*n;t.y0+=e,t.y1+=e}})})}function r(n){e.slice().reverse().forEach(function(t){t.forEach(function(t){if(t.sourceLinks.length){var e=(d3.sum(t.sourceLinks,Ht)/d3.sum(t.sourceLinks,Gt)-Bt(t))*n;t.y0+=e,t.y1+=e}})})}function l(){e.forEach(function(t){var e,n,i,o=s,a=t.length;for(t.sort(Nt),i=0;i<a;++i)e=t[i],0<(n=o-e.y0)&&(e.y0+=n,e.y1+=n),o=e.y1+c;if(0<(n=o-c-u))for(o=e.y0-=n,e.y1-=n,i=a-2;0<=i;--i)e=t[i],0<(n=e.y1+c-o)&&(e.y0-=n,e.y1-=n),o=e.y0})}}(t),_(t),t}function _(t){t.nodes.forEach(function(t){t.sourceLinks.sort(jt),t.targetLinks.sort(Dt)}),t.nodes.forEach(function(t){var e=t.y0,n=e;t.sourceLinks.forEach(function(t){t.y0=e+t.width/2,e+=t.width}),t.targetLinks.forEach(function(t){t.y1=n+t.width/2,n+=t.width})})}return o.update=function(t){return _(t),t},o.nodeId=function(t){return arguments.length?(e="function"==typeof t?t:Wt(t),o):e},o.nodeAlign=function(t){return arguments.length?(h="function"==typeof t?t:Wt(t),o):h},o.nodeWidth=function(t){return arguments.length?(l=+t,o):l},o.nodePadding=function(t){return arguments.length?(c=+t,o):c},o.nodes=function(t){return arguments.length?(n="function"==typeof t?t:Wt(t),o):n},o.links=function(t){return arguments.length?(i="function"==typeof t?t:Wt(t),o):i},o.size=function(t){return arguments.length?(a=s=0,r=+t[0],u=+t[1],o):[r-a,u-s]},o.extent=function(t){return arguments.length?(a=+t[0][0],r=+t[1][0],s=+t[0][1],u=+t[1][1],o):[[a,s],[r,u]]},o.iterations=function(t){return arguments.length?(d=+t,o):d},o}function Qt(t){return[t.source.x1,t.y0]}function qt(t){return[t.target.x0,t.y1]}function Ut(){return d3.linkHorizontal().source(Qt).target(qt)}function Jt(){return d3.linkVertical().source(function(t){return[t.y0,t.source.x1]}).target(function(t){return[t.y1,t.target.x0]})}var Kt=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sankey-plot"),e.sankeyFunc=Zt(),e._width=400,e._height=400,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._strokeOpacity=.3,e._sortByIndex=!0,e._onMouseoverLink=function(){},e._onMousemoveLink=function(){},e._onMouseoutLink=function(){},e._eventOnDrag=function(){},e}return u(n,A),l(n,[{key:"update",value:function(){var i=this,e=i._width,o=i._height,t=i._data,a=i.sankeyFunc,n=i.group;a.nodeId(function(t){return t.key}).size([e,o]);var r=a.nodePadding(),l=a(t),s=l.nodes.filter(function(t){return t.sourceLinks.length||t.targetLinks.length}),u=(n.select(".links-group").empty()?n.append("g").attr("class","links-group").style("fill","none"):n.select(".links-group")).selectAll(".link").data(l.links);u.exit().remove();var c=u.enter().append("path").attr("class","link").merge(u).attr("d",Ut()).style("stroke",function(t){return t.source.color}).style("stroke-width",function(t){return Math.max(1,t.width)}).style("stroke-opacity",i._strokeOpacity).on("mouseover",i._onMouseoverLink).on("mousemove",i._onMousemoveLink).on("mouseout",i._onMouseoutLink),h=(n.select(".nodes-group").empty()?n.append("g").attr("class","nodes-group"):n.select(".nodes-group")).selectAll(".node-group").data(s);h.exit().remove();var d=h.enter().append("g").attr("class","node-group");d.append("rect"),d.append("text");var _=d.merge(h).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout);_.select("rect").attr("x",function(t){return t.x0}).attr("y",function(t){return t.y0}).attr("width",function(t){return Math.max(0,t.x1-t.x0)}).attr("height",function(t){return Math.max(0,t.y1-t.y0)}).style("fill",function(t){return t.color}).style("stroke","#333"),_.select("text").attr("x",function(t){return t.x1<=e/2?t.x1+6:t.x0-6}).attr("y",function(t){return(t.y0+t.y1)/2}).attr("dy","0.35em").style("text-anchor",function(t){return t.x1<=e/2?"start":"end"}).style("font-size",i._fontSize+"px").style("font-family",i._fontFamily).style("fill",i._fontColor).text(function(t){return t.y1-t.y0+r<i._fontSize?"":t.name});var f=d3.drag().on("start",function(){d3.select(this).raise()}).on("drag",function(t){var e=d3.event.dy,n=t.y1-t.y0;t.y0=Math.max(0,Math.min(t.y0+e,o-n)),t.y1=t.y0+n,d3.select(this).select("rect").attr("y",t.y0),d3.select(this).select("text").attr("y",function(t){return(t.y0+t.y1)/2}),a.update(l),c.attr("d",Ut()),i._eventOnDrag()});return _.style("cursor","move").call(f),i}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"strokeOpacity",value:function(t){return arguments.length?(this._strokeOpacity=t,this):this._strokeOpacity}},{key:"onMouseoverLink",value:function(t){return arguments.length?(this._onMouseoverLink="function"==typeof t?t:function(){},this):this._onMouseoverLink}},{key:"onMousemoveLink",value:function(t){return arguments.length?(this._onMousemoveLink="function"==typeof t?t:function(){},this):this._onMousemoveLink}},{key:"onMouseoutLink",value:function(t){return arguments.length?(this._onMouseoutLink="function"==typeof t?t:function(){},this):this._onMouseoutLink}},{key:"eventOnDrag",value:function(t){return arguments.length?(this._eventOnDrag="function"==typeof t?t:function(){},this):this._eventOnDrag}},{key:"sortByIndex",value:function(t){return arguments.length?(this._sortByIndex=t,this):this._sortByIndex}}]),n}();function $t(t,e){var r=0,l=1,s=2;if(e.forEach(function(t){"objCol"===t.function?r=t.index:"targetCol"===t.function?l=t.index:"vCol"===t.function&&(s=t.index)}),P(t,[r,l,s])||!x(t,s))return{names:[],nodes:[],links:[],valueLabel:""};var u=[],c=[],h=[],d={},_={};return t.slice(1).forEach(function(t){var e=t[r],n=t[l],i=+t[s],o=e+"-s",a=n+"-t";_[e]||(h.push(e),_[e]=!0),_[n]||(h.push(n),_[n]=!0),d[o]||(u.push({name:e,key:o}),d[o]=!0),d[a]||(u.push({name:n,key:a}),d[a]=!0),i&&c.push({source:o,target:a,value:i})}),{names:h,nodes:u,links:c,valueLabel:t[0][s]}}function te(c,t){var h=0,d=1,_=2;if(t.forEach(function(t){"objCol"===t.function?h=t.index:"targetCol"===t.function?d=t.index:"vCol"===t.function&&(_=t.index)}),P(c,[h,d,_])||h===d||!x(c,_))return{names:[],nodes:[],links:[],valueLabel:""};for(var f=[],p=[],y=[],g={},e=function(t,e){var n=c[t],i=n[h],o=n[d],a=+n[_],r=i,l=o;if(!r||!l||!a||function(t,e,n){if(e===n)return!0;if(t[e]&&0<=t[e].ancestors.indexOf(t[n]))return!0;return!1}(g,r,l))return"continue";g[r]||(f.push({name:i,key:r}),y.push(i),g[r]={ancestors:[],decendents:[]}),g[l]||(f.push({name:o,key:l}),y.push(o),g[l]={ancestors:[],decendents:[]});var s=g[r],u=g[l];[s].concat(v(s.ancestors)).forEach(function(t){var e;(e=t.decendents).push.apply(e,[u].concat(v(u.decendents)))}),[u].concat(v(u.decendents)).forEach(function(t){var e;(e=t.ancestors).push.apply(e,[s].concat(v(s.ancestors)))}),p.push({source:r,target:l,value:a})},n=1,i=c.length;n<i;n++)e(n);return{names:y,nodes:f,links:p,valueLabel:c[0][_]}}var ee=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=this.generateColorList(t.names.length),n=d3.scaleOrdinal().domain(t.names).range(e);return t.nodes.forEach(function(t){return t.color=n(t.name)}),t.legendData=t.names.map(function(t){return{name:t,color:n(t)}}),t}}]),n}(),ne=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sankey-chart"),e.sankey=new Kt(e.mainGroup),e}return u(n,O),l(n,[{key:"updateCore",value:function(){var t=this,n=t.sankey,i=t.tooltip,o=t._data.valueLabel;n.data(t.activeData).width(t.widthOfNoMargin).height(t.heightOfMainGroup).fontSize(t._fontSize).fontFamily(t._fontFamily).fontColor(t._fontColor).onMouseover(function(e){var t=[{color:e.color,text:e.name},{text:o+""+Math.max(d3.sum(e.sourceLinks,function(t){return t.value}),d3.sum(e.targetLinks,function(t){return t.value}))}];n.elem.selectAll(".link").filter(function(t){return t.source===e||t.target===e}).style("stroke-opacity",.9),i.data(t).update().show()}).onMousemove(function(t){i.move()}).onMouseout(function(e){i.hide(),n.elem.selectAll(".link").filter(function(t){return t.source===e||t.target===e}).style("stroke-opacity",n.strokeOpacity())}).onMouseoverLink(function(t){var e=[{text:t.source.name+"  "+t.target.name+""+t.value}];d3.select(this).style("stroke-opacity",.9),i.data(e).update().show()}).onMousemoveLink(function(t){i.move()}).onMouseoutLink(function(t){d3.select(this).style("stroke-opacity",n.strokeOpacity()),i.hide()}).eventOnDrag(function(){i.move()}),n.update()}},{key:"configLegend",value:function(){var t=this,i=t._data;t.legend.data(i.legendData).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.legendData.forEach(function(t){t.name===e.name&&(t.active=!n)}),i.nodes.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new ee(t,e);return n.dataSolveFunc(te),n}},{key:"activeData",get:function(){var t=this._data.nodes,n=this._data.links.filter(function(e){return t.some(function(t){return!1!==t.active&&t.key===e.source})&&t.some(function(t){return!1!==t.active&&t.key===e.target})}).map(function(t){return Object.assign({},t)});return{nodes:t.filter(function(e){return!1!==e.active&&(n.some(function(t){return e.key===t.source})||n.some(function(t){return e.key===t.target}))}).map(function(t){return Object.assign({},t)}),links:n}}}]),n}(),ie=function(t){function e(t){return r(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return u(e,ne),l(e,[{key:"buildOption",value:function(t,e){var n=new ee(t,e);return n.dataSolveFunc($t),n}}]),e}(),oe=function(t){function e(t){return r(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return u(e,Kt),l(e,[{key:"update",value:function(){var i=this,o=i._width,e=i._height,t=i._data,a=i.sankeyFunc,n=i._fontSize,r=i.group.call(H,0,n);a.nodeId(function(t){return t.key}).size([e-2*n,o]);var l=a.nodePadding(),s=a(t),u=s.nodes.filter(function(t){return t.sourceLinks.length||t.targetLinks.length}),c=(r.select(".links-group").empty()?r.append("g").attr("class","links-group").style("fill","none"):r.select(".links-group")).selectAll(".link").data(s.links);c.exit().remove();var h=c.enter().append("path").attr("class","link").merge(c).attr("d",Jt()).style("stroke",function(t){return t.source.color}).style("stroke-width",function(t){return Math.max(1,t.width)}).style("stroke-opacity",i._strokeOpacity).on("mouseover",i._onMouseoverLink).on("mousemove",i._onMousemoveLink).on("mouseout",i._onMouseoutLink),d=(r.select(".nodes-group").empty()?r.append("g").attr("class","nodes-group"):r.select(".nodes-group")).selectAll(".node-group").data(u);d.exit().remove();var _=d.enter().append("g").attr("class","node-group");_.append("rect"),_.append("text");var f=_.merge(d).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout);f.select("rect").attr("x",function(t){return t.y0}).attr("y",function(t){return t.x0}).attr("width",function(t){return Math.max(0,t.y1-t.y0)}).attr("height",function(t){return Math.max(0,t.x1-t.x0)}).style("fill",function(t){return t.color}).style("stroke","#333"),f.select("text").attr("y",function(t){return t.x0<=e/2?t.x0-6:t.x1+6}).attr("x",function(t){return(t.y0+t.y1)/2}).attr("dy",function(t){return t.x0<=e/2?"0":"0.66em"}).style("text-anchor","middle").style("font-size",n+"px").style("font-family",i._fontFamily).style("fill",i._fontColor).text(function(t){return I(t.name,t.y1-t.y0+l,n,i._fontFamily)});var p=d3.drag().on("start",function(){d3.select(this).raise()}).on("drag",function(t){var e=d3.event.dx,n=t.y1-t.y0;t.y0=Math.max(0,Math.min(t.y0+e,o-n)),t.y1=t.y0+n,d3.select(this).select("rect").attr("x",t.y0),d3.select(this).select("text").attr("x",function(t){return(t.y0+t.y1)/2}),a.update(s),h.attr("d",Jt()),i._eventOnDrag()});return f.style("cursor","move").call(p),i}}]),e}(),ae=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","vetical-sankey-chart"),e.sankey=new oe(e.mainGroup),e}return u(n,ne),n}(),re=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.keyArr,n=this.generateColorList(e.length);return t.legendData=e.map(function(t,e){return{name:t,color:n[e]}}),t}}]),n}();function le(t,e){var r=0,l=1,s=2;if(e.forEach(function(t){"objCol"===t.function?r=t.index:"targetCol"===t.function?l=t.index:"vCol"===t.function&&(s=t.index)}),P(t,[r,l,s])||!x(t,s))return{keyArr:[],matrix:[],valueLabel:""};var i=[],u={},o=0;t.slice(1).forEach(function(t){var e=t[r],n=t[l];void 0===u[e]&&(u[e]=o,i.push(e),o++),void 0===u[n]&&(u[n]=o,i.push(n),o++)});var c=d3.range(o).map(function(t){return d3.range(o).map(function(t){return 0})});return t.slice(1).forEach(function(t){var e=t[r],n=t[l],i=t[s],o=u[e],a=u[n];c[o][a]=Math.abs(i)||0}),{keyArr:i,matrix:c,valueLabel:t[0][s]}}var se=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","chord"),e.chordFunc=d3.chord(),e._innerRadius=100,e._outerRadius=120,e._padAngle=.02,e._onMouseoverChord=function(){},e._onMousemoveChord=function(){},e._onMouseoutChord=function(){},e}return u(n,A),l(n,[{key:"update",value:function(){var t=this,e=t._data.matrix,n=t._data.nodes,i=t.group;if(!(n.length<=1)){var o=t._innerRadius,a=t._outerRadius,r=t._padAngle,l=t.chordFunc.padAngle(r).sortChords(d3.descending),s=d3.arc().innerRadius(o).outerRadius(a),u=d3.ribbon().radius(o);i.datum(l(e)).call(H,a,a);var c=i.selectAll(".arc-group").data(function(t){return t.groups});c.exit().remove();var h=c.enter().append("g").attr("class","arc-group");h.append("path").attr("class","arc-path"),h.merge(c).each(t._onTransitionEnd).select("path").attr("d",s).style("fill",function(t){return n[t.index].color}).style("stroke",function(t){return n[t.index].color}).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);var d=i.selectAll(".ribbon-path").data(function(t){return t});return d.exit().remove(),d.enter().append("path").attr("class","ribbon-path").merge(d).attr("d",u).style("fill",function(t){return n[t.source.index].color}).style("stroke",function(t){return d3.rgb(n[t.source.index].color).darker()}).style("fill-opacity",.8).style("stroke-opacity",.8).on("mouseover",t._onMouseoverChord).on("mousemove",t._onMousemoveChord).on("mouseout",t._onMouseoutChord),t}i.selectAll("*").remove()}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"onMouseoverChord",value:function(t){return arguments.length?(this._onMouseoverChord="function"==typeof t?t:function(){},this):this._onMouseoverChord}},{key:"onMousemoveChord",value:function(t){return arguments.length?(this._onMousemoveChord="function"==typeof t?t:function(){},this):this._onMousemoveChord}},{key:"onMouseoutChord",value:function(t){return arguments.length?(this._onMouseoutChord="function"==typeof t?t:function(){},this):this._onMouseoutChord}}]),n}(),ue=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","chord-chart"),e.chord=new se(e.mainGroup),e}return u(n,O),l(n,[{key:"updateCore",value:function(){var o=this,t=o.activeData,a=t.nodes,n=o.chord,i=o.tooltip,e=o.widthOfNoMargin,r=o.heightOfMainGroup,l=o._fontSize,s=o._data.valueLabel,u=Math.min(e,r)/2-l,c=.9*u;function h(t,e){"number"==typeof e?n.group.selectAll(".ribbon-path").filter(function(t){return t.source.index!==e&&t.target.index!==e}).transition().style("opacity",t):n.group.selectAll(".ribbon-path").filter(function(t){return this!==e}).transition().style("opacity",t)}n.data(t).innerRadius(c).outerRadius(u).translate(e/2-u,r/2-u).onMouseover(function(t){var e=t.index,n=[{color:a[e].color,text:a[e].name},{text:s+""+t.value}];i.data(n).update().show(),h(0,e)}).onMousemove(function(){i.move()}).onMouseout(function(t){i.hide(),h(1,t.index)}).onMouseoverChord(function(t){var e=[];e=t.source.value===t.target.value?[{text:a[t.source.index].name+"  "+a[t.target.index].name+""+t.source.value}]:[{text:a[t.source.index].name+"  "+a[t.target.index].name+""+t.source.value},{text:a[t.target.index].name+"  "+a[t.source.index].name+""+t.target.value}],i.data(e).update().show(),h(.1,this)}).onMousemoveChord(function(){i.move()}).onMouseoutChord(function(t){i.hide(),h(1,this)}).onTransitionEnd(function(t){var e=d3.select(this),n="arc-path-"+t.index+"-"+o.id,i=L(u+l-2,t.startAngle,t.endAngle);z(e,o.defs.select("#"+n).empty()?o.defs.append("path").attr("d",i).attr("id",n):o.defs.select("#"+n).attr("d",i),a[t.index].name,l,o._fontFamily).attr("class",o.labelTextClass).style("pointer-events","none").style("fill",o._fontColor)}),n.update()}},{key:"configLegend",value:function(){var t=this,e=t.legend,i=t._data.legendData;e.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new re(t,e);return n.dataSolveFunc(le),n}},{key:"activeData",get:function(){var t=this._data,e=t.matrix,n=t.legendData,i=[];n.forEach(function(t,e){!1===t.active&&i.push(e)});var o=n.filter(function(t){return!1!==t.active}),a=[];return e.forEach(function(t,e){if(i.indexOf(e)<0){var n=[];t.forEach(function(t,e){i.indexOf(e)<0&&n.push(t)}),a.push(n)}}),{nodes:o,matrix:a}}}]),n}(),ce=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-pie"),e.defs=e.elem.append("defs"),e._width=400,e._height=400,e._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},e._countOfOneRow=20,e._rowCount=5,e._padding=2,e}return u(n,A),l(n,[{key:"update",value:function(){var p=this,y=p._data,g=p._width,t=p._height,e=p._padding,v=p._icon,x=p._countOfOneRow,l=p._rowCount,s=d3.sum(y,function(t){return t.value}),i=y.length,u=0,m=y.map(function(t){var e=s<=x*l?t.value:t.value/s*(x*l),n=u+e,i=u;u=n;var o=Math.floor(e),a=!1,r=!1;return i%1!=0&&(a=!0,o++),n%1!=0&&(r=!0,o++),{percent:e,count:o,startPercent:i,endPercent:n,hasHead:a,hasTail:r}});s<x*l&&(l=Math.ceil(s/x)),s<x&&(x=Math.ceil(s));var k=g/x,b=t/l,S=k-2*e,w=b-2*e,O=Math.min(S/v.width,w/v.height);return S=v.width*O,w=v.height*O,function(){var d=p.group,_=p.defs,f=p.id;d.selectAll("*").remove(),_.selectAll("*").remove();var t=f+"-icon";_.append("path").attr("id",t).attr("d",v.path);for(var e=function(e){var n=m[e];if(!n.percent)return"continue";var t=Math.floor(n.startPercent),i=n.startPercent%x*k,o=Math.floor(t/x)*b,a=Math.ceil(n.endPercent),r=n.endPercent%x==0?(n.endPercent-1)%x*k+k:n.endPercent%x*k,l=(Math.ceil(a/x)-1)*b,s=_.append("clipPath").attr("id","clip-path-"+f+"-"+e);s.append("path").attr("id","icon-overlay-"+f+"-"+e).attr("d",function(){var t=Math.floor(n.startPercent/x)<Math.floor(n.endPercent/x),e="M"+i+","+(o+b)+"V"+o+"H"+(t?g:r)+"V"+(t?l:l+b);return t&&(e+="H"+r+"v"+b+"H0V"+(o+b)),e+="Z"}).style("fill","transparent");for(var u=d.append("g").attr("clip-path","url(#clip-path-"+f+"-"+e+")"),c=function(n){var t=u.append("g").attr("transform",function(){var t=n%x*k,e=Math.floor(n/x)*b;return"translate("+t+","+e+")"});t.append("path").attr("class","icon-path-"+e).attr("d",v.path).style("fill",y[e].color).style("stroke-width",1/O).attr("transform","translate("+(k-S)/2+", "+(b-w)/2+")scale("+O+")")},h=t;h<a;h++)c(h);u.append("use").datum({index:e,data:y[e]}).attr("xlink:href","#icon-overlay-"+f+"-"+e).on("mouseover",p._onMouseover).on("mousemove",p._onMousemove).on("mouseout",p._onMouseout)},n=0;n<i;n++)e(n)}(),p}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"padding",value:function(t){return arguments.length?(this._padding=t,this):this._padding}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),n}(),he=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","icon-pie-chart"),e.iconPie=new ce(e.mainGroup),e}return u(n,O),l(n,[{key:"updateCore",value:function(){var t=this,e=t.iconPie,i=t.tooltip,o=e.elem;e.data(t.activeData).width(t.widthOfNoMargin).height(t.heightOfMainGroup).onMouseover(function(t,e){o.selectAll(".icon-path-"+t.index).style("fill-opacity",.4);var n=[{color:t.data.color,text:t.data.name=="$-"+t.index?"":t.data.name},{text:t.data.valueLabel+": "+t.data.value}];i.data(n).update().show()}).onMousemove(function(){i.move()}).onMouseout(function(t){o.selectAll(".icon-path-"+t.index).style("stroke","none").style("fill-opacity",1),i.hide()}),e.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}}]),n}(),de=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-pie"),e.overlayCircle=e.elem.append("defs").append("clipPath").attr("id","overlay-"+e.id).append("circle"),e._radius=0,e._cornerRadius=4,e._padAngle=.01,e._stroke="#fff",e._strokeWidth=1,e._each=function(){},e}return u(n,F),l(n,[{key:"update",value:function(){var t=this,e=t._data,n=t._radius,i=d3.partition().size([2*Math.PI,n])(d3.hierarchy(e).sum(function(t){return t.value})),o=i.descendants(),a=Math.min(d3.min(o,function(t){return t.value})/i.value*Math.PI,t._padAngle),r=d3.arc().startAngle(function(t){return t.x0}).endAngle(function(t){return t.x1}).innerRadius(function(t){return 1===t.depth?t.y0-3:t.y0}).outerRadius(function(t){return 1===t.depth?t.y1-3:t.y1}).padAngle(a).cornerRadius(t._cornerRadius);t.overlayCircle.attr("r",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("r",n);var l=t.group.call(H,n,n).attr("clip-path","url(#overlay-"+t.id+")").selectAll("g").data(o.filter(function(t){return 0!==t.depth}),function(t){return t.data.key});l.exit().remove();var s=l.enter().append("g");return s.append("path"),s.merge(l).select("path").attr("class","arc-path").attr("d",r).style("fill",function(t){if(t.data.color)return t.data.color;var e=t.parent,n=d3.scaleLinear().clamp(!1).domain([0,1]),i=d3.hsl(e.data.color),o=e.children.length;if(1===o)i.l+=.08;else{n.range([i.l+Math.min(.4,.08*o)/2,i.l-Math.min(.4,.08*o)/2]);var a=e.children.indexOf(t)/(o-1);console.log(a),i.l=n(a)}return i}).style("stroke",t._stroke).style("stroke-width",t._strokeWidth).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).each(t._each),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"each",value:function(t){return arguments.length?(this._each="function"==typeof t?t:function(){},this):this._each}}]),n}(),_e=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.nodes,i=this.generateColorList(e.length);return e.forEach(function(t,e){var n=i[e];t.color=n}),t}}]),n}();function fe(t,e){var a=0,r=1,l=2;if(e.forEach(function(t){"objCol"===t.function?a=t.index:"typeCol"===t.function?r=t.index:"vCol"===t.function&&(l=t.index)}),P(t,[a,r,l])||!x(t,l))return{nodes:[],valueLabel:""};var s={};t.slice(1).forEach(function(t,e){var n=t[a],i=t[r],o=t[l];s[n]?s[n].children.push({name:null==i?"":i,key:i+"-t-"+e,index:e,value:""==o||isNaN(parseFloat(o))||null==o||null==o?0:o}):s[n]={name:n,key:n+"-s-"+e,index:e,children:[{name:null==i?"":i,key:i+"-t-"+e,index:e,value:""==o||isNaN(parseFloat(o))||null==o||null==o?0:o}]}});var n=[];for(var i in s)n.push(s[i]);return n.forEach(function(t){return t.sum=d3.sum(t.children,function(t){return t.value})}),{nodes:n,valueLabel:t[0][l]}}var pe=function(t){function e(t){return r(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return u(e,O),l(e,[{key:"updateCore",value:function(){}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.nodes,o=i.map(function(t,e){return{name:t.name,color:t.color,key:t.name+"-"+e}});t.legend.data(o).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),o.forEach(function(t){t.key===e.key&&(t.active=!n)}),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort(function(t,e){return e.sum-t.sum||t.index-e.index}):1===this._sortValue&&t.sort(function(t,e){return t.sum-e.sum||t.index-e.index}),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new _e(t,e);return n.dataSolveFunc(fe),n}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter(function(t){return!1!==t.active})}}}]),e}(),ye=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-donut-chart"),e.core=new de(e.mainGroup),e.lineText=new R(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,pe),l(n,[{key:"updateCore",value:function(){for(var a=this,t=a.core,n=a.tooltip,e=a.lineText,i=a.activeData,o=[],r=[],l=0;l<i.children.length;l++)for(var s=0;s<i.children[l].children.length;s++){i.children[l].children[s].percent=(i.children[l].children[s].value/i.children[l].sum*100).toFixed(1);var u=d3.scaleLinear().clamp(!1).domain([0,1]),c=d3.hsl(i.children[l].color),h=i.children[l].children.length;if(1===h)c.l+=.08;else{u.range([c.l+Math.min(.4,.08*h)/2,c.l-Math.min(.4,.08*h)/2]);var d=i.children[l].children.indexOf(i.children[l].children[s])/(h-1);c.l=u(d)}i.children[l].children[s].color=c,o.push(i.children[l].children[s]),r.push(i.children[l].children[s].name)}var _=a._data.valueLabel,f=(et(r,a._fontSize,a._fontFamily),.74*a.widthOfNoMargin),p=.74*a.heightOfMainGroup;null==a._labelShow||null==a._positionOptions||null==a._positionChoice||null==a._contentOption||null==a._contentChoice||0==a._contentChoice.length?(f=.88*a.widthOfNoMargin,p=.88*a.heightOfMainGroup):0!=a._labelShow&&1!=a._positionOptions.indexOf(a._positionChoice)&&-1!=a._positionOptions.indexOf(a._positionChoice)||(f=.88*a.widthOfNoMargin,p=.88*a.heightOfMainGroup);var y=Math.min(f,p)/2;t.data(a.activeData).radius(y).translate(a.widthOfNoMargin/2-y,a.heightOfMainGroup/2-y).transition(a._transition).duration(a._duration).onMouseover(function(t){var e=[{color:t.data.color||t.parent.data.color,text:t.data.name},{text:_+""+t.value}];n.data(e).update().show(),d3.select(this).transition().duration(20).style("fill-opacity",.7)}).onMousemove(function(){n.move()}).onMouseout(function(){n.hide(),d3.select(this).transition().duration(20).style("fill-opacity",1)}).each(function(t){var e=d3.select(this.parentNode),n="arc-path-"+t.data.key+"-"+t.depth+"-"+a.id,i=L(.5*(t.y0+t.y1),t.x0,t.x1),o=a.defs.select("#"+n).empty()?a.defs.append("path").attr("d",i).attr("id",n):a.defs.select("#"+n).attr("d",i);0==a._labelShow||null==a._labelShow||null==a._positionOptions||null==a._positionChoice||null==a._contentOption||null==a._contentChoice||0==a._contentChoice.length?a.group.selectAll(".chart-label-text").style("display","none"):0!=a._positionOptions.indexOf(a._positionChoice)&&1!=a._positionOptions.indexOf(a._positionChoice)||!t.children?1!=a._positionOptions.indexOf(a._positionChoice)||t.children||(1==a._contentChoice.length?0==a._contentOption.indexOf(a._contentChoice[0])?z(e,o,t.data.name,a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily):1==a._contentOption.indexOf(a._contentChoice[0])?z(e,o,t.data.percent+"%",a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily):2==a._contentOption.indexOf(a._contentChoice[0])&&z(e,o,t.data.value,a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily):2==a._contentChoice.length?0==a._contentOption.indexOf(a._contentChoice[0])&&1==a._contentOption.indexOf(a._contentChoice[1])||1==a._contentOption.indexOf(a._contentChoice[0])&&0==a._contentOption.indexOf(a._contentChoice[1])?z(e,o,t.data.name+"  "+t.data.percent+"%",a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==a._contentOption.indexOf(a._contentChoice[0])&&2==a._contentOption.indexOf(a._contentChoice[1])||2==a._contentOption.indexOf(a._contentChoice[0])&&0==a._contentOption.indexOf(a._contentChoice[1])?z(e,o,t.data.name+"  "+t.data.value,a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==a._contentOption.indexOf(a._contentChoice[0])&&2==a._contentOption.indexOf(a._contentChoice[1])||2==a._contentOption.indexOf(a._contentChoice[0])&&1==a._contentOption.indexOf(a._contentChoice[1]))&&z(e,o,t.data.percent+"%  "+t.data.value,a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==a._contentChoice.length&&z(e,o,t.data.name+"  "+t.data.percent+"%  "+t.data.value,a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve")):z(e,o,t.data.name,a._textLabel.fontSize,a._textLabel.fontFamily,"52%").attr("class",a.labelTextClass).style("pointer-events","none").style("fill",a._textLabel.color).style("font-size",a._textLabel.fontSize).style("font-family",a._textLabel.fontFamily)}),null!=a._labelShow&&(0!=a._labelShow&&0==a._positionOptions.indexOf(a._positionChoice)?(e.data(o).outerRadius(y).cornerRadius(a._cornerRadius).startAngle(a._startAngle).endAngle(a._endAngle).fontSize(a._textLabel.fontSize).fontColor(a._textLabel.color).fontFamily(a._textLabel.fontFamily).labelShow(a._labelShow).positionOptions(a._positionOptions).positionChoice(a._positionChoice).contentOption(a._contentOption).contentChoice(a._contentChoice).values(o).level("two").transition(a._transition).duration(a._duration),a.lineText.translate(a.widthOfNoMargin/2,a.heightOfMainGroup/2).update(),a.group.select(".outside-text-polygon").attr("display","block")):0!=a._labelShow&&1!=a._positionOptions.indexOf(a._positionChoice)&&-1!=a._positionOptions.indexOf(a._positionChoice)||a.group.select(".outside-text-polygon").attr("display","none")),t.update()}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}}]),n}(),ge=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.nodes,n=this.generateColorList(e.length);return e.forEach(function(t,e){return t.color=n[e]}),t}}]),n}();function ve(t,e){var n=0,i=1;return e.forEach(function(t){"objCol"===t.function?n=t.index:"vCol"===t.function&&(i=t.index)}),P(t,[n,i])||!x(t,i)?{nodes:[],valueLabel:""}:{nodes:t.slice(1).map(function(t,e){return{name:t[n],key:t[n]+"-"+e,value:t[i]}}),valueLabel:t[0][i]}}var xe=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","treemap"),e._width=400,e._height=400,e._paddingInner=1,e}return u(n,A),l(n,[{key:"update",value:function(){var o=this,t=o._data,e=o.group,a=o._fontSize,r=o._fontFamily;if(t.children.length<1)return e.selectAll("*").remove(),o;var n=d3.treemap().size([o._width,o._height]).paddingInner(o._paddingInner).round(!0),i=d3.hierarchy(t).sum(function(t){return t.value});n(i);var l=e.selectAll(".node").data(i.leaves(),function(t){return t.data.key});l.exit().remove();var s=l.enter().append("g").attr("class","node");s.append("rect"),s.merge(l).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout).transition().duration(o._transition?o._duration:0).on("end",o._onTransitionEnd).select("rect").attr("x",function(t){return t.x0}).attr("y",function(t){return t.y0}).attr("width",function(t){return t.x1-t.x0}).attr("height",function(t){return t.y1-t.y0}).style("fill",function(t){return t.data.color}),o.group.selectAll(".one-level-treemap-group").remove();var u=e.append("g").selectAll("g").data(i.leaves(),function(t){return t.data.key});return u.exit().remove(),u.enter().append("g").attr("class","one-level-treemap-group").merge(u).each(function(t,e){t.y1,t.y0;var n=t.x1-t.x0,i=d3.select(this).append("g").attr("class","one-level-treemap-texts").attr("transform",function(){return null==o._positionOptions||null==o._positionChoice?0:0==o._positionOptions.indexOf(o._positionChoice)?"translate("+(t.x0+6)+","+(t.y0+6)+")":1==o._positionOptions.indexOf(o._positionChoice)?"translate("+((t.x1-t.x0)/2+t.x0)+","+((t.y1-t.y0)/2+t.y0)+")":void 0}).attr("font-size",a+"px").attr("font-family",r).attr("text-anchor",function(){return null==o._positionOptions||null==o._positionChoice?0:0==o._positionOptions.indexOf(o._positionChoice)?"start":1==o._positionOptions.indexOf(o._positionChoice)?"middle":void 0}).style("fill",o._fontColor);i.append("text").attr("class","one-level-treemap-name").attr("dy","0.75em").text(I(null==t.data.name?"":t.data.name,n-10,a,r)),i.append("text").attr("class","one-level-treemap-percent").attr("dy","2em").text(I(isNaN(parseFloat(t.data.value))?"":t.data.percent,n-10,a,r)),i.append("text").attr("class","one-level-treemap-value").attr("dy","3.25em").text(I(isNaN(parseFloat(t.data.value))?"":t.data.value,n-10,a,r))}),0==o._labelShow||null==o._labelShow||null==o._positionOptions||null==o._positionChoice||null==o._contentOption||null==o._contentChoice||0==o._contentChoice.length?o.group.selectAll(".one-level-treemap-group").style("display","none"):0==o._positionOptions.indexOf(o._positionChoice)?1==o._contentChoice.length?0==o._contentOption.indexOf(o._contentChoice[0])?(o.group.selectAll(".one-level-treemap-name").style("display","block"),o.group.selectAll(".one-level-treemap-percent").style("display","none"),o.group.selectAll(".one-level-treemap-value").style("display","none")):1==o._contentOption.indexOf(o._contentChoice[0])?(o.group.selectAll(".one-level-treemap-name").style("display","none"),o.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.75em"),o.group.selectAll(".one-level-treemap-value").style("display","none")):2==o._contentOption.indexOf(o._contentChoice[0])&&(o.group.selectAll(".one-level-treemap-name").style("display","none"),o.group.selectAll(".one-level-treemap-percent").style("display","none"),o.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","0.75em")):2==o._contentChoice.length?0==o._contentOption.indexOf(o._contentChoice[0])&&1==o._contentOption.indexOf(o._contentChoice[1])?(o.group.selectAll(".one-level-treemap-name").style("display","block"),o.group.selectAll(".one-level-treemap-percent").style("display","block"),o.group.selectAll(".one-level-treemap-value").style("display","none")):0==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])?(o.group.selectAll(".one-level-treemap-name").style("display","block"),o.group.selectAll(".one-level-treemap-percent").style("display","none"),o.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","2em")):1==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])&&(o.group.selectAll(".one-level-treemap-name").style("display","none"),o.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.75em"),o.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","2em")):3==o._contentChoice.length&&(o.group.selectAll(".one-level-treemap-name").style("display","block"),o.group.selectAll(".one-level-treemap-percent").style("display","block"),o.group.selectAll(".one-level-treemap-value").style("display","block")):1==o._positionOptions.indexOf(o._positionChoice)&&(1==o._contentChoice.length?0==o._contentOption.indexOf(o._contentChoice[0])?(o.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","0.5em"),o.group.selectAll(".one-level-treemap-percent").style("display","none"),o.group.selectAll(".one-level-treemap-value").style("display","none")):1==o._contentOption.indexOf(o._contentChoice[0])?(o.group.selectAll(".one-level-treemap-name").style("display","none"),o.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.5em"),o.group.selectAll(".one-level-treemap-value").style("display","none")):2==o._contentOption.indexOf(o._contentChoice[0])&&(o.group.selectAll(".one-level-treemap-name").style("display","none"),o.group.selectAll(".one-level-treemap-percent").style("display","none"),o.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","0.5em")):2==o._contentChoice.length?0==o._contentOption.indexOf(o._contentChoice[0])&&1==o._contentOption.indexOf(o._contentChoice[1])?(o.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","-0.125em"),o.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","1.125em"),o.group.selectAll(".one-level-treemap-value").style("display","none")):0==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])?(o.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","-0.125em"),o.group.selectAll(".one-level-treemap-percent").style("display","none"),o.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","1.125em")):1==o._contentOption.indexOf(o._contentChoice[0])&&2==o._contentOption.indexOf(o._contentChoice[1])&&(o.group.selectAll(".one-level-treemap-name").style("display","none"),o.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","-0.125em"),o.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","1.125em")):3==o._contentChoice.length&&(o.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","-0.75em"),o.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.5em"),o.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","1.75em"))),o}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}}]),n}(),me=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","one-level-treemap-chart"),e.treemap=new xe(e.mainGroup),e._sortValue=-1,e._marginLeft=20,e._marginRight=20,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=["",""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){for(var t=this,e=t.treemap,n=t.tooltip,i=t.widthOfNoMargin,o=t.heightOfMainGroup,a=t._data.valueLabel,r=(t._fontSize,t._fontFamily,t.activeData),l=0,s=0;s<(0==r.length?0:r.children.length);s++)l+=isNaN(parseFloat(r.children[s].value))?0:parseFloat(r.children[s].value);for(var u=0;u<r.children.length;u++)r.children[u].percent=((isNaN(parseFloat(r.children[u].value))?0:parseFloat(r.children[u].value))/l*100).toFixed(2)+"%";e.data(t.activeData).width(i).height(o).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(t._duration).onMouseover(function(t){var e=[{color:t.data.color,text:t.data.name},{text:a+""+(-1==String(t.value).indexOf(".")?t.value:t.value.toFixed(2))}];n.data(e).update().show(),d3.select(this).style("fill-opacity",.7)}).onMousemove(function(){n.move()}).onMouseout(function(){n.hide(),d3.select(this).style("fill-opacity",1)}).onTransitionEnd(function(t){}),e.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.nodes;t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){-1===this._sortValue&&this._data.nodes.sort(function(t,e){return e.value-t.value}),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new ge(t,e);return n.dataSolveFunc(ve),n}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter(function(t){return!1!==t.active})}}}]),n}(),ke=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-treemap"),e._clipId="clip-overlay-"+e.id,e.overlayRect=e.elem.append("defs").append("clipPath").attr("id",e._clipId).append("rect"),e.group.attr("clip-path","url(#"+e._clipId+")"),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleLinear(),e._width=400,e._height=400,e._paddingInner=1,e._paddingOuter=2,e._stroke="#fff",e._parentFillOpacity=.7,e._transition=!1,e._duration=400,e}return u(n,A),l(n,[{key:"update",value:function(){var o=this,t=o._data,a=o.group;if(t.children.length<1)return a.selectAll("*").remove(),o;var r=!1,l=!1,e=o._width,n=o._height,s=o.xScale.domain([0,1]).range([0,e]),u=o.yScale.domain([0,1]).range([0,n]),c=d3.hierarchy(t).sum(function(t){return t.value});function i(){var t=(a.select(".children-group").empty()?a.append("g").attr("class","children-group"):a.select(".children-group")).selectAll(".child-node").data(c.leaves(),function(t){return t.data.key});t.exit().remove();var e=t.enter().append("g").attr("class","child-node");e.append("rect"),e.merge(t).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout).on("click",function(){l=!0,d(c)}).transition().duration(o._transition||l?o._duration:0).on("start",r?o._onTransitionStart:null).on("end.a",r?o._onTransitionEnd:null).on("end.b",function(){l=!1}).select("rect").attr("x",function(t){return s(t.x0)}).attr("y",function(t){return u(t.y0)}).attr("width",function(t){return s(t.x1)-s(t.x0)}).attr("height",function(t){return u(t.y1)-u(t.y0)}).style("fill",function(t){return t.parent.data.color}).style("stroke",o._stroke).style("stroke-width",o._paddingInner).style("opacity",1)}function h(){var t=a.select(".parent-group").empty()?a.append("g").attr("class","parent-group"):a.select(".parent-group"),e=c.descendants().filter(function(t){return 1===t.depth}),n=t.selectAll(".parent-node").data(e,function(t){return t.data.key});n.exit().remove();var i=n.enter().append("g").attr("class","parent-node");i.append("rect"),i.merge(n).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout).on("click",function(t){l=!0,d(t)}).transition().duration(o._transition||l?o._duration:0).on("start.a",r?null:o._onTransitionStart).on("start.b",function(){t.style("display",r?"none":"block")}).on("end",r?null:o._onTransitionEnd).select("rect").attr("x",function(t){return s(t.x0)}).attr("y",function(t){return u(t.y0)}).attr("width",function(t){return s(t.x1)-s(t.x0)}).attr("height",function(t){return u(t.y1)-u(t.y0)}).style("fill",function(t){return t.data.color}).style("fill-opacity",o._parentFillOpacity).style("stroke",o._stroke).style("stroke-width",o._paddingOuter).style("opacity",1)}function d(t){var e=t.depth;s.domain([t.x0,t.x1]),u.domain([t.y0,t.y1]),r=1===e,i(),h()}return d3.treemap().size([1,1]).round(!1)(c),o.overlayRect.attr("width",e).attr("height",n),d(c),o}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),n}(),be=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","two-level-treemap-chart"),e.treemap=new ke(e.mainGroup),e._sortValue=-1,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=["",""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,pe),l(n,[{key:"updateCore",value:function(){for(var l=this,s=l.treemap,n=l.tooltip,t=l.widthOfNoMargin,e=l.heightOfMainGroup,i=l._data.valueLabel,u=(l._fontSize,l._fontFamily),o=l.activeData,a=0,r=0;r<o.children.length;r++)a+=o.children[r].sum;for(var c=0;c<o.children.length;c++){o.children[c].percent=(o.children[c].sum/a*100).toFixed(2)+"%";for(var h=0;h<o.children[c].children.length;h++)o.children[c].children[h].percent=(parseFloat(o.children[c].children[h].value)/o.children[c].sum*100).toFixed(2)+"%"}s.data(l.activeData).width(t).height(e).onMouseover(function(t){var e=[{color:t.data.color||t.parent.data.color,text:t.data.name},{text:i+""+(-1==String(t.value).indexOf(".")?t.value:t.value.toFixed(2))}];n.data(e).update().show(),d3.select(this).select("rect").style("opacity",.5)}).onMousemove(function(){n.move()}).onMouseout(function(){n.hide(),d3.select(this).select("rect").style("opacity",1)}).onTransitionStart(function(){s.elem.selectAll(".two-level-treemap-texts").remove()}).onTransitionEnd(function(t){var e=s.xScale,n=s.yScale,i=n(t.y1)-n(t.y0),o=e(t.x1)-e(t.x0),a=d3.select(this).append("g").attr("class","two-level-treemap-texts").attr("transform",function(){return null==l._positionOptions||null==l._positionChoice?"translate(0)":0==l._positionOptions.indexOf(l._positionChoice)?"translate("+(e(t.x0)+6)+","+(n(t.y0)+6)+")":1==l._positionOptions.indexOf(l._positionChoice)?"translate("+((e(t.x1)-e(t.x0))/2+e(t.x0))+","+((n(t.y1)-n(t.y0))/2+n(t.y0))+")":void 0}).style("font-size",l._textLabel.fontSize+"px").style("font-family",l._textLabel.fontFamily).style("fill",l._textLabel.color).attr("text-anchor",function(){return null==l._positionOptions||null==l._positionChoice?0:0==l._positionOptions.indexOf(l._positionChoice)?"start":1==l._positionOptions.indexOf(l._positionChoice)?"middle":void 0}),r="";i>l._textLabel.fontSize+10&&(r=I(t.data.name,o-10,l._textLabel.fontSize,u),a.append("text").attr("class","two-level-treemap-name").attr("dy","0.75em").text(r),a.append("text").attr("class","two-level-treemap-percent").attr("dy","2em").text(I(t.data.percent,o-10,l._textLabel.fontSize,u)),a.append("text").attr("class","two-level-treemap-value").attr("dy","3.25em").text(I(-1==String(t.value).indexOf(".")?t.value:t.value.toFixed(2),o-10,l._textLabel.fontSize,u))),0==l._labelShow||null==l._labelShow||null==l._positionOptions||null==l._positionChoice||null==l._contentOption||null==l._contentChoice||0==l._contentChoice.length?l.group.selectAll(".two-level-treemap-texts").style("display","none"):0==l._positionOptions.indexOf(l._positionChoice)?1==l._contentChoice.length?0==l._contentOption.indexOf(l._contentChoice[0])?(l.group.selectAll(".two-level-treemap-name").style("display","block"),l.group.selectAll(".two-level-treemap-percent").style("display","none"),l.group.selectAll(".two-level-treemap-value").style("display","none")):1==l._contentOption.indexOf(l._contentChoice[0])?(l.group.selectAll(".two-level-treemap-name").style("display","none"),l.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.75em"),l.group.selectAll(".two-level-treemap-value").style("display","none")):2==l._contentOption.indexOf(l._contentChoice[0])&&(l.group.selectAll(".two-level-treemap-name").style("display","none"),l.group.selectAll(".two-level-treemap-percent").style("display","none"),l.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","0.75em")):2==l._contentChoice.length?0==l._contentOption.indexOf(l._contentChoice[0])&&1==l._contentOption.indexOf(l._contentChoice[1])?(l.group.selectAll(".two-level-treemap-name").style("display","block"),l.group.selectAll(".two-level-treemap-percent").style("display","block"),l.group.selectAll(".two-level-treemap-value").style("display","none")):0==l._contentOption.indexOf(l._contentChoice[0])&&2==l._contentOption.indexOf(l._contentChoice[1])?(l.group.selectAll(".two-level-treemap-name").style("display","block"),l.group.selectAll(".two-level-treemap-percent").style("display","none"),l.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","2em")):1==l._contentOption.indexOf(l._contentChoice[0])&&2==l._contentOption.indexOf(l._contentChoice[1])&&(l.group.selectAll(".two-level-treemap-name").style("display","none"),l.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.75em"),l.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","2em")):3==l._contentChoice.length&&(l.group.selectAll(".two-level-treemap-name").style("display","block"),l.group.selectAll(".two-level-treemap-percent").style("display","block"),l.group.selectAll(".two-level-treemap-value").style("display","block")):1==l._positionOptions.indexOf(l._positionChoice)&&(1==l._contentChoice.length?0==l._contentOption.indexOf(l._contentChoice[0])?(l.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","0.5em"),l.group.selectAll(".two-level-treemap-percent").style("display","none"),l.group.selectAll(".two-level-treemap-value").style("display","none")):1==l._contentOption.indexOf(l._contentChoice[0])?(l.group.selectAll(".two-level-treemap-name").style("display","none"),l.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.5em"),l.group.selectAll(".two-level-treemap-value").style("display","none")):2==l._contentOption.indexOf(l._contentChoice[0])&&(l.group.selectAll(".two-level-treemap-name").style("display","none"),l.group.selectAll(".two-level-treemap-percent").style("display","none"),l.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","0.5em")):2==l._contentChoice.length?0==l._contentOption.indexOf(l._contentChoice[0])&&1==l._contentOption.indexOf(l._contentChoice[1])?(l.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","-0.125em"),l.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","1.125em"),l.group.selectAll(".two-level-treemap-value").style("display","none")):0==l._contentOption.indexOf(l._contentChoice[0])&&2==l._contentOption.indexOf(l._contentChoice[1])?(l.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","-0.125em"),l.group.selectAll(".two-level-treemap-percent").style("display","none"),l.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","1.125em")):1==l._contentOption.indexOf(l._contentChoice[0])&&2==l._contentOption.indexOf(l._contentChoice[1])&&(l.group.selectAll(".two-level-treemap-name").style("display","none"),l.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","-0.125em"),l.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","1.125em")):3==l._contentChoice.length&&(l.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","-0.75em"),l.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.5em"),l.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","1.75em")))}),s.update()}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort(function(t,e){return e.sum-t.sum||t.index-e.index}).forEach(function(t){t.children.sort(function(t,e){return e.sum-t.sum||t.index-e.index})}):1===this._sortValue&&t.sort(function(t,e){return t.sum-e.sum||t.index-e.index}).forEach(function(t){t.children.sort(function(t,e){return t.sum-e.sum||t.index-e.index})}),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}}]),n}();function Se(t,e){var n=0,i=0;if(e.forEach(function(t){"sourceCol"===t.function?n=t.index:"targetCol"===t.function&&(i=t.index)}),P(t,[n,i]))return{nodesObj:{},nodesArr:[],root:{}};for(var o=[],a={},r=0,l=t.length,s=1;s<l;s++){var u=t[s],c=u[n],h=u[i];if(c&&h&&c!==h){if(!a[c]){var d={name:c,index:r};a[c]=d,o.push(d),r++}if(!a[h]){var _={name:h,index:r};a[h]=_,o.push(_),r++}var f=a[c],p=a[h];p.parent||((p.parent=f).children?f.children.push(p):f.children=[p])}}var y=null,g=o.filter(function(t){return!t.parent});return function e(t){var n=t.depth?t.depth:t.depth=0;t.children&&t.children.forEach(function(t){t.depth=n+1,e(t)})}(y=1===g.length?g[0]:1<g.length?{name:"",children:g}:{name:"",children:[]}),{nodesObj:a,nodesArr:o,root:y}}function we(t,e){var n=Se(t[0],e[0]),i=ve(t[1],e[1]);return n.nodesArr.forEach(function(e){i.nodes.forEach(function(t){e.name===t.name&&(e.value=t.value)})}),{root:n.root,valueLabel:i.valueLabel}}var Oe=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data,this._columnMap),e=t.root;if(e&&e.children){var n=e.children.slice(0);e.name&&n.unshift(e),S(n,this.generateColorList(n.length))}return{root:t.root,valueLabel:t.valueLabel}}}]),n}(),Ce=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sunburst"),e.arcFunc=d3.arc(),e._radius=200,e._stroke="#fff",e._duration=750,e}return u(n,A),l(n,[{key:"update",value:function(){var u,c,a=this,t=a._data,e=a._radius,i=d3.hierarchy(t).sum(function(t){return t.value}),r=2*Math.PI,o=d3.partition().size([r,e]);o(i),c=u=.075,function n(t,e){if(1<t.depth){var i=t.parent,o=i.children.length-1,a=Math.pow(-1,t.depth),r=d3.hsl(i.data.color),l=r.l;c=a<0&&l<u*o?l/(o+2):0<a&&1-l<u*o?(1-l)/(o+2):u,r.l+=c*e*a,t.data.color=r.toString()}var s=t.children;s&&s.forEach(function(t,e){n(t,e)})}(i);var n=a.arcFunc.innerRadius(function(t){return Math.max(0,t.y0)}).outerRadius(function(t){return Math.max(0,t.y1)}).startAngle(function(t){return t.x0}).endAngle(function(t){return t.x1}),l=a.group,s=!1,h={oldState:f(i),newState:f(i),currentRootNode:i,currentClickedNode:i};function d(t){var e=t.data.name?t.descendants():t.descendants().slice(1),n=l.selectAll(".arc-group").data(e,function(t){return t.data.name});n.select("text").remove(),n.exit().transition().duration(a._transition||s?a._duration:0).on("start",a._onTransitionStart).remove().select("path").attrTween("d",function(t){return p.call(this,function(t){if(!s)return{x0:t.x0,x1:t.x1,y0:0,y1:0};if(t.depth<h.currentClickedNode.depth)return{x0:t.x0,x1:t.x1,y0:0,y1:0};return{x0:t.x0>=h.oldState.x1?r:0,x1:t.x0>=h.oldState.x1?r:0,y0:0,y1:0}}(t))});var i=n.enter().append("g").attr("class","arc-group");i.append("path").style("fill",function(t){return t.data.color}).style("stroke",a._stroke).each(function(t){this._currentArc=function(t){if(!s)return{x0:t.x0,x1:t.x1,y0:0,y1:0};return{x0:t.x0>=h.newState.x1?r:0,x1:t===h.currentRootNode||t.x0>=h.newState.x1?r:0,y0:0,y1:0}}(t)});var o=i.merge(n).on("click",_).on("mouseover",a._onMouseover).on("mousemove",a._onMousemove).on("mouseout",a._onMouseout);o.select("path").style("fill",function(t){return t.data.color}).style("stroke",a._stroke),o.transition().duration(a._transition||s?a._duration:0).on("start",a._onTransitionStart).on("end.a",a._onTransitionEnd).on("end.b",function(){s=!1}).select("path").attrTween("d",function(t){return p.call(this,f(t))})}function _(e){if(!s&&e.data.name!==i.data.name){s=!0;var t=(h.currentClickedNode=e)===h.currentRootNode?e.data.parent:e.data;h.oldState=f(e),h.currentRootNode=d3.hierarchy(t).sum(function(t){return t.value}),o(h.currentRootNode);var n=h.currentRootNode.descendants().filter(function(t){return t.data.name===e.data.name})[0];h.newState=f(n),d(h.currentRootNode)}}function f(t){return{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1}}function p(t){var e=d3.interpolate(this._currentArc,t);return this._currentArc=e(0),function(t){return n(e(t))}}return d(i),a}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}}]),n}();var Ae=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","sunburst-chart"),e.sunburst=new Ce(e.mainGroup),e._sortValue=-1,e._labelShow=!0,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){var n=this,i=n.sunburst,o=n.tooltip,a=n.activeData,t=n.widthOfNoMargin,e=n.heightOfMainGroup,r=Math.min(t,e)/2,l=n._fontSize,s=n._fontFamily;i.data(a.root).radius(r).translate(t/2,e/2).transition(n._transition).duration(n._duration).onMouseover(function(t){var e=[{color:t.data.color,text:t.data.name},{text:a.valueLabel+""+t.value}];o.data(e).update().show()}).onMousemove(function(){o.move()}).onMouseout(function(){o.hide()}).onTransitionStart(function(){d3.select(this).select("text").style("opacity",0).remove()}).onTransitionEnd(function(t){var a=i.arcFunc,e="";(e=0===t.depth?I(t.data.name,2*(t.y1-t.y0),l,s):t.y0*(t.x1-t.x0)<1.25*l?"":I(t.data.name,t.y1-t.y0,l,s))&&(d3.select(this).append("text").attr("class",n.labelTextClass).style("pointer-events","none").style("font-size",n._textLabel.fontSize+"px").style("font-family",n._textLabel.fontFamily).style("fill",n._textLabel.color).attr("transform",function(t){var e,n,i=90<(n=(((e=t).x0+e.x1)/2-Math.PI/2)/Math.PI*180)?n-180:n,o=a.centroid(t);return 0===t.depth&&(o=[i=0,0]),"translate("+o+")rotate("+i+")"}).append("tspan").attr("class","sunburst-texts").attr("x",0).attr("y",0).attr("dy","0.35em").style("text-anchor","middle").style("fill",n._textLabel.color).text(e),0==n._labelShow?d3.selectAll(".sunburst-texts").style("display","none"):d3.selectAll(".sunburst-texts").style("display","block"))}),i.update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.root,i=e.children?e.children.map(function(t){return t}):[];e.name&&i.unshift(e),t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){var t=this._data,e=t.root;!function e(t){var n=Math.abs(t.value)||0;t.children&&t.children.forEach(function(t){n+=e(t)});t.sum=n;return n}(e),-1===this._sortValue&&function e(t){t.children&&t.children.sort(function(t,e){return e.sum-t.sum||t.index-e.index}).forEach(function(t){e(t)})}(e),this._sortedDataCopy=t}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new Oe(t,e);return n.dataSolveFunc(we),n}},{key:"activeData",get:function(){var t=this.sortedDataCopy,e=t.root,n={name:e.name,color:e.color,value:e.value,sum:e.sum,children:e.children&&e.children.filter(function(t){return!1!==t.active})};return!1===e.active&&(n.children=[]),{root:n,valueLabel:t.valueLabel}}}]),n}();var Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAI6SURBVHjafJLLTlNhFIX7GlBaUJwABYlODIWWJoAil0QBQZyQoPGpIFigpVJNeAkSSCRATI2A1BZs6WnOIcSe/3Iu+ZxoC0njYI3WWoNv7xWwrOtDIYRRq9l12bYwtHaMXO67obU2bPuuL4QwLMs6CEipfyulkFLWBZDJfOZB52PW1zMAKNXwlVIoJW8CQkhTSokQAiEEnueSze4QDvURDvXSFoyQSmXxPLee+Zuv3in7vkelYrAwv0xieJpIzwCJ4WnmZpcolcr4vt+87PsehlGlVqshhSSfLxAbmuDk5AwpFbZtU6kY+L7XKEupTIDt7R0W5pfrzOXyFfHYJMXiBQCO4/Bm8T2bm9sASCmrAcdxzHT6E+FQL4nhafL5AuXSFQcHxwxGx9nf+0K5fEWxeMnTsRmCrT0kkxm01tXAt9yJ2Xn/EeFQL5GeKLHYJPHYFIPR53R3PWEwOk48PkU8NkkkEqU9/JCO9n6Ojr5WA1prM5ncoi0YITE8zenpD4rFS/b3D4gOPGN3d4+Li0vOz38yNjpDa0sXKyvrKKUazKlUlrnZpVvMlTvMruvweuEta2vpBvPta5dLV9i2jdaaQuGC2NAEZ2fnOI6DbduUSmU8z0Mp1ezPPpWKweLiO0ZHXhLpiTI68oL5V8uUfv3nz//W47ou6VSWtmCE9nAfrS3dfPiwhes2WZiUqum2NzY+cq+jn9XVzabbllLeBCzr+kgIadq2qEsIaWrHMY+Pc6bW2mzmW5Z1+GcAWWbj+pgdyZ8AAAAASUVORK5CYII=",Le=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","tree"),e._width=400,e._height=400,e._visibleDepth=5,e._maxRadius=20,e._textPadding=4,e._linkStrokeOpacity=.35,e._nodeFillOpacity=.45,e._nodeStrokeOpacity=.6,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._hasValue=!0,e}return u(n,A),l(n,[{key:"update",value:function(){var o=this,t=o._data,e=o._width,n=o._height,i=n/2,a=Math.min(o._maxRadius,Math.floor(.0375*n)),r=o._fontSize,l=o._fontFamily,s=o._textPadding,u=8*r,c=o._labelShow?5*r:10,h=Math.min(V(t.name,r,l),u),d=o._labelShow?h+s+a:10,_=d3.hierarchy(t).sum(function(t){return t.value||0}),f=_.descendants(),p=_.leaves().length,y=d3.max(f,function(t){return t.depth})||1,g=d3.max(f,function(t){return t.value}),v=(e-d-c)/Math.min(o._visibleDepth,y),x=Math.max(n/p,r+4),m=v-2*s,k=d3.tree().nodeSize([x,v]).separation(function(t,e){return t.parent==e.parent?1:1.25}),b=d3.linkHorizontal().x(function(t){return t.y}).y(function(t){return t.x}),S=d3.zoom().scaleExtent([.1,3]);k(_);var w=d3.max(f,function(t){return t.x}),O=d3.min(f,function(t){return t.x}),C=n/2;(i<-O&&w<i||-O<i&&i<w)&&(C-=(w+O)/2);var A=d3.scaleSqrt().domain([0,g]).range([0,a]),F=o._hasValue,L=function(t){var e=t.depth?A(t.value):a/2;return F?e:a},M=function(t){return F?t.data.color:t._children?t.data.color:"#fff"},z=function(t){var e=F&&0===t.depth?a:L(t);return(t.children||t._children?-1:1)*(e+s)},R=!1,T=function(){return o._transition||R?o._duration:0},P=o.group;P.transition().duration(T).call(H,d,C),P.select(".bg-rect").empty()?P.append("rect").attr("class","bg-rect").attr("width",e).attr("height",n).style("opacity",0).call(H,-d,-C):P.select(".bg-rect");var W=P.select(".zoom-group").empty()?P.append("g").attr("class","zoom-group"):P.select(".zoom-group"),D=W.select(".links-group").empty()?W.append("g").attr("class","links-group"):W.select(".links-group"),j=W.select(".nodes-group").empty()?W.append("g").attr("class","nodes-group"):W.select(".nodes-group"),N=!1,G=P.select(".zoom-controller");function B(t){var n,e;k(_),n=t,(e=D.selectAll("path").data(_.links(),function(t){return t.target.data.name})).enter().append("path").attr("d",function(t){var e={x:n.x0,y:n.y0};return b({source:e,target:e})}).merge(e).style("fill","none").style("stroke-width",function(t){return 2*L(t.target)}).style("stroke",function(t){return t.target.data.color}).style("stroke-linecap","round").style("stroke-opacity",o._linkStrokeOpacity).transition().duration(T).attr("d",function(t){return b(t)}),e.exit().transition().duration(T).attr("d",function(t){var e={x:n.x,y:n.y};return b({source:e,target:e})}).remove(),function(e){var t=j.selectAll(".node-group").data(_.descendants(),function(t){return t.data.name}),n=t.enter().append("g").attr("class","node-group").style("cursor","pointer").attr("transform",function(t){return"translate("+e.y0+","+e.x0+")"}).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout);n.append("circle").attr("r",L).style("fill",M).style("fill-opacity",o._nodeFillOpacity).style("stroke",function(t){return t.data.color}).style("stroke-opacity",o._nodeStrokeOpacity),t.select("circle").style("fill",M).style("stroke",function(t){return t.data.color}),n.append("text").attr("class","tree-texts").attr("x",z).attr("y",0).attr("dy","0.35em").style("text-anchor",function(t){return t.children||t._children?"end":"start"}).style("font-size",o._fontSize+"px").style("font-family",o._fontFamily).style("fill",o._fontColor).text(function(t){return t.depth?I(t.data.name,m,o._fontSize,l):I(t.data.name,u,r,l)}),n.merge(t).on("click",E).transition().duration(T).attr("transform",function(t){return"translate("+t.y+","+t.x+")"}).on("end",function(){R=!1}).select("text").style("fill-opacity",o._labelShow?1:0);var i=t.exit().transition().duration(T).attr("transform",function(){return"translate("+e.y+","+e.x+")"}).remove();i.select("circle").attr("r",0),i.select("text").style("fill-opacity",0)}(t),f.forEach(function(t){t.x0=t.x,t.y0=t.y})}function E(t){var e;R=!0,(e=t).children?(e._children=e.children,e.children=null):e._children&&(e.children=e._children,e._children=null),B(t=e)}G.empty()?(G=P.append("image").attr("class","zoom-controller").attr("x",-d).attr("y",-C).attr("xlink:href",Fe).on("click",function(){N=!N,P.on(".zoom",null),N?(G.attr("xlink:href","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGpSURBVHjafJLNruIwDIV5/zdBQqAKKHXzJxXYQlrgFdreRWgCG9rb5MyCuR0KM7OwFOXks3NsT+I4Pi+XS/MeURQZIjJRFH1oq9XKTKfT00QIceec4zWSJIHWObquQ1EUSJJkpCulsFgs7hPOuWGM4SeICIfDAd4HhAB4H6C1BhENb4QQmM/nZgSnaQrOOaqqhrUObdvBWoe6/oIQYkjwARMROBdDEiklrHVQSoEoBWMMnD8TjOA4jnE4HFFVNdI0BRG9wQQiQlmW0HkOInrCaZqa41Gj73tY6yClhJQS2+0Wzt2w3e4gpYQQAtdrg957nE5nzGYzM8myzHTdN0LA4NFaB+duaNsOzt2Gu8ejRQgB3ges1+tn5TzP0fd++KZSCrvdDs7dsN/voZSClBLXawPvAy6Xy7Pyj2etNer665+ek4RQlhWKovjj+bXbQgi8np+wHI3oo9vjOQuUZYWmsXg8WjSNRVXV/5/z64ZprYcNCwHI8wJEyV837P4KM8YQb2JonaNtOxTFCZvNZqT/hu8TzvmZMWbeg4hMlmWGiD40IYSJouj0awAemusiRGff+AAAAABJRU5ErkJggg==").select("title").text(""),P.call(S)):G.attr("xlink:href",Fe).select("title").text("")})).append("title").text(""):G.attr("x",-d).attr("y",-C),_.x0=_.x,_.y0=_.y,S.on("zoom",function(){var t=d3.event.transform;W.attr("transform",t)}),B(_)}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"linkStrokeOpacity",value:function(t){return arguments.length?(this._linkStrokeOpacity=t,this):this._linkStrokeOpacity}},{key:"nodeStrokeOpacity",value:function(t){return arguments.length?(this._nodeStrokeOpacity=t,this):this._nodeStrokeOpacity}},{key:"nodeFillOpacity",value:function(t){return arguments.length?(this._nodeFillOpacity=t,this):this._nodeFillOpacity}},{key:"visibleDepth",value:function(t){return arguments.length?(this._visibleDepth=t,this):this._visibleDepth}},{key:"textPadding",value:function(t){return arguments.length?(this._textPadding=t,this):this._textPadding}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"hasValue",value:function(t){return arguments.length?(this._hasValue=t,this):this._hasValue}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}}]),n}(),Me=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.root;if(e&&e.children){var n=e.children;S(n,this.generateColorList(n.length))}return{root:t.root||{children:[]},valueLabel:t.valueLabel}}}]),n}(),ze=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","tree-chart"),e.tree=new Le(e.mainGroup),e._maxRadius=4,e._hasValue=!1,e._nodeFillOpacity=1,e._labelShow=!0,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){var n=this,i=n.tree,o=n.tooltip,a=n.activeData;if(!a.root||!a.root.children)return n;var t=n.widthOfNoMargin,e=n.heightOfMainGroup;i.data(a.root).width(t).height(e).maxRadius(n._maxRadius).hasValue(n._hasValue).nodeFillOpacity(n._nodeFillOpacity).transition(n._transition).duration(n._duration).fontSize(n._textLabel.fontSize).fontColor(n._textLabel.color).fontFamily(n._textLabel.fontFamily).labelShow(n._labelShow).onMouseover(function(e){d3.select(this).select("circle").style("fill-opacity",1).style("stroke-opacity",1),i.elem.select(".links-group").selectAll("path").filter(function(t){return t.target===e}).style("stroke-opacity",.7);var t=[{color:e.data.color,text:e.data.name}];n._hasValue&&t.push({text:a.valueLabel+""+(-1==String(e.value).indexOf(".")?e.value:e.value.toFixed(2))}),o.data(t).update().show()}).onMousemove(function(){o.move()}).onMouseout(function(e){o.hide(),d3.select(this).select("circle").style("fill-opacity",i.nodeFillOpacity()).style("stroke-opacity",i.nodeStrokeOpacity()),i.elem.select(".links-group").selectAll("path").filter(function(t){return t.target===e}).style("stroke-opacity",i.linkStrokeOpacity())}),i.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.root.children||[];t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){var t,e=this._data.root;e&&e.children&&e.children.length&&((t=e).color=t.children[0].color,function e(t){1<t.depth&&(t.color=t.parent.color),t.children&&t.children.forEach(function(t){e(t)})}(t)),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new Me(t,e);return n.dataSolveFunc(Se),n}},{key:"activeData",get:function(){var t=this.sortedDataCopy,e=t.root;return{root:{name:e.name,color:e.color,value:e.value||0,children:e.children&&e.children.filter(function(t){return!1!==t.active})},valueLabel:t.valueLabel}}}]),n}();var Re=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data,this._columnMap),e=t.root;if(e&&e.children){var n=e.children;S(n,this.generateColorList(n.length))}return{root:t.root||{children:[]},valueLabel:t.valueLabel}}}]),n}(),Te=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._hasValue=!0,e._maxRadius=20,e._nodeFillOpacity=.45,e._labelShow=!0,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ze),l(n,[{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new Re(t,e);return n.dataSolveFunc(we),n}}]),n}(),Pe=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.keys,n=this.generateColorList(e.length),i={};return e.forEach(function(t,e){return i[t]=n[e]}),t.colorMap=i,t}}]),n}();function We(t,e){var i=0;if(e.forEach(function(t){"objCol"===t.function&&(i=+t.index)}),P(t,[i],2))return{keys:[],dataForStack:[]};var n=W(t,e),o=n[0];return{keys:o.filter(function(t,e){return e!==i}),dataForStack:n.slice(1).map(function(t){var n={};return t.forEach(function(t,e){e===i?n.name=t:n[o[e]]=t}),n})}}var De=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","area-plot"),e._xScale=null,e._yScale=null,e._areaFunc=null,e._curve=d3.curveLinear,e._fillOpacity=.7,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._areaFunc||d3.area().x(function(t){return e._xScale(t.name)}).y0(e._yScale.range()[0]).y1(function(t){return e._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});n.curve(e._curve);var i=e.group.selectAll("path").data(t,function(t){return t.key});return i.exit().remove(),i.enter().append("path").merge(i).style("fill",function(t){return t.color}).style("fill-opacity",e._fillOpacity).transition().duration(e._transition?e._duration:0).attr("d",function(t){return n(t.data)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}}]),n}(),je=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stream-graph"),e}return u(n,De),l(n,[{key:"update",value:function(){for(var n=this,i=n._data,t=[],o=[],e=0;e<i.keys.length;e++){for(var a=[],r=0;r<i.dataForStack.length;r++)a.push(i.dataForStack[r][i.keys[e]]);t.push(d3.max(a))}for(var l=0;l<i.keys.length;l++)for(var s=0;s<i.stackData[l].length;s++)i.stackData[l][s].data[i.keys[l]]==t[l]&&o.push([i.stackData[l][s][0],i.stackData[l][s][1],i.stackData[l][s].data.name]);var u=n.group,c=i.stackData,h=n._areaFunc||d3.area().x(function(t){return n._xScale(t.data.name)}).y0(function(t){return n._yScale(t[0])}).y1(function(t){return n._yScale(t[1])});u.select(".stream-graph-group").remove();var d=u.append("g").attr("class","stream-graph-group"),_=d.selectAll("path").data(c,function(t){return t.key});_.exit().remove(),_.enter().append("path").merge(_).style("fill",function(t){return i.colorMap[t.key]}).on("mouseover",n._onMouseover).on("mousemove",n._onMousemove).on("mouseout",n._onMouseout).transition().duration(n._transition?n._duration:0).attr("d",h);var f=d.selectAll("text").data(i.keys);f.exit().remove(),f.enter().append("text").attr("class","stream-graph-texts").merge(_).text(function(t,e){return i.keys[e]}).attr("x",function(t,e){return n._xScale(o[e][2])}).attr("y",function(t,e){return(n._yScale(o[e][1])-n._yScale(o[e][0]))/2+n._yScale(o[e][0])}).attr("text-anchor","middle").attr("fill",n._fontColor).attr("font-size",n._fontSize).style("font-family",n._fontFamily),0==n._labelShow?u.selectAll(".stream-graph-texts").style("display","none"):u.selectAll(".stream-graph-texts").style("display","block");for(var p=u.selectAll(".stream-graph-texts"),y=[],g=[],v=0;v<p._groups[0].length;v++){g.push(v);for(var x=v+1;x<p._groups[0].length;x++){rt(at(d3.select(p._groups[0][v])),at(d3.select(p._groups[0][x])))&&(y.push(v),d3.select(p._groups[0][v]).style("opacity","0"))}}for(var m=new Set(y),k=Array.from(m),b=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(k,g),S=0;S<k.length;S++){for(var w=[],O=0;O<b.length;O++){var C=at(d3.select(p._groups[0][k[S]])),A=at(d3.select(p._groups[0][b[O]]));if(w.push(rt(C,A)),rt(C,A)){if(k[S]==b[O])continue;d3.select(p._groups[0][k[S]]).style("opacity","0")}}0==w.filter(function(t){return 1==t}).length&&b.push(k[S])}for(var F=0;F<b.length;F++)d3.select(p._groups[0][b[F]]).style("opacity","1");return n}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}}]),n}(),Ne=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.grid=new Ct(e.coreGroup),e.streamgraph=new je(e.coreGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.clipArea=new bt(e.defs),e.xAxis=new ft(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._labelShow=!1,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var e=this,r=e.activeData,t=e.streamgraph,n=e.grid,l=e.tooltip,i=e.overlay,s=e.guideLine,o=e.clipArea,u=e.xScale,a=e.yScale,c=(e.widthOfNoMargin,e.heightOfMainGroup,e._fontSize),h=(d3.max(r.keys,function(t){return V(t,c,e._fontFamily)}),e.widthOfCore),d=e.heightOfCore,_=r.stackData,f=r.colorMap,p=d3.max(_,function(t){return d3.max(t,function(t){return Math.max(t[0],t[1])})}),y=d3.min(_,function(t){return d3.min(t,function(t){return Math.min(t[0],t[1])})});a.domain([y,p]).range([0,d]);var g=d3.area().x(function(t){return u(t.data.name)}).y0(function(t){return a(t[0])}).y1(function(t){return a(t[1])}).curve(d3.curveBasis);t.data(r).areaFunc(g).xScale(u).yScale(a).fontSize(e._textLabel.fontSize).fontColor(e._textLabel.color).fontFamily(e._textLabel.fontFamily).labelShow(e._labelShow).onMouseover(function(e){var t=e.key,n=[{text:t,color:f[t]}];l.data(n).update().show(),d3.select(this).style("stroke","#000"),d3.select(this.parentNode).selectAll("path").filter(function(t){return t!=e}).style("fill-opacity",.3)}).onMousemove(function(t){l.move()}).onMouseout(function(){d3.select(this).style("stroke","none"),d3.select(this.parentNode).selectAll("path").style("fill-opacity",1),l.hide()}),n.width(h).height(d).xTickLocations(e.xAxis.tickLocations).showX(!1).showY(e._gridShowY).stroke(e._gridStroke).strokeDasharray(e._gridStrokeDasharray),s.y1(0).y2(d).strokeDasharray(e._gridStrokeDasharray),i.data(u.domain()).bandWidth(u.step()).bandHeight(d).onMouseover(function(t,e){var n=t,i=[{text:n}],o=r.dataForStack[e];for(var a in o)"name"!==a&&!1!==r.states[a]&&i.push({color:r.colorMap[a],text:a+""+o[a]});l.data(i).update(),s.x(u(n)).update(),l.show(),s.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),s.hide()}),o.width(h).height(d).transition(e._transition).duration(e._duration),e.coreGroup.attr("clip-path","url(#"+o.id+")"),n.update(),i.update(),o.update(),t.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy,e=i.colorMap,o=[];for(var n in e)o.push({name:n,color:e[n]});t.legend.data(o).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),o.forEach(function(t){t.name===e.name&&(t.active=!n)}),i.states[e.name]=!n,t.onDataChange()})}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.xScale,i=t.widthOfNoMargin,o=t.heightOfMainGroup;n.domain(t._xDomain).range([0,i]),e.scaleFunc(n).allowedMaxTextHeight(.3*o).type(t._xType).orient(t._xOrient).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),e.compute(),e.translate(0,o-e.height).update()}},{key:"computeDomain",value:function(){this.xDomain(this.activeData.dataForStack.map(function(t){return t.name}))}},{key:"sortData",value:function(){var t=this._data,e={};t.keys.forEach(function(t){return e[t]=!0}),t.states||(t.states=e),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new Pe(t,e);return n.dataSolveFunc(We),n}},{key:"activeData",get:function(){var e=this.sortedDataCopy,t=e.keys.filter(function(t){return!1!==e.states[t]}),n=d3.stack().keys(t).order(d3.stackOrderNone).offset(d3.stackOffsetWiggle)(e.dataForStack);return{states:e.states,keys:t,stackData:n,colorMap:e.colorMap,dataForStack:e.dataForStack}}}]),n}(),Ge=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radar"),e._radius=200,e._donutCount=5,e._fillOpacity=.35,e._borderWidth=2,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._endPointRadius=3.5,e._tickTextColor="#333",e._tickTextSize=10,e}return u(n,A),l(n,[{key:"update",value:function(){var o=this,t=o._data,e=o.group;if(t.length){var a=o._radius,n=o._donutCount,i=(o._fontSize,t[0].data.map(function(t){return t.name})),r=i.length,l=d3.max(t,function(t){return 1.05*d3.max(t.data,function(t){return parseFloat(t.value)})});if(l<=1)l=1;else{var s=.5*Math.pow(10,Math.floor(Math.log10(l)));l=Math.ceil(l/s)*s}for(var u=d3.range(n+1).map(function(t){return l/n*t}),c=[],h=0;h<r;h++){for(var d=[],_=0;_<t.length;_++)d.push(t[_].data[h].value);c.push(d3.max(d))}var f=d3.scaleLinear().domain([0,l]).range([0,a]),p=d3.scaleLinear().domain([0,r]).range([0,2*Math.PI]),y=d3.areaRadial().angle(function(t,e){return p(e)}).outerRadius(function(t){return f(t.value)}).curve(d3.curveCardinalClosed),g=e.selectAll(".tick-text").data(u);g.exit().remove(),g.enter().append("text").attr("class","tick-text").merge(g).attr("y",function(t,e){return-a/n*e}).attr("dy","0.35em").style("font-size",o._tickTextSize).style("text-anchor","middle").style("fill",o._tickTextColor).text(function(t){return-1==String(t).indexOf(".")?t:t.toFixed(1)}).style("text-anchor","middle");var v=e.selectAll(".radar-group").data(t,function(t){return t.key});v.exit().remove();var x=v.enter().append("g").attr("class","radar-group");x.append("path").attr("class","radar-area"),x.append("g").attr("class","radar-points"),x.append("g").attr("class","radar-area-texts");var m=x.merge(v).on("mouseover",o._onMouseover).on("mousemove",o._onMousemove).on("mouseout",o._onMouseout);m.select(".radar-area").attr("d",function(t){return y(t.data)}).style("fill",function(t){return t.color}).style("fill-opacity",o._fillOpacity).style("stroke",function(t){return t.color}).style("stroke-width",o._borderWidth);var k=m.select(".radar-points").selectAll("circle").data(function(e){return e.data.map(function(t){return t.color=e.color,t})});k.exit().remove(),k.enter().append("circle").merge(k).attr("r",o._endPointRadius).attr("cx",function(t,e){return f(t.value)*Math.cos(p(e)-Math.PI/2)}).attr("cy",function(t,e){return f(t.value)*Math.sin(p(e)-Math.PI/2)}).style("fill",function(t){return t.color}),e.selectAll(".radar-area-texts").remove();var b=e.append("g").selectAll("g").attr("class","radar-area-groups").data(t);b.exit().remove(),b.enter().append("g").merge(b).each(function(t,e){var n=d3.select(this).selectAll("text").data(function(t){return t.data.map(function(t){return t})});n.exit().remove(),n.enter().append("text").attr("class","radar-area-texts").merge(n).text(function(t){return t.value}).attr("x",function(t,e){return t.value==c[e]?(f(t.value)+.05*a)*Math.cos(p(e)-Math.PI/2):(f(t.value)-.05*a)*Math.cos(p(e)-Math.PI/2)}).attr("y",function(t,e){return t.value==c[e]?(f(t.value)+.05*a)*Math.sin(p(e)-Math.PI/2):(f(t.value)-.05*a)*Math.sin(p(e)-Math.PI/2)}).attr("text-anchor",function(t,e){return 0==p(e)||p(e)==Math.PI?"middle":p(e)>Math.PI&&t.value!=c[e]?"start":p(e)>Math.PI&&t.value==c[e]||0<p(e)&&p(e)<Math.PI&&t.value!=c[e]?"end":void 0}).attr("dy",function(t,e){if(t.value==c[e])if(t.value==d3.max(c)){if(p(e)<Math.PI/2||p(e)>1.5*Math.PI)return"1.3em";if(p(e)>Math.PI/2&&p(e)<1.5*Math.PI)return"-1.3em";if(p(e)==Math.PI/2||p(e)==1.5*Math.PI)return"1.1em"}else{if(0==p(e))return"0.3em";if(p(e)==Math.PI)return"-0.3em";if(p(e)<Math.PI/2||p(e)>1.5*Math.PI)return"1.3em";if(p(e)>Math.PI/2&&p(e)<1.5*Math.PI)return"-1.3em";if(p(e)==Math.PI/2||p(e)==1.5*Math.PI)return"1.1em"}else if(t.value!=c[e])return 0==p(e)||p(e)>Math.PI&&p(e)<1.5*Math.PI?0:"0.4em"}).style("font-size",o._fontSize).style("font-family",o._fontFamily).style("fill",o._fontColor).style("display",o._labelShow?"block":"none")});var S=e.selectAll(".radar-text").data(i);S.exit().remove(),S.enter().append("text").attr("class","radar-text").merge(S).attr("dy",function(t,e){return p(e)==Math.PI?10:"0.1em"}).each(function(t,e){var n=p(e),i=a+parseFloat(o._themeFontSize)/2+8;d3.select(this).attr("x",function(){return i*Math.cos(n-Math.PI/2)}).attr("y",function(){return i*Math.sin(n-Math.PI/2)}).style("text-anchor",function(){return n%Math.PI?n<Math.PI?"start":"end":"middle"})}).style("font-size",o._themeFontSize).style("font-family",o._themeFontFamily).style("fill",o._themeFontColor).text(function(t,e){return t=="&-"+(e+1)?"":t});for(var w=e.selectAll(".radar-area-texts"),O=[],C=[],A=0;A<w._groups[0].length;A++){C.push(A);for(var F=A+1;F<w._groups[0].length;F++){rt(at(d3.select(w._groups[0][A])),at(d3.select(w._groups[0][F])))&&(O.push(A),d3.select(w._groups[0][A]).style("opacity","0"))}}for(var L=new Set(O),M=Array.from(L),z=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(M,C),R=0;R<M.length;R++){for(var T=[],P=0;P<z.length;P++){var W=at(d3.select(w._groups[0][M[R]])),D=at(d3.select(w._groups[0][z[P]]));if(T.push(rt(W,D)),rt(W,D)){if(M[R]==z[P])continue;d3.select(w._groups[0][M[R]]).style("opacity","0")}}0==T.filter(function(t){return 1==t}).length&&z.push(M[R])}for(var j=0;j<z.length;j++)d3.select(w._groups[0][z[j]]).style("opacity","1");return o}e.selectAll("*").remove()}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"tickTextColor",value:function(t){return arguments.length?(this._tickTextColor=t,this):this._tickTextColor}},{key:"tickTextSize",value:function(t){return arguments.length?(this._tickTextSize=t,this):this._tickTextSize}}]),n}(),Be=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radar-chart"),e.grid=new Q(e.mainGroup),e.radar=new Ge(e.mainGroup),e._sortValue=null,e._donutCount=5,e._fillOpacity=0,e._endPointRadius=3.5,e._borderWidth=2,e._labelShow=!1,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,q),l(n,[{key:"updateCore",value:function(){var t=this,e=t.activeData,n=t.radar,i=t.grid,o=t.tooltip,a=(t._fontSize,t.widthOfNoMargin),r=t.heightOfMainGroup,l=Math.min(.82*a,.82*r)/2;n.data(e).radius(l).borderWidth(t._borderWidth).endPointRadius(t._endPointRadius).labelShow(t._labelShow).donutCount(t._donutCount).fillOpacity(.6).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).tickTextColor(t._fontColor).translate(a/2,r/2).onMouseover(function(t,e){d3.select(this.parentNode).selectAll(".radar-area").transition().style("fill-opacity",.5),d3.select(this).select(".radar-area").transition().style("fill-opacity",.75);var n=[{color:t.color,text:t.name=="$-"+(e+1)?"":t.name}];t.data.forEach(function(t,e){n.push({text:(t.name=="&-"+(e+1)?"":t.name)+""+t.value})}),o.data(n).update().show()}).onMousemove(function(){o.move()}).onMouseout(function(){d3.select(this.parentNode).transition().selectAll(".radar-area").style("fill-opacity",.6),o.hide()}),i.radius(l).donutCount(t._donutCount).sectorCount(e[0]?e[0].data.length:1).translate(a/2,r/2).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY),n.update(),i.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._textLabel=n.textLabel?n.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&this.fillOpacity(e.fillOpacity).endPointRadius(e.endPointRadius).borderWidth(e.borderWidth)}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}}]),n}(),Ee=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=function(t){var e=[],n={};t.forEach(function(t){t.children.forEach(function(t){var e=t.name;n[e]?n[e]++:n[e]=0})});var i=0;for(var o in n)e.push({name:o,count:n[o],index:i}),i++;return e.sort(function(t,e){return e.count-t.count||t.index-e.index}),e.slice(0,2).map(function(t){return t.name})}(t.nodes),n=this.generateColorList(e.length),i={};return e.forEach(function(t,e){return i[t]=n[e]}),t.colorMap=i,t.keys=e,t}}]),n}();var He=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pyramid"),e._xScale=null,e._yScale=null,e._stroke="#fff",e}return u(n,A),l(n,[{key:"update",value:function(){for(var i=this,o=i.group,t=i._data,a=[],r=[],e=0;e<t.nodes.length;e++)null==i._labelShow||null==i._positionOptions||null==i._positionChoice||-1==i._positionOptions.indexOf(i._positionChoice)?(r.push(0),a.push(0)):1==i._labelShow&&0==i._positionOptions.indexOf(i._positionChoice)?(a.push(V(t.nodes[e].children[0].value,i._fontSize,i._fontFamily)),r.push(V(t.nodes[e].children[1].value,i._fontSize,i._fontFamily))):(r.push(0),a.push(0));var n,l=t.nodes,s=t.colorMap,u=t.keys,c=i._xScale,h=i._yScale,d=Math.abs(c.range()[1]-c.range()[0]),_=d/2,f=h.bandwidth(),p=u[0],y=s[p],g=u[1],v=s[g],x=[],m=[];l.forEach(function(t){var e=t.children.filter(function(t){return t.name===p})[0],n=t.children.filter(function(t){return t.name===g})[0];x.push({name:t.name,key:t.key,color:y,value:e&&Math.abs(e.value)||0}),m.push({name:t.name,key:t.key,color:v,value:n&&Math.abs(n.value)||0})}),function(){var t=o.select(".left-group").empty()?o.append("g").attr("class","left-group"):o.select(".left-group");t.selectAll("text").remove();var e=t.selectAll("rect").data(x,function(t){return t.key});e.exit().remove();e.enter().append("rect").merge(e).attr("x",function(t){return c(-t.value)-(0==r.length?0:d3.max(r))}).attr("y",function(t){return h(t.name)}).attr("width",function(t){return _-c(-t.value)+(0==r.length?0:d3.max(r))}).attr("height",f).style("fill",y).style("stroke",i._stroke);var n=t.selectAll("text").data(x,function(t){return t.key});n.exit().remove(),n.enter().append("text").attr("class","pyramid-left-texts").merge(n).text(function(t){return 0==t.value?"":t.value}).attr("x",function(t){return c(-t.value)-(0==r.length?0:d3.max(r))}).attr("y",function(t){return h(t.name)}).attr("dy",f/2+i._fontSize/3).attr("dx",function(t,e){return null==i._positionOptions||null==i._positionChoice?0:0==i._positionOptions.indexOf(i._positionChoice)?(d3.selectAll(".pyramid-left-texts").attr("text-anchor","end"),.3*-i._fontSize):1==i._positionOptions.indexOf(i._positionChoice)?(d3.selectAll(".pyramid-left-texts").attr("text-anchor","end"),_-c(-t.value)-.3*i._fontSize):void 0}).attr("fill",i._fontColor).attr("font-size",i._fontSize).style("font-family",i._fontFamily).style("display",i._labelShow?"block":"none")}(),function(){var t=o.select(".right-group").empty()?o.append("g").attr("class","right-group"):o.select(".right-group");t.selectAll("text").remove();var e=t.selectAll("rect").data(m,function(t){return t.key});e.exit().remove();e.enter().append("rect").merge(e).attr("x",_).attr("y",function(t){return h(t.name)}).attr("width",function(t){return c(t.value)-_-(0==a.length?0:d3.max(a))}).attr("height",f).style("fill",v).style("stroke",i._stroke);var n=t.selectAll("text").data(m,function(t){return t.key});n.exit().remove(),n.enter().append("text").attr("class","pyramid-right-texts").merge(n).text(function(t){return 0==t.value?"":t.value}).attr("x",_-(0==a.length?0:d3.max(a))).attr("y",function(t){return h(t.name)}).attr("dy",f/2+i._fontSize/3).attr("dx",function(t,e){return null==i._positionOptions||null==i._positionChoice?0:0==i._positionOptions.indexOf(i._positionChoice)?c(t.value)-_+.3*i._fontSize:1==i._positionOptions.indexOf(i._positionChoice)?.3*i._fontSize:void 0}).attr("fill",i._fontColor).attr("font-size",i._fontSize).style("font-family",i._fontFamily).style("display",i._labelShow?"block":"none")}(),(n=(o.select(".overlay-group").empty()?o.append("g").attr("class","overlay-group"):o.select(".overlay-group")).selectAll("rect").data(l,function(t){return t.key})).exit().remove(),n.enter().append("rect").merge(n).attr("x",0).attr("y",function(t){return h(t.name)}).attr("width",d).attr("height",f).style("fill","#fff").style("stroke","none").style("fill-opacity",0).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout);for(var k=o.selectAll(".pyramid text"),b=[],S=[],w=0;w<k._groups[0].length;w++){S.push(w);for(var O=w+1;O<k._groups[0].length;O++){rt(at(d3.select(k._groups[0][w])),at(d3.select(k._groups[0][O])))&&(b.push(w),d3.select(k._groups[0][w]).style("opacity","0"))}}for(var C=new Set(b),A=Array.from(C),F=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(A,S),L=0;L<A.length;L++){for(var M=[],z=0;z<F.length;z++){var R=at(d3.select(k._groups[0][A[L]])),T=at(d3.select(k._groups[0][F[z]]));if(M.push(rt(R,T)),rt(R,T)){if(A[L]==F[z])continue;d3.select(k._groups[0][A[L]]).style("opacity","0")}}0==M.filter(function(t){return 1==t}).length&&F.push(A[L])}for(var P=0;P<F.length;P++)d3.select(k._groups[0][F[P]]).style("opacity","1");return i}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}}]),n}(),Ve=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","pyramid-chart"),e.grid=new Ct(e.coreGroup),e.core=new He(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._marginLeft=15,e._marginRight=20,e._xType="number",e._yType="category",e._yTitle="y",e._xTitle="x",e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var e=this,t=e.core,n=e.tooltip,i=e.grid,o=e.activeData,a=o.colorMap,r=e.widthOfCore,l=e.heightOfCore,s=[],u=[],c=0;c<e.activeData.nodes.length;c++)null==e._labelShow||null==e._positionOptions||null==e._positionChoice||-1==e._positionOptions.indexOf(e._positionChoice)?(u.push(0),s.push(0)):1==e._labelShow&&0==e._positionOptions.indexOf(e._positionChoice)?(s.push(V(e.activeData.nodes[c].children[0].value,e._textLabel.fontSize,e._textLabel.fontFamily)),u.push(V(e.activeData.nodes[c].children[1].value,e._textLabel.fontSize,e._textLabel.fontFamily))):(u.push(0),s.push(0));t.data(o).xScale(e.xScale).yScale(e.yScale).fontSize(e._textLabel.fontSize).fontColor(e._textLabel.color).fontFamily(e._textLabel.fontFamily).labelShow(e._labelShow).positionOptions(e._positionOptions).positionChoice(e._positionChoice).onMouseover(function(t){d3.select(this).style("fill-opacity",.8);var e=[{text:t.name}];t.children.forEach(function(t){t.name in a&&e.push({color:a[t.name],text:t.name+""+t.value})}),n.data(e).update().show()}).onMousemove(function(){n.move()}).onMouseout(function(){d3.select(this).style("fill-opacity",0),n.hide()}),i.width(r-(0==u.length?0:d3.max(u))-(0==s.length?0:d3.max(s))).height(l).xTickLocations(e.xAxis.tickLocations.slice().map(function(t){return t-(0==u.length?0:d3.max(u))})).yTickLocations(e.yAxis.tickLocations.slice().map(function(t){return t+e.yScale.bandwidth()/2})).showX(e._gridShowX).showY(e._gridShowY).stroke(e._gridStroke).strokeDasharray(e._gridStrokeDasharray),e.coreGroup.call(H,e.yAxis.width+.5+(0==u.length?0:d3.max(u)),0),i.update(),t.update()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,a=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),o.domain(t._yDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration);n.titleHeight;var d=(h-e.allowedMaxTextHeight())/u;e.tickCount(d);for(var _=[],f=[],p=0;p<t.activeData.nodes.length;p++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(f.push(0),_.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?(_.push(V(t.activeData.nodes[p].children[0].value,t._textLabel.fontSize,t._textLabel.fontFamily)),f.push(V(t.activeData.nodes[p].children[1].value,t._textLabel.fontSize,t._textLabel.fontFamily))):(f.push(0),_.push(0));n.compute(),i.nice().range([0==f.length?0:d3.max(f),c-n.width-(0==_.length?0:d3.max(_))]),e.compute(),o.range([h-e.height,0]);var y=n.width,g=h-e.height,v=n.width;e.translate(y,g).update(),n.translate(v,0).update()}},{key:"configLegend",value:function(){var t=this._sortedDataCopy,e=[];for(var n in t.colorMap)e.push({name:n,color:t.colorMap[n]});this.legend.data(e)}},{key:"computeDomain",value:function(){var t=this._data.nodes,e=0<t.length?d3.max(t,function(t){return d3.max(t.children,function(t){return Math.abs(t.value)})}).toFixed(0):1;this._xDomain=[-e,e],this._yDomain=t.length?t.map(function(t){return t.name}):[0,1],this.xAxis.tickFormat(function(t){return Math.abs(t)})}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new Ee(t,e);return n.dataSolveFunc(fe),n}},{key:"activeData",get:function(){return this._sortedDataCopy}}]),n}();function Ie(t,e){t.on("mouseover",e._onMouseover).on("mousemove",e._onMousemove).on("mouseout",e._onMouseout)}var Ye=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bar-plot"),e._xScale=null,e._yScale=null,e._fill=null,e._stroke="#fff",e._strokeWidth=1,e._showZeroLine=!0,e._zeroLineStroke="#000",e._fontColor="#000",e._fontSize=13,e._cornerRadius=0,e}return u(n,A),l(n,[{key:"update",value:function(){for(var e=this,t=e._data,n=e._xScale,i=e._yScale.clamp(!0),o=n.bandwidth(),a=i.domain(),r=a.every(function(t){return 0<=t})?"up":a.every(function(t){return t<=0})?"down":"both",l=i.range()[0],s=e._transition?e._duration:0,u=[],c=0;c<t.length;c++)u.push(t[c].value);var h=et(u,e._fontSize,e._fontFamily),d=e.group,_=d.selectAll(".rect").data(t);_.exit().transition().duration(s).remove();var f=_.enter().append("path").attr("class","rect").merge(_).style("fill",function(t){return e._fill||t.color}).style("stroke-width",e._strokeWidth).style("stroke",e._stroke).call(Ie,e),p=d.selectAll("text").data(t);p.exit().transition().duration(s).remove();var y=p.enter().append("text").attr("class","simple-bar-texts").merge(p).text(function(t){return t.value}).attr("fill",e._fontColor).attr("font-size",e._fontSize).style("display",e._labelShow?"block":"none");if("up"===r)f.attr("d",function(t){return tt({x:n(t.name),y:i(t.value),width:o,height:Math.abs(l-i(t.value)),cornerRadius:e._cornerRadius})}),y.attr("x",function(t){return n(t.name)}).attr("y",function(t){return i(t.value)}).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?Math.abs(l-i(t.value))-6:void 0}).attr("text-anchor","middle"),null==e._positionOptions||null==e._positionChoice?y.style("display","none"):o<h&&1==e._positionOptions.indexOf(e._positionChoice)?y.attr("transform",function(t){return"rotate(-90 "+(n(t.name)+o/2||0)+" "+(i(t.value)+Math.abs(l-i(t.value))-.7*e._fontSize)+" )"}).attr("text-anchor","start"):y.attr("transform","rotate(0)");else if("down"===r)f.attr("d",function(t){return tt({x:n(t.name),y:0,width:o,height:i(t.value),cornerRadius:e._cornerRadius})}),y.attr("x",function(t){return n(t.name)}).attr("y",0).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?i(t.value)-6:void 0}).attr("text-anchor","middle"),null==e._positionOptions||null==e._positionChoice?y.style("display","none"):o<h&&1==e._positionOptions.indexOf(e._positionChoice)?y.attr("transform",function(t){return"rotate(-90 "+(n(t.name)+o/2||0)+" "+(i(t.value)-.7*e._fontSize)+" )"}).attr("text-anchor","start"):y.attr("transform","rotate(0)");else{var g=Math.round(i(0));f.attr("d",function(t){return tt({x:n(t.name),y:0<=t.value?i(t.value):g,width:o,height:Math.abs(g-i(t.value)),cornerRadius:e._cornerRadius})}),y.attr("x",function(t){return n(t.name)}).attr("y",function(t){return 0<=t.value?i(t.value):g}).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?Math.abs(g-i(t.value))-6:void 0}).attr("text-anchor","middle"),null==e._positionOptions||null==e._positionChoice?y.style("display","none"):o<h&&1==e._positionOptions.indexOf(e._positionChoice)?y.attr("transform",function(t){return"rotate(-90 "+(n(t.name)+o/2||0)+" "+((0<=t.value?i(t.value):g)+Math.abs(g-i(t.value))-.7*e._fontSize)+" )"}).attr("text-anchor","start"):y.attr("transform","rotate(0)"),(d.select(".zero-line").empty()?d.append("line").attr("class","zero-line"):d.select(".zero-line")).attr("x1",n.range()[0]).attr("y1",g).attr("x2",n.range()[1]).attr("y2",g).style("stroke",e._showZeroLine?e._zeroLineStroke:"none")}if(null==e._positionOptions||null==e._positionChoice)y.style("display","none");else if(0==e._positionOptions.indexOf(e._positionChoice)){for(var v=d.selectAll(".simple-bar-texts"),x=[],m=[],k=0;k<v._groups[0].length;k++){m.push(k);for(var b=k+1;b<v._groups[0].length;b++){rt(at(d3.select(v._groups[0][k])),at(d3.select(v._groups[0][b])))&&(x.push(k),d3.select(v._groups[0][k]).style("opacity","0"))}}for(var S=new Set(x),w=Array.from(S),O=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(w,m),C=0;C<w.length;C++){for(var A=[],F=0;F<O.length;F++){var L=at(d3.select(v._groups[0][w[C]])),M=at(d3.select(v._groups[0][O[F]]));if(A.push(rt(L,M)),rt(L,M)){if(w[C]==O[F])continue;d3.select(v._groups[0][w[C]]).style("opacity","0")}}0==A.filter(function(t){return 1==t}).length&&O.push(w[C])}for(var z=0;z<O.length;z++)d3.select(v._groups[0][O[z]]).style("opacity","1")}return e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}}]),n}(),Xe=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("rect").attr("class","overlay-rect"),e._width=0,e._height=0,e._onMouseover=function(){},e._onMousemove=function(){},e._onMouseout=function(){},e}return u(n,a),l(n,[{key:"update",value:function(){return this.elem.attr("x",0).attr("y",0).attr("width",this._width<0?0:this._width).attr("height",this._height).style("fill","#000").style("opacity",0).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),this}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Ze=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","multiple-bar"),e.overlay=new Xe(e.group),e._width=400,e._height=400,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._zeroLineStroke="#000",e._gapPadding=5,e._allowedMaxTextWidth=100,e._xScale=d3.scaleBand(),e._yScale=d3.scaleLinear(),e._mainLeft=0,e._mainWidth=0,e}return u(n,A),l(n,[{key:"update",value:function(){var t,a=this,e=a._data,n=a._width,i=a._height,r=a._fontSize,l=a._fontFamily,s=a._gapPadding,u=i/e.length,o=d3.max(e,function(t){return d3.max(t.data,function(t){return Math.abs(t.value)})}),c=d3.max(e,function(t){return V(t.name,r,l)}),h=c>a._allowedMaxTextWidth,d=0<e.length?Math.min(c,a._allowedMaxTextWidth):0+a._gapPadding,_=1.25*r+a._gapPadding,f=n-d-_,p=a._xScale.domain(0<e.length?e[0].data.map(function(t){return t.name}):[]).range([0,f]),y=a._yScale.domain([-o,o]).range([u,0]);return(t=a.group.selectAll(".bar-plot-group").data(e,function(t){return t.key})).exit().remove(),t.enter().append("g").attr("class","bar-plot-group").merge(t).style("font-size",r+"px").style("font-family",l).each(function(t){var e=d3.select(this),n=e.property("bar-plot")||new Ye(e);e.property("bar-plot",n);var i=e.select(".left-text").empty()?e.append("text").attr("class","left-text"):e.select(".left-text"),o=e.select(".right-text").empty()?e.append("text").attr("class","right-text"):e.select(".right-text");i.attr("x",-s).attr("y",u/2).attr("dy","0.35em").style("text-anchor","end").style("fill",a._fontColor).text(function(t){return h?I(t.name,d,r,l):t.name}).attr("font-size",a._fontSize).attr("font-family",a._fontFamily),o.attr("x",f+s).attr("y",u/2).attr("dy","0.35em").style("text-anchor","start").style("fill",a._fontColor).text("0").attr("font-size",a._fontSize).attr("font-family",a._fontFamily),n.data(t.data).xScale(p).yScale(y).fill(t.color).showZeroLine(a._showZeroLine).zeroLineStroke(a._zeroLineStroke).transition(a._transition).duration(a._duration),n.update()}).attr("transform",function(t,e){return"translate("+d+", "+u*e+")"}),a.overlay.elem.raise(),a.overlay.width(f).height(i).translate(d,0).onMouseover(a._onMouseover).onMousemove(a._onMousemove).onMouseout(a._onMouseout).update(),a._mainLeft=d,a._mainWidth=f,a}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"xScale",get:function(){return this._xScale}},{key:"yScale",get:function(){return this._yScale}},{key:"mainLeft",get:function(){return this._mainLeft}},{key:"mainWidth",get:function(){return this._mainWidth}}]),n}(),Qe=function(t){function o(t){r(this,o);var e=c(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.xAxis=null,e.yAxis=null,e.yAxisDoubleY=null,e.xScale=null,e.yScale=null,e._marginLeft=24,e._marginRight=24,e._marginTop=20,e._gapPadding=20,e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._xDomain=null,e._yDomain=null,e._clipShow=null,e._xTitle="",e._yTitle="",e._axisLineStroke=null,e._xTickShow=!0,e._yTickShow=!0,e}return u(o,q),l(o,[{key:"update",value:function(){return this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this.updateTitle(),this.updateAxis(),this.updateCore(),this.updateScale(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,a=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),o.domain(t._yDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var d=n.titleHeight,_=(h-e.allowedMaxTextHeight())/(3*u);n.tickCount(_),n.compute(),i.range([0,c-n.width]),e.compute(),o.range([h-d-e.height,0]);var f=n.width,p=h-e.height,y=n.width,g=d;e.translate(f,p).update(),n.translate(y,g).update()}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"updateScale",value:function(){}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yDomain||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=void 0;if(t.length){var o=d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),a=1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})});i=o<0?a<=0?[o,0]:[o,a]:[0,a]}else i=[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?isNaN(parseFloat(e[0]))?i[1]:i[1]<e[0]?1.5*e[0]:i[1]:parseFloat(e[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"clipShow",value:function(t){return arguments.length?(this._clipShow=t,this):this._clipShow}},{key:"clipShowX",value:function(t){return arguments.length?(this._clipShowX=t,this):this._clipShowX}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"yLeftName",value:function(t){return arguments.length?(this._yLeftName=t,this):this._yLeftName}},{key:"yLeftTitle",value:function(t){return arguments.length?(this._yLeftTitle=t,this):this._yLeftTitle}},{key:"yRightName",value:function(t){return arguments.length?(this._yRightName=t,this):this._yRightName}},{key:"yRightTitle",value:function(t){return arguments.length?(this._yRightTitle=t,this):this._yRightTitle}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"setPublicOption",value:function(t){s(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.x||{},i=e.y||{};this.axisLineStroke(e.color).xTitle(n.name).yTitle(i.name).xTickShow(n.labelShow).yTickShow(i.labelShow).xDomain(n.range).yDomain(i.range).clipShow(i.range).clipShowX(n.range)}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return 0<e?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.yAxis?this.yAxis.titleHeight:0,n=this.heightOfMainGroup-t-e;return 0<n?n:0}}]),o}(),qe="axis-group",Ue="x-title",Je=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-x"),e._orient="bottom",e._type="category",e._allowedMaxTextHeight=30,e._tickTextRotate=0,e._tickTextHeight=0,e}return u(n,ht),l(n,[{key:"update",value:function(){var n=this,i=n._orient,t=n._scaleFunc,e=n.group,o=n._fontSize,a=n._tickTextRotate,r=n._tickValueTexts,l=void 0;(l=n.axisFunc="top"===i?d3.axisTop(t):d3.axisBottom(t)).tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding);var s=e.select("."+qe).empty()?e.append("g").attr("class",qe):e.select("."+qe);s.style("font-size",o+"px").style("font-family",n._fontFamily).transition().duration(n._transition?n._duration:0).call(l).on("start",function(t,e){s.selectAll(".tick text").style("fill",n._fontColor).attr("dx",0).attr("dy","0.71em").attr("transform","rotate(0)").style("text-anchor","middle").text(function(t,e){return r[e]}).filter(function(){return a}).attr("dx","-0.5em").style("text-anchor","end").attr("transform","rotate("+n._tickTextRotate+")").filter(function(){return"top"!==i}).attr("dy","0.5em"),s.selectAll(".tick line").style("stroke",n._lineStroke),s.select("path").style("stroke",n._lineStroke).style("display",n._axisLineShow?"block":"none")});var u=Math.abs(t.range()[0]-t.range()[1]);if(n._titleShow&&n._title){var c=e.select("."+Ue).empty()?e.append("g").attr("class",Ue):e.select("."+Ue),h=c.select("text").empty()?c.append("text"):c.select("text");c.call(H,u/2,n.height),h.attr("dy","0.5em").attr("text-anchor","middle").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dy","-0.5em").text(n._title)}else e.select("."+Ue).remove()}},{key:"compute",value:function(){var e=this,n=[],i=[],o=0,a=0;function r(){e._tickTextRotate=o,e._tickValues=n,e._tickValueTexts=i,e._tickTextHeight=a}var t=e._scaleFunc,l=e._type,s=e._fontSize,u=(e._minTickDistance,e._allowedMaxTextHeight),c=Math.abs(t.range()[0]-t.range()[1]),h=void 0,d=void 0;if(n="category"===l?t.domain():t.ticks(e._tickCount),"number"===l&&0!=t.domain()[0]&&n.push(t.domain()[0]),function(){var t=!1;h=c/n.length,(d=d3.max(n,function(t){return V(t,s,e._fontFamily)}))<h&&(o=0,i=n,a=1.125*s,r(),t=!0);return t}())return e;o="top"===e._orient?45:-45;var _=Math.abs(Math.sin(Math.PI/4));d*_<u?(a=d*_,i=n):(a=u,i=n.map(function(t){return I(t,a/_,s,e._fontFamily)}));Math.abs(Math.cos(Math.PI/4));var f=c/n.length;if("category"===l&&f<2*s){var p=Math.ceil(2*s/f);n=n.filter(function(t,e){return e%p==0})}return r(),e}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"height",get:function(){var t=0;return this.isShow&&(t=(this._tickShow?this._tickSize+this._tickPadding+1.2*this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.25*this._fontSize:0)),t}}]),n}(),Ke=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","multiple-bar-chart"),e.core=new Ze(e.coreGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.xAxis=new Je(e.mainGroup),e}return u(n,Qe),l(n,[{key:"updateCore",value:function(){var t=this,a=t.activeData,r=t.core,l=t.tooltip,e=t.overlay,s=t.guideLine,n=t.widthOfCore,i=t.heightOfCore,u=r.xScale;s.y1(0).y2(i),r.data(a).width(n).height(i).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).zeroLineStroke(t._axisLineStroke).showZeroLine(t._xTickShow).allowedMaxTextWidth(n/5).update(),e.data(u.domain()).bandWidth(u.step()).bandHeight(i).isScalePoint(!1).translate(r.mainLeft,0).onMouseover(function(t,e){var i=t,n=u.step(),o=[{text:i}];a.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});o.push({text:t.name+": "+n[0].value,color:t.color})}),l.data(o).update(),s.x(u(i)+r.mainLeft+n/2).update(),l.show(),s.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),s.hide()}),e.update()}},{key:"updateAxis",value:function(){var t=this.xAxis;t.scaleFunc(d3.scaleLinear().range([0,this.widthOfNoMargin])).title(this._xTitle).fontSize(this._fontSize).fontColor(this._fontColor).fontFamily(this._fontFamily).transition(!1).axisLineShow(!1).tickShow(!1),t.translate(0,this.heightOfMainGroup-t.height).update()}}]),n}(),$e=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bubble-plot"),e._radius=function(){},e._cx=function(){},e._cy=function(){},e._fill=null,e._stroke=null,e._strokeWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group,i=e._transition?e._duration:0,o=n.selectAll("circle").data(t,function(t){return t.key});return o.exit().transition().duration(i).attr("r",0).remove(),o.enter().append("circle").merge(o).attr("cx",e._cx).attr("cy",e._cy).style("fill",function(t){return e._fill||t.color}).style("fill-opacity",.4).style("stroke",function(t){return t.color}).style("stroke-width",e._strokeWidth).on("mouseover",e._onMouseover).on("mousemove",e._onMousemove).on("mouseout",e._onMouseout).transition().duration(i).attr("r",e._radius),e}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"cx",value:function(t){return arguments.length?(this._cx=t,this):this._cx}},{key:"cy",value:function(t){return arguments.length?(this._cy=t,this):this._cy}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),n}(),tn=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.categories,i=this.generateColorList(e.length),o={},a=[];return e.forEach(function(t,e){var n=i[e];o[t]=n,a.push({name:t,color:n})}),t.nodes.forEach(function(t){return t.color=o[t.category]}),t.legendData=a,t}}]),n}();function en(t,e){var s=0,u=1,c=2,h=3,d=4;if(e.forEach(function(t){"typeCol"===t.function?s=t.index:"objCol"===t.function?u=t.index:"X"===t.name?c=t.index:"Y"===t.name?h=t.index:""===t.name&&(d=t.index)}),P(t,[s,u,c,h,d])||!x(t,c)||!x(t,h)||!x(t,d))return{categories:[],nodes:[],labels:[]};var _=[],f=[],p={};t.slice(1).forEach(function(t,e){var n=t[s],i=t[u],o=t[c],a=t[h],r=t[d],l=n+"-"+i+"-"+e;p[n]||(p[n]=n,_.push(n)),f.push({category:n,name:i,x:o,y:a,radius:r,key:l})});var n=t[0],i={category:n[s],name:n[u],x:n[c],y:n[h],radius:n[d]};return{categories:_,nodes:f,labels:i}}var nn="axis-group",on="y-title",an=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-horizontal"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e._tickPadding=6,e}return u(n,ht),l(n,[{key:"update",value:function(){var e=this,t=this,n=t._orient,i=t._scaleFunc,o=t.group,a=t._fontSize,r=t._tickValueTexts,l=void 0;l=t.axisFunc="right"===n?d3.axisRight(i):d3.axisLeft(i);var s=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(s=d3.format("d")),l.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(s);var u=o.select("."+nn).empty()?o.append("g").attr("class",nn):o.select("."+nn);u.transition().duration(t._transition?t._duration:0).call(l).on("start",function(){u.selectAll(".tick text").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return r[e]}),u.selectAll(".tick line").style("stroke",t._lineStroke),u.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")});var c=t.group.selectAll(".axis-y-horizontal .tick text").nodes().filter(function(t,e){return"$-"==String(t.__data__).slice(0,2)||"&-"==String(t.__data__).slice(0,2)});d3.selectAll(c).remove();var h=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var d=o.select("."+on).empty()?o.append("g").attr("class",on):o.select("."+on),_=d.select("text").empty()?d.append("text"):d.select("text"),f=(V(t._title,a,t._fontFamily),d3.max(this._tickValueTexts.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(null==t?"":t,e._fontSize,e._fontFamily)}));d.call(H,-(this._tickShow?(f?this._tickSize+this._tickPadding:5)+this._tickTextWidth:0),h/2),_.attr("y",-5).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(t._title)}else o.select("."+on).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,a=e._type,r=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===a?o.domain():o.ticks(e._tickCount),"number"===a&&0!=e._yRange.length&&t.push(-1==String(e._yRange[0]).indexOf(".")?e._yRange[0]:e._yRange[0].toFixed(0));var s=d3.max(t.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(null==t?"":t,r,e._fontFamily)})||0;return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,r,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var e=this,t=d3.max(this._tickValueTexts.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(null==t?"":t,e._fontSize,e._fontFamily)}),n=0;return this.isShow&&(n=this._tickShow?(t?this._tickSize+this._tickPadding:0)+this._tickTextWidth+(this._title?1.125*this._fontSize+11:0):this._titleShow&&this._title?1.125*this._fontSize+11:0),n}}]),n}(),rn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouping-bubble-chart"),e.clipArea=new bt(e.defs),e.grid=new Ct(e.coreGroup),e.core=new $e(e.coreGroup),e.xAxis=new ft(e.mainGroup).tickFormat(function(t){return t}),e.yAxis=new an(e.mainGroup),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleLinear(),e._xType="number",e._yType="number",e._sortValue=-1,e._maxRadius=15,e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var t=this,e=t.core,n=t.tooltip,i=t.grid,o=t.clipArea,a=t.activeData,r=a.nodes,l=a.labels,s=t.widthOfCore,u=t.heightOfCore,c=t.xScale,h=t.yScale,d=t._maxRadius,_=d3.max(r,function(t){return Math.abs(t.radius)}),f=d3.scaleSqrt().domain([0,_]).range([0,d]);e.data(r).cx(function(t){return c(t.x)}).cy(function(t){return h(t.y)}).radius(function(t){return f(Math.abs(t.radius))}).stroke("#fff").transition(t._transition).duration(t._duration).onMouseover(function(t){d3.select(this).style("stroke","#000");var e=[{color:t.color,text:l.category+""+t.category},{text:l.name+""+t.name},{text:l.x+""+t.x},{text:l.y+""+t.y},{text:l.radius+""+t.radius}];n.data(e).update().show()}).onMousemove(function(){n.move()}).onMouseout(function(){d3.select(this).style("stroke","#fff"),n.hide()}),i.width(s).height(u).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),t.coreGroup.call(H,t.yAxis.width+.5,0),0!=t._clipShow.length?o.width(s).height(u).paddingVertical([0,0]).transition(t._transition).duration(t._duration):o.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+o.id+")"),o.update(),e.update(),i.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy,o=i.legendData;t.legend.data(o).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),o.forEach(function(t){t.name===e.name&&(t.active=!n)}),i.nodes.forEach(function(t){t.category===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"computeDomain",value:function(){var t=this.activeData.nodes,e=this._xDomain||[],n=this._yDomain||[],i=d3.extent(t,function(t){return t.x}),o=d3.extent(t,function(t){return t.y}),a=isNaN(parseFloat(e[0]))?Math.min(0,i[0]||0):parseFloat(e[0]),r=isNaN(parseFloat(e[1]))?Math.max(1,i[1]||0):parseFloat(e[1]),l=isNaN(parseFloat(n[0]))?Math.min(0,o[0]||0):parseFloat(n[0]),s=isNaN(parseFloat(n[1]))?Math.max(1,o[1]||0):parseFloat(n[1]);this._xDomain=[a,r],this._yDomain=[l,s]}},{key:"sortData",value:function(){var t=this._data;-1===this._sortValue?t.nodes.sort(function(t,e){return e.radius-t.radius||t.index-e.index}):1===this._sortValue&&t.nodes.sort(function(t,e){return t.radius-e.radius||t.index-e.index}),this._sortedDataCopy=t}},{key:"buildOption",value:function(t,e){var n=new tn(t,e);return n.dataSolveFunc(en),n}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{nodes:t.nodes.filter(function(t){return!1!==t.active}),labels:t.labels}}}]),n}(),ln=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.minValue,n=t.maxValue,i=t.data,o=this.generateColorList(),a=o.length,r=(n-e)/(a-1),l=d3.range(a).map(function(t){return e+r*t}),s=d3.scaleLinear().domain(l).range(o);return i.forEach(function(t){t.nodes.forEach(function(t){return t.color=s(t.value)})}),t.colorScale=s,t}}]),n}();function sn(t,e){var n=0,i=1;if(e.forEach(function(t){"objCol"===t.function?n=t.index:"vCol"===t.function&&(i=t.index)}),P(t,[n,i])||!x(t,i))return{data:[],minValue:0,maxValue:0,dateLabel:"",valueLabel:""};for(var o={},a=/^\d{1,4}(\-|\/)\d{1,2}(\-|\/)\d{1,2}$/,r=1,l=t.length;r<l;r++){var s=t[r],u=s[n],c=parseFloat(s[i]);if(a.test(u)&&!isNaN(c)&&"Invalid Date"!==new Date(u)){u=y(u);var h=new Date(u),d=h.getFullYear();o[d]||(o[d]=[]),o[d].push({date:h,dateString:u,value:c})}}var _=[];for(var f in o)_.push({year:parseInt(f),nodes:o[f]});var p=d3.max(_,function(t){return d3.max(t.nodes,function(t){return t.value})});return{data:_,minValue:d3.min(_,function(t){return d3.min(t.nodes,function(t){return t.value})}),maxValue:p,dateLabel:t[0][n],valueLabel:t[0][i]}}var un=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","calendar-heatmap"),e._cellSize=20,e._cellFill="#fff",e._cellStroke="#ccc",e._monthStroke="#000",e}return u(n,A),l(n,[{key:"update",value:function(){var t,e,n,i=this,o=i._data,a=parseInt(o.year),r=o.nodes,l=i._cellSize,s=i.group;function u(t){var e=new Date(t.getFullYear(),t.getMonth()+1,0),n=t.getDay(),i=d3.timeWeek.count(d3.timeYear(t),t),o=e.getDay(),a=d3.timeWeek.count(d3.timeYear(e),e);return"M"+(i+1)*l+","+n*l+"H"+i*l+"V"+7*l+"H"+a*l+"V"+(o+1)*l+"H"+(a+1)*l+"V0H"+(i+1)*l+"Z"}(t=(s.select(".bottom-group").empty()?s.append("g").attr("class","bottom-group"):s.select(".bottom-group")).selectAll(".bottom-rect").data(function(){return d3.timeDays(new Date(a,0,1),new Date(a+1,0,1))})).exit().remove(),t.enter().append("rect").attr("class","bottom-rect").merge(t).attr("x",function(t){return d3.timeWeek.count(d3.timeYear(t),t)*l}).attr("y",function(t){return t.getDay()*l}).attr("width",l).attr("height",l).style("fill",i._cellFill).style("stroke",i._cellStroke).style("stroke-dasharray",function(){return i._gridShowX&&i._gridShowY?0:i._gridShowX?l+" "+l:i._gridShowY?"0 "+l+" 0":void 0}).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout),(e=(s.select(".active-group").empty()?s.append("g").attr("class","active-group"):s.select(".active-group")).selectAll(".color-rect").data(r,function(t){return t.date})).exit().remove(),e.enter().append("rect").attr("class","color-rect").merge(e).attr("x",function(t){return d3.timeWeek.count(d3.timeYear(t.date),t.date)*l}).attr("y",function(t){return t.date.getDay()*l}).attr("width",l).attr("height",l).style("fill",function(t){return t.color}).style("stroke",i._cellStroke).style("stroke-dasharray",function(){return i._gridShowX&&i._gridShowY?0:i._gridShowX?l+" "+l:i._gridShowY?"0 "+l+" 0":void 0}).on("mouseover",i._onMouseover).on("mousemove",i._onMousemove).on("mouseout",i._onMouseout),(n=(s.select(".month-group").empty()?s.append("g").attr("class","month-group"):s.select(".month-group")).selectAll(".month-path").data(function(){return d3.timeMonths(new Date(a,0,1),new Date(a+1,0,1))})).exit().remove(),n.enter().append("path").attr("class","month-path").merge(n).style("fill","none").style("stroke",i._monthStroke).attr("d",u)}},{key:"cellSize",value:function(t){return arguments.length?(this._cellSize=t,this):this._cellSize}},{key:"cellFill",value:function(t){return arguments.length?(this._cellFill=t,this):this._cellFill}},{key:"cellStroke",value:function(t){return arguments.length?(this._cellStroke=t,this):this._cellStroke}},{key:"monthStroke",value:function(t){return arguments.length?(this._monthStroke=t,this):this._monthStroke}},{key:"gridShowX",value:function(t){return arguments.length?(this._gridShowX=t,this):this._gridShowX}},{key:"gridShowY",value:function(t){return arguments.length?(this._gridShowY=t,this):this._gridShowY}}]),n}(),cn=function(){function e(t){r(this,e),this.id=i(""),this.elem=t.append("linearGradient").attr("id",this.id),this._colorList=[],this._offsetList=[]}return l(e,[{key:"update",value:function(){var t=this.elem,e=this._colorList,n=this._offsetList||[],i=e.length;if(n.length!==i){var o=1/(i-1);n=d3.range(i).map(function(t){return o*t})}var a=t.selectAll("stop").data(e);return a.exit().remove(),a.enter().append("stop").merge(a).attr("offset",function(t,e){return n[e]}).attr("stop-color",function(t){return t}),this}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"offsetList",value:function(t){return arguments.length?(this._offsetList=t,this):this._offsetList}}]),e}(),hn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","gradient-legend"),e.group=e.elem.append("g"),e.defs=e.elem.append("defs"),e.gradient=new cn(e.defs),e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._rectWidth=100,e._rectHeight=30,e._colorList=[],e._startText=0,e._endText=1,e._paddingHor=3,e._paddingVer=5,e._limitedWidth=400,e._horizontalAlign="center",e._title="title",e}return u(n,a),l(n,[{key:"update",value:function(){var t=this,e=t.gradient,n=t._rectWidth,i=t._rectHeight,o=t.group.style("font-size",t._fontSize+"px").style("font-family",t._fontFamily),a=o.select("rect").empty()?o.append("rect"):o.select("rect"),r=o.select(".start-text").empty()?o.append("text").attr("class","start-text"):o.select(".start-text"),l=o.select(".end-text").empty()?o.append("text").attr("class","end-text"):o.select(".end-text"),s=o.select(".legend-title").empty()?o.append("text").attr("class","legend-title"):o.select(".legend-title");e.colorList(t._colorList).update(),a.attr("x",0).attr("y",0).attr("width",n).attr("height",i).style("fill","url(#"+t.gradient.id+")"),s.attr("x",n/2).attr("y",i+t._paddingVer).attr("dy","1em").style("text-anchor","middle").text(t._title),r.attr("x",-t._paddingHor).attr("y",i/2).attr("dy","0.35em").style("text-anchor","end").style("fill",t._fontColor).text(t._startText),l.attr("x",n+t._paddingHor).attr("y",i/2).attr("dy","0.35em").style("text-anchor","start").style("fill",t._fontColor).text(t._endText);var u=t._horizontalAlign;return"left"===u?o.call(H,V(this._startText,t._fontSize,t._fontFamily),0):"right"===u?o.call(H,t._limitedWidth-n-V(this._endText,t._fontSize,t._fontFamily),0):o.call(H,t._limitedWidth/2-n/2,0),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"rectWidth",value:function(t){return arguments.length?(this._rectWidth=t,this):this._rectWidth}},{key:"rectHeight",value:function(t){return arguments.length?(this._rectHeight=t,this):this._rectHeight}},{key:"paddingHor",value:function(t){return arguments.length?(this._paddingHor=t,this):this._paddingHor}},{key:"paddingVer",value:function(t){return arguments.length?(this._paddingVer=t,this):this._paddingVer}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"startText",value:function(t){return arguments.length?(this._startText=t,this):this._startText}},{key:"endText",value:function(t){return arguments.length?(this._endText=t,this):this._endText}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"title",value:function(t){return arguments.length?(this._title=t,this):this._title}}]),n}(),dn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","calendar-heatmap-chart"),e.legend=new hn(e.group),e.xAxis=new Je(e.mainGroup),e._sortValue=1,e}return u(n,Qe),l(n,[{key:"updateCore",value:function(){var i=this,t=i.activeData,e=t.data,o=t.valueLabel,a=i.tooltip,n=i.widthOfCore,r=i.heightOfCore/e.length,l=Math.min(r/7,n/56),s=i._gridShowX||i._gridShowY?i._gridStroke:"none",u=i._xTickShow?i._axisLineStroke:"none",c=53*l,h=7*l,d=d3.timeFormat("%Y-%m-%d"),_=i.coreGroup.selectAll(".year-group").data(e,function(t){return t.year});_.exit().remove(),_.enter().append("g").attr("class","year-group").merge(_).attr("transform",function(t,e){return"translate("+(n-c)/2+", "+(r*e+(r-h)/2)+")"}).each(function(t){var e=d3.select(this),n=e.property("calendar")||new un(e);e.property("calendar",n),n.data(t).cellSize(l).cellStroke(s).monthStroke(u).gridShowX(i._gridShowX).gridShowY(i._gridShowY).onMouseover(function(t){var e=[];e=t instanceof Date?[{text:d(t)}]:[{text:t.dateString,color:t.color},{text:o+""+t.value}],d3.select(this).raise().style("stroke","#000"),a.data(e).update().show()}).onMousemove(function(){a.move()}).onMouseout(function(){d3.select(this).style("stroke",s),a.hide()}),n.update(),(e.select("text").empty()?e.append("text"):e.select("text")).attr("transform","translate(-6, "+h/2+")rotate(-90)").style("font-size",i._fontSize).style("font-family",i._fontFamily).style("fill",i._fontColor).style("text-anchor","middle").text(t.year)})}},{key:"updateLegend",value:function(){var t=this.legend,e=this.widthOfNoMargin;if(!this._legendShow)return t.hide();t.show(),t.limitedWidth(e).horizontalAlign(this._legendX).rectWidth(e/5).rectHeight(e/5/10).fontSize(this._fontSize).fontFamily(this._fontFamily).fontColor(this._fontColor),this.configLegend(),t.update()}},{key:"configLegend",value:function(){var t=this.sortedDataCopy;this.legend.colorList(t.colorScale.range()).startText(t.minValue).endText(t.maxValue).title(t.valueLabel)}},{key:"updateAxis",value:function(){var t=this.xAxis;t.scaleFunc(d3.scaleLinear().range([0,this.widthOfNoMargin])).title(this._xTitle).fontSize(this._fontSize).fontColor(this._fontColor).fontFamily(this._fontFamily).transition(!1).axisLineShow(!1).tickShow(!1),t.translate(0,this.heightOfMainGroup-t.height).update()}},{key:"computeDomain",value:function(){}},{key:"sortData",value:function(){var t=this._data.data;1===this._sortValue?t.sort(function(t,e){return t.year-e.year}):-1===this._sortValue&&t.sort(function(t,e){return e.year-t.year}),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new ln(t,e);return n.dataSolveFunc(sn),n}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{data:t.data,valueLabel:t.valueLabel}}}]),n}(),_n=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","hollow-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=0,e._borderColor="",e._borderWidth=0,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n._data,i=n.group;i.select(".hollow-bar-rects").remove();var e=i.append("g").attr("class","hollow-bar-rects").selectAll("rect").data(t,function(t){return t.key});e.exit().remove();var o=e.enter().append("rect").merge(e).style("fill",function(t){return n._fillColor||t.color}).style("fill-opacity",function(t){return n._fillOpacity}).style("stroke",function(t){return n._borderColor||t.color}).style("stroke-width",function(t){return n._borderWidth||n._strokeWidth||0}).style("fill-opacity",function(t){return n._fillOpacity}).style("rx",n._barCornerRadius).style("ry",n._barCornerRadius);if(this._rectObj?(o.attr("x",this._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){i.select(".hollow-bar-texts").remove();var a=i.append("g").attr("class","hollow-bar-texts").selectAll("text").data(t,function(t){return t.key});a.exit().remove();a.enter().append("text").attr("class","hollow-bar-text").merge(e).text(this._textObj.textFunc).attr("fill",n._textObj.colorFunc).attr("font-size",n._textObj.fontSize).attr("font-family",n._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dy",this._textObj.dyFunc).attr("dx",function(t,e){return null==n._labelShow||0==n._labelShow||null==n._positionOptions||null==n._positionChoice?0:0==n._positionOptions.indexOf(n._positionChoice)?.3*n._textObj.fontSize:1==n._positionOptions.indexOf(n._positionChoice)?-n._xScale(t.value)+.3*n._textObj.fontSize:2==n._positionOptions.indexOf(n._positionChoice)?.3*-n._textObj.fontSize-at(d3.select(i.selectAll(".hollow-bar-texts text").nodes()[e])).width:void 0}).style("display",this._textObj.labelShow?"block":"none");null!=n._labelShow&&0!=n._labelShow&&null!=n._positionOptions&&null!=n._positionChoice&&-1!=n._positionOptions.indexOf(n._positionChoice)||i.selectAll(".hollow-bar-texts text").style("display","none")}for(var r=i.selectAll(".hollow-bar-text"),l=[],s=[],u=0;u<r._groups[0].length;u++){s.push(u);for(var c=u+1;c<r._groups[0].length;c++){rt(at(d3.select(r._groups[0][u])),at(d3.select(r._groups[0][c])))&&(l.push(u),d3.select(r._groups[0][u]).style("opacity","0"))}}for(var h=new Set(l),d=Array.from(h),_=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(d,s),f=0;f<d.length;f++){for(var p=[],y=0;y<_.length;y++){var g=at(d3.select(r._groups[0][d[f]])),v=at(d3.select(r._groups[0][_[y]]));if(p.push(rt(g,v)),rt(g,v)){if(d[f]==_[y])continue;d3.select(r._groups[0][d[f]]).style("opacity","0")}}0==p.filter(function(t){return 1==t}).length&&_.push(d[f])}for(var x=0;x<_.length;x++)d3.select(r._groups[0][_[x]]).style("opacity","1");return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),n}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),fn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("rect").attr("class","selectOverlay-rect"),e._width=0,e._height=0,e._shadowColor="#000",e}return u(n,a),l(n,[{key:"update",value:function(){return this.elem.attr("x",0).attr("y",0).attr("width",this._width<0?0:this._width).attr("height",this._height).style("fill",this._shadowColor).style("opacity",.15),this}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),n}(),pn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","hollow-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new _n(e.coreGroup),e.overlay=new Xe(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new an(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._strokeWidth=2,e._rectHeight=.5,e._labelShow=!1,e._positionOptions=["","",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var c=this,h=c.activeData,d=[],t=[];h.children.forEach(function(e){e.children.forEach(function(t){t.color=e.color,d.push(t)})});for(var e=0;e<d.length;e++)null==c._labelShow||null==c._positionOptions||null==c._positionChoice||-1==c._positionOptions.indexOf(c._positionChoice)?t.push(0):1==c._labelShow&&0==c._positionOptions.indexOf(c._positionChoice)?t.push(V(d[e].value,c._textLabel.fontSize,c._textLabel.fontFamily)):t.push(0);var n=c.grid,i=c.rectPlot,_=c.tooltip,o=c.overlay,f=c.selectOverlay,a=c.xScale,p=c.yScale,r=c.widthOfCore,l=c.heightOfCore,s=p.step();n.width(r-(0==t.length?0:d3.max(t))).height(l).xTickLocations(c.xAxis.tickLocations.slice(1)).yTickLocations(c.yAxis.tickLocations).showX(c._gridShowX).showY(c._gridShowY).stroke(c._gridStroke).strokeDasharray(c._gridStrokeDasharray),o.width(r-(0==t.length?0:d3.max(t))).height(l).onMouseover(function(){_.show(),f.show()}).onMousemove(function(){for(var t=c.elem.node().parentNode,e=d3.mouse(t),n=d3.mouse(this)[1],i=p.step(),o=Math.floor(n/i),a=p.domain()[d.length-o-1],r="",l=0;l<h.children.length;l++)for(var s=0;s<h.children[l].children.length;s++)h.children[l].children[s].name==a&&(r=h.children[l].name);var u=[{text:r}];a&&(u.push({text:d[d.length-o-1].name+": "+d[d.length-o-1].value,color:d[d.length-o-1].color}),f.translate(0,p(a))),_.data(u).update().move([e[0],e[1]])}).onMouseout(function(){_.hide(),f.hide()}),f.width(r-(0==t.length?0:d3.max(t))).height(p.step()).shadowColor("#ccc").hide(),i.data(d).xScale(a).yScale(p).labelShow(c._labelShow).positionOptions(c._positionOptions).positionChoice(c._positionChoice).fillColor("none").strokeWidth(c._strokeWidth).rectObj({xFunc:function(){return 0},yFunc:function(t,e){return c.yScale.range()[0]-(e*s+(s-s*c._rectHeight)/2+s*c._rectHeight)},widthFunc:function(t){return c.xScale(t.value)},heightFunc:function(t){return s*c._rectHeight}}).textObj({xFunc:function(t,e){return c.xScale(t.value)},yFunc:function(t,e){return c.yScale.range()[0]-(e*s+(s-.9*s*c._rectHeight)/2+.7*s*c._rectHeight)},dyFunc:.5*s*c._rectHeight/2+c._textLabel.fontSize/3,colorFunc:function(){return c._textLabel.color},textFunc:function(t){return 0==t.value?"":t.value},fontSize:c._textLabel.fontSize,fontFamily:c._textLabel.fontFamily,labelShow:c._labelShow}),c.coreGroup.call(H,c.yAxis.width+.5,0),n.update(),f.update(),i.update(),o.update()}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,a=e._xType,r=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e.widthOfNoMargin,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).xRange(e._xRange).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).yRange(e._yRange).transition(e._transition).duration(e._duration);var d=e.activeData,_=[];d.children.forEach(function(e){e.children.forEach(function(t){t.color=e.color,_.push(t)})});for(var f=[],p=0;p<_.length;p++)null==e._labelShow||null==e._positionOptions||null==e._positionChoice||-1==e._positionOptions.indexOf(e._positionChoice)?f.push(0):1==e._labelShow&&0==e._positionOptions.indexOf(e._positionChoice)?f.push(V(_[p].value,e._textLabel.fontSize,e._textLabel.fontFamily)):f.push(0);n&&n.titleHeight;var y=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(3*u);t.tickCount(y).compute(),n.compute();var g=(c-n.width-(0==f.length?0:d3.max(f)))/t._tickValues.length,v=d3.max(t._tickValues,function(t){return V(t,u,e._fontFamily)}),x=(t._tickShow?t._tickSize+t._tickPadding+(v<g?1.125*t._fontSize:t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-x,0]),n.compute(),i.range([0,c-n.width-(0==f.length?0:d3.max(f))]),t.compute();var m=n.width,k=h-x,b=n.width;t.translate(m,k).update(),n.translate(b,0).update()}},{key:"computeDomain",value:function(){var t=this.activeData,n=[];t.children.forEach(function(e){e.children.forEach(function(t){t.color=e.color,n.push(t)})});var e=this._xDomain||[],i=n.length?n.map(function(t){return t.name}):[0,1],o=n.length?[Math.min(d3.min(n,function(t){return+t.value}),0),d3.max(n,function(t){return+t.value})]:[0,1];this._xDomain=[isNaN(parseFloat(e[0]))?o[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?o[1]:parseFloat(e[1])],this._yDomain=i}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.nodes,o=i.map(function(t,e){return{name:t.name,color:t.color,key:t.name+"-"+e}});t.legend.data(o).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),o.forEach(function(t){t.key===e.key&&(t.active=!n)}),i.forEach(function(t){t.name===e.name&&(t.active=!n)}),t.onDataChange()})}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort(function(t,e){return e.sum-t.sum||t.index-e.index}):1===this._sortValue&&t.sort(function(t,e){return t.sum-e.sum||t.index-e.index}),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var n=new _e(t,e);return n.dataSolveFunc(fe),n}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter(function(t){return!1!==t.active})}}}]),n}(),yn=function(t){function e(t){return r(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return u(e,xt),l(e,[{key:"update",value:function(){var n=this,t=n.group,e=n._data,i=n._xScale,o=n._yScale;t.selectAll(".stacked-scatter-circle").remove();var a=t.selectAll("g").data(e,function(t){return t.name});a.exit().remove(),a.enter().append("g").merge(a).each(function(t){var e=d3.select(this).selectAll("circle").data(t.data);e.exit().remove(),e.enter().append("circle").attr("class","stacked-scatter-circle").attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.total)||0}).merge(e).style("fill",n._fill||t.color).style("stroke",n._stroke||t.color).style("stroke-width",n._strokeWidth).attr("r",n._radius).attr("cx",function(t){return i(t.name)||0}).attr("cy",function(t){return o(t.total)||0})});for(var r=t.selectAll(".stacked-scatter-circle").nodes(),l=0;l<r.length;l++)""==r[l].__data__.value||isNaN(r[l].__data__.value)?d3.select(r[l]).style("opacity","0"):d3.select(r[l]).style("opacity","1");return n}}]),e}(),gn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","ranking-line-plot"),e._xScale=null,e._yScale=null,e._lineFunc=null,e._stroke=null,e._lineWidth=2,e._strokeDasharry="",e._curve=d3.curveLinear,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._lineFunc||d3.line().x(function(t){return e._xScale(t.name)}).y(function(t){return e._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});n.curve(e._curve);var i=e.group.selectAll("path").data(t,function(t){return t.key});return i.exit().remove(),i.enter().append("path").merge(i).style("fill","none").style("stroke",function(t){return e._stroke||t.color||"#000"}).style("stroke-width",e._lineWidth).style("stroke-dasharray",e._strokeDasharry).transition().duration(e._transition?e._duration:0).attr("d",function(t){return n(t.data)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),vn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stacked-chart"),e.grid=new Ct(e.coreGroup),e.areaPlot=new De(e.coreGroup),e.linePlot=new gn(e.coreGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.guideScatter=new yn(e.coreGroup),e.stackText=new kt(e.coreGroup),e.clipArea=new bt(e.defs),e.AnimationArea=new St(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=null,e._curve=d3.curveCardinal,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=t.grid,i=t.areaPlot,o=t.linePlot,r=t.guideScatter,l=t.tooltip,a=t.stackText,s=t.overlay,u=t.guideLine,c=t.clipArea,h=(t.AnimationArea,t.xScale),d=t.yScale,_=t.widthOfCore,f=t.heightOfCore,p=0;p<n.length;p++)for(var y=0;y<n[p].data.length;y++)n[p].data[y].value=parseFloat(n[p].data[y].value),n[p].data[y].total=0==p?isNaN(parseFloat(n[p].data[y].value))?0:parseFloat(n[p].data[y].value):n[p-1].data[y].total+(isNaN(parseFloat(n[p].data[y].value))?0:parseFloat(n[p].data[y].value));Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.total})}),0);e.width(_).height(f).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(h).yScale(d).fillOpacity(.7).curve(t._curve).areaFunc(d3.area().x(function(t){return h(t.name)}).y0(function(t){return d(t.total-t.value)}).y1(function(t){return d(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),o.data(n).xScale(h).yScale(d).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).mainGroup(t.mainGroup).curve(t._curve).lineFunc(d3.line().x(function(t){return h(t.name)}).y(function(t){return d(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),r.data(n).xScale(h).yScale(d).radius(3.5).stroke("#fff").strokeWidth(2),u.y1(0).y2(f).stroke("#c6c6c6").strokeDasharray("0 0"),s.data(h.domain()).bandWidth(h.step()).bandHeight(f).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),l.data(o).update(),u.x(h(i)).update(),r.data(a).update(),l.show(),u.show(),r.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),u.hide(),r.hide()}),a.data(n).xScale(h).yScale(d).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice),t.coreGroup.call(H,t.yAxis.width+.5,0),0!=t._clipShow.length?c.width(_).height(f).paddingVertical([0,0]).transition(t._transition).duration(t._duration):c.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+c.id+")"),c.update(),r.elem.style("pointer-events","none");var g=t.group.selectAll(".stacked-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(g).remove(),e.update(),s.update(),i.update(),o.update(),a.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=Ft;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){for(var t=this.activeData,e=0;e<t.length;e++)for(var n=0;n<t[e].data.length;n++)t[e].data[n].value=parseFloat(t[e].data[n].value),t[e].data[n].total=0==e?isNaN(parseFloat(t[e].data[n].value))?0:parseFloat(t[e].data[n].value):t[e-1].data[n].total+(isNaN(parseFloat(t[e].data[n].value))?0:parseFloat(t[e].data[n].value));var i=this._yRange||[],o=t.length?t[0].data.map(function(t){return t.name}):[0,1],a=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total})}),0),1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total})})]:[0,1];this._xDomain=o,this._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}}]),n}(),xn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rect-plot"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=0,e._borderColor="#000",e._borderWidth=0,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group,i=n.selectAll("rect").data(t,function(t){return t.key});i.exit().remove();var o=i.enter().append("g").append("rect").merge(i).style("fill",function(t){return e._fillColor||t.color}).style("fill-opacity",function(t){return e._fillOpacity}).style("stroke",function(t){return e._strokeColor||t.color}).style("stroke-width",function(t){return e._strokeWidth||0});if(this._rectObj?(o.attr("x",e._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){n.selectAll(".symmetric-texts").remove();var a=n.append("g").attr("class","symmetric-texts").selectAll("text").data(t,function(t){return t.key});a.exit().remove();a.enter().append("g").append("text").merge(a).text(this._textObj.textFunc).attr("fill",e._textObj.colorFunc).attr("font-size",e._textObj.fontSize).attr("font-family",e._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).style("display",this._textObj.labelShow?"block":"none")}o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);for(var r=n.selectAll(".symmetric-texts text"),l=[],s=[],u=0;u<r._groups[0].length;u++){s.push(u);for(var c=u+1;c<r._groups[0].length;c++){rt(at(d3.select(r._groups[0][u])),at(d3.select(r._groups[0][c])))&&(l.push(u),d3.select(r._groups[0][u]).style("opacity","0"))}}for(var h=new Set(l),d=Array.from(h),_=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(d,s),f=0;f<d.length;f++){for(var p=[],y=0;y<_.length;y++){var g=at(d3.select(r._groups[0][d[f]])),v=at(d3.select(r._groups[0][_[y]]));if(p.push(rt(g,v)),rt(g,v)){if(d[f]==_[y])continue;d3.select(r._groups[0][d[f]]).style("opacity","0")}}0==p.filter(function(t){return 1==t}).length&&_.push(d[f])}for(var x=0;x<_.length;x++)d3.select(r._groups[0][_[x]]).style("opacity","1");return e}},{key:"updateChangeWaterfall",value:function(){var e=this,t=e._data,n=e.group;n.select(".change-rects").remove();var i=n.append("g").attr("class","change-rects").selectAll("rect").data(t,function(t){return t.key});i.exit().remove();var o=i.enter().append("rect").merge(i).style("fill",function(t){return 0<t.value?e._fillColor||t.color:e._fillColor||t.color_special}).style("fill-opacity",function(t){return e._fillOpacity}).style("rx",e._barCornerRadius).style("ry",e._barCornerRadius).style("stroke",function(t){return 0<t.value?e._borderColor||t.color:e._borderColor||t.color_special}).style("stroke-width",function(t){return e._borderWidth||0});if(this._rectObj?(o.attr("x",e._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){n.select(".change-texts").remove();var a=n.append("g").attr("class","change-texts").selectAll("text").data(t,function(t){return t.key});a.exit().remove();a.enter().append("text").merge(a).text(this._textObj.textFunc).attr("fill",e._textObj.colorFunc).attr("font-size",e._textObj.fontSize).attr("font-family",e._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("text-anchor","middle").style("display",this._textObj.labelShow?"block":"none");null!=e._labelShow&&null!=e._positionOptions&&null!=e._positionChoice&&-1!=e._positionOptions.indexOf(e._positionChoice)||n.selectAll(".change-texts text").style("display","none")}return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"updateFormWaterfall",value:function(){var e=this,t=e._data,n=e.group;n.select(".form-rects").remove();var i=n.append("g").attr("class","form-rects").selectAll("rect").data(t,function(t){return t.key});i.exit().remove();var o=i.enter().append("rect").merge(i).style("fill",function(t){return 0<t.value?e._fillColor||t.color:e._fillColor||t.color_special}).style("fill-opacity",function(t){return e._fillOpacity}).style("rx",e._barCornerRadius).style("ry",e._barCornerRadius).style("stroke",function(t){return 0<t.value?e._borderColor||t.color:e._borderColor||t.color_special}).style("stroke-width",function(t){return e._borderWidth||0});if(this._rectObj?(o.attr("x",e._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){n.select(".form-texts").remove();var a=n.append("g").attr("class","form-texts").selectAll("text").data(t,function(t){return t.key});a.exit().remove();a.enter().append("text").merge(a).text(this._textObj.textFunc).attr("fill",e._textObj.colorFunc).attr("font-size",e._textObj.fontSize).attr("font-family",e._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("text-anchor","middle").style("display",this._textObj.labelShow?"block":"none");null!=e._labelShow&&null!=e._positionOptions&&null!=e._positionChoice&&-1!=e._positionOptions.indexOf(e._positionChoice)||n.selectAll(".form-texts text").style("display","none")}return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"updateHorizontalBar",value:function(){var n=this,t=n._data,e=n.group;e.select(".horizontal-bar-rects").remove();var i=e.append("g").attr("class","horizontal-bar-rects").selectAll("rect").data(t,function(t){return t.key});i.exit().remove();var o=i.enter().append("rect").merge(i).style("fill",function(t){return n._fillColor||t.color}).style("fill-opacity",function(t){return n._fillOpacity}).style("stroke",function(t){return n._borderColor||n._strokeColor||t.color}).style("stroke-width",function(t){return n._borderWidth||n._strokeWidth||0}).style("fill-opacity",function(t){return n._fillOpacity}).style("rx",n._barCornerRadius).style("ry",n._barCornerRadius);if(this._rectObj?(o.attr("x",n._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){e.select(".horizontal-bar-texts").remove();var a=e.append("g").attr("class","horizontal-bar-texts").selectAll("text").data(t,function(t){return t.key});a.exit().remove();a.enter().append("text").attr("class","horizontal-bar-text").merge(i).text(this._textObj.textFunc).attr("fill",n._textObj.colorFunc).attr("font-size",n._textObj.fontSize).attr("font-family",n._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dy",this._textObj.dyFunc).attr("dx",function(t,e){if(null==n._labelShow||0==n._labelShow||null==n._positionOptions||null==n._positionChoice)return 0;if(0==n._positionOptions.indexOf(n._positionChoice)){if(0<t.value||0==t.value)return.3*n._textObj.fontSize;if(t.value<0)return-V(t.value,n._textObj.fontSize,n._textObj.fontFamily)-.3*n._textObj.fontSize}else if(1==n._positionOptions.indexOf(n._positionChoice)){if(0<t.value||0==t.value)return-(n._xScale(t.value)-n._xScale(0))+.3*n._textObj.fontSize;if(t.value<0)return n._xScale(0)-n._xScale(t.value)-.3*n._textObj.fontSize-V(t.value,n._textObj.fontSize,n._textObj.fontFamily)}else if(2==n._positionOptions.indexOf(n._positionChoice)){if(0<t.value||0==t.value)return-(n._xScale(t.value)-n._xScale(0))/2-V(t.value,n._textObj.fontSize,n._textObj.fontFamily)/2;if(t.value<0)return(n._xScale(0)-n._xScale(t.value))/2-V(t.value,n._textObj.fontSize,n._textObj.fontFamily)/2}else if(3==n._positionOptions.indexOf(n._positionChoice)){if(0<t.value||0==t.value)return.3*-n._textObj.fontSize-V(t.value,n._textObj.fontSize,n._textObj.fontFamily);if(t.value<0)return.3*n._textObj.fontSize}}).style("display",this._textObj.labelShow?"block":"none");null!=n._labelShow&&0!=n._labelShow&&null!=n._positionOptions&&null!=n._positionChoice||e.selectAll(".horizontal-bar-texts text").style("display","none")}for(var r=e.selectAll(".horizontal-bar-text"),l=[],s=[],u=0;u<r._groups[0].length;u++){s.push(u);for(var c=u+1;c<r._groups[0].length;c++){rt(at(d3.select(r._groups[0][u])),at(d3.select(r._groups[0][c])))&&(l.push(u),d3.select(r._groups[0][u]).style("opacity","0"))}}for(var h=new Set(l),d=Array.from(h),_=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(d,s),f=0;f<d.length;f++){for(var p=[],y=0;y<_.length;y++){var g=at(d3.select(r._groups[0][d[f]])),v=at(d3.select(r._groups[0][_[y]]));if(p.push(rt(g,v)),rt(g,v)){if(d[f]==_[y])continue;d3.select(r._groups[0][d[f]]).style("opacity","0")}}0==p.filter(function(t){return 1==t}).length&&_.push(d[f])}for(var x=0;x<_.length;x++)d3.select(r._groups[0][_[x]]).style("opacity","1");return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),n}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),mn=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t,n,e=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),i=this.generateColorList(e.length);return n=i,(t=e).forEach(function(e,t){e.color=n[t],e.color_special=n[t+1],e.data.forEach(function(t){t.color=e.color,t.color_special=e.color_special})}),t}}]),n}(),kn="legend-group",bn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","waterfalllegend"),e.group=e.elem.append("g"),e._data=[],e._shapeType="circle",e._shapeWidth=16,e._shapeHeight=16,e._shapeStroke="none",e._rowGap=6,e._colGap=20,e._innerGap=6,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._limitedWidth=400,e._horizontalAlign="center",e._onClick=function(){},e._each=function(){},e._orient="horizontal",e}return u(n,a),l(n,[{key:"update",value:function(){var a=this,r=a.group,l=Math.max(a._shapeHeight,a._fontSize),s=a._limitedWidth-a._shapeWidth-a._innerGap,u=0,c=0;a.elem.selectAll("."+kn).remove();var h=r.append("g").attr("class",kn);if(0<a._data.length){var t={name:a._data[0].name,data:a._data[0].data,color:a._data[0].color,color_special:a._data[0].color_special,key:a._data[0].key,name1:""},e={name:a._data[0].name,data:a._data[0].data,color:a._data[0].color,color_special:a._data[0].color_special,key:a._data[0].key,name1:""},n=[];n.push(t),n.push(e),n.forEach(function(t,e){var n=I(t.name1,s,a._fontSize,a._fontFamily),i=a._shapeWidth+a._innerGap+V(n,a._fontSize,a._fontFamily);if("vertical"===a._orient)a._legendItem(t,h,0,c,e),c=c+l+a._rowGap;else{var o=u+i+a._colGap;o>a._limitedWidth&&(u=0,o=i+a._colGap,c+=l+a._rowGap,h=r.append("g").attr("class",kn)),a._legendItem(t,h,u,c,e),u=o}});var i=at(r).width;"center"===a._horizontalAlign?r.call(H,a._limitedWidth/2-i/2,0):"left"===a._horizontalAlign?r.call(H,0,0):"right"===a._horizontalAlign&&r.call(H,a._limitedWidth-i,0)}return a}},{key:"_shapeElem",value:function(t){var e=void 0;return(e="rect"===this._shapeType?t.append("rect").attr("width",this._shapeWidth).attr("height",this._shapeHeight):t.append("circle").attr("cx",this._shapeWidth/2).attr("cy",this._shapeHeight/2).attr("r",Math.min(this._shapeWidth,this._shapeHeight)/2)).attr("class","legend-shape"),e}},{key:"_legendItem",value:function(e,t,n,i,o){var a=t.append("g").datum(e).attr("class","legend-item").call(H,n,i).on("click",this._onClick).each(this._each);return this._shapeElem(a).style("fill",function(t){return 0==o?e.color:e.color_special}),a.append("text").attr("x",this._shapeWidth+this._innerGap).attr("y",this._shapeHeight/2).attr("dy","0.35em").style("text-anchor","start").style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("fill",this._fontColor).text(I(e.name1,this._limitedWidth-this._shapeWidth-this._innerGap,this._fontSize,this._fontFamily)),a}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"shapeType",value:function(t){return arguments.length?(this._shapeType=t,this):this._shapeType}},{key:"shapeWidth",value:function(t){return arguments.length?(this._shapeWidth=t,this):this._shapeWidth}},{key:"shapeHeight",value:function(t){return arguments.length?(this._shapeHeight=t,this):this._shapeHeight}},{key:"rowGap",value:function(t){return arguments.length?(this._rowGap=t,this):this._rowGap}},{key:"colGap",value:function(t){return arguments.length?(this._colGap=t,this):this._colGap}},{key:"innerGap",value:function(t){return arguments.length?(this._innerGap=t,this):this._innerGap}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"onClick",value:function(t){return arguments.length?(this._onClick=t,this):this._onClick}},{key:"each",value:function(t){return arguments.length?(this._each=t,this):this._each}}]),n}();function Sn(t,e){var n=0,i=1;if(e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"vCol"===t.function&&(i=t.index)}),P(t,[n,i])||!x(t,i))return[];var o={},a=[],r=t.length,l=t[0][i];""!=l&&null!=l&&null!=l||(l="$-0"),o[l]={name:l,showLegend:"$-0"!=l,data:[]};for(var s=0,u=1;u<r;u++){var c=t[u],h=c[n];if(""!=h&&null!=h&&null!=h||(h="&-"+u),h){var d=l;1==u?s=isNaN(parseFloat(t[1][i]))?0:parseFloat(t[1][i]):s+=isNaN(parseFloat(c[i]))?0:parseFloat(c[i]),o[d].data.push({name:h,showAxisText:h!="&-"+u,value:""==c[i]||isNaN(parseFloat(c[i]))||null==c[i]||null==c[i]?0:c[i],total:s})}}for(var _ in o)a.push(o[_]);return a.forEach(function(t,e){t.key=t.name+"-"+e}),a}var wn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","change-waterfall-histogram-chart"),e.grid=new Ct(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xAxis.minTickDistance(1),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e._curve=d3.curveCardinal,e.legend=new bn(e.group),e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new xn(e.coreGroup),e.overlay=new At(e.coreGroup),e._histogramWidth=1,e._yScaleHeight=1.05,e._barWidthPercent=.5,e._barCornerRadius=0,e._borderWidth=0,e._borderColor="none",e._fillOpacity=1,e._labelShow=!1,e._positionOptions=["","",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var n=this,r=n.activeData,t=r.toString()?r[0].data:[],e=n.grid,l=n.tooltip,i=n.rectPlot,o=n.overlay,s=n.selectOverlay,a=n._barWidthPercent,u=n.xScale,c=n.yScale,h=n.widthOfCore,d=n.heightOfCore,_=Math.min(d3.min(r,function(t){return d3.min(t.data,function(t){return+t.total})}),0),f=(d3.max(r,function(t){return d3.max(t.data,function(t){return+t.total})}),d3.min(r,function(t){return d3.min(t.data,function(t){return+t.value})}),r.length&&r[0].data[0].value,n.widthOfNoMargin,n.heightOfMainGroup);n.yAxis.width,n.xAxis.height;o.data(u.domain()).isScalePoint(!1).bandWidth(u.step()).bandHeight(d).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];r.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:("$-0"==t.name?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),l.data(o).update(),s.translate(u(i),0),l.show()}).onMousemove(function(){l.move(),s.show()}).onMouseout(function(){l.hide(),s.hide()}),i.data(t).xScale(u).yScale(c).barCornerRadius(n._barCornerRadius).borderWidth(n._borderWidth).borderColor(n._borderColor).labelShow(n._labelShow).positionOptions(n._positionOptions).positionChoice(n._positionChoice).rectObj({xFunc:function(t,e){return u.step()*e+u.step()*(1-n._histogramWidth*a)/2},yFunc:function(t){return t.value<0?c(t.total-t.value):c(t.total)},widthFunc:function(){return u.step()*n._histogramWidth*a},heightFunc:function(t){return 0<_||0==_?Math.abs(c.range()[0]-c(Math.abs(t.value))):_<0?Math.abs(c(0)-c(Math.abs(t.value))):void 0}}).textObj({xFunc:function(t,e){return u.step()*e+u.step()*(1-n._histogramWidth*a)/2},yFunc:function(t){return t.value<0?c(t.total-t.value):c(t.total)},dxFunc:function(t,e){return u.step()*n._histogramWidth*a/2},dyFunc:function(t,e){return 0==n._positionOptions.indexOf(n._positionChoice)?.5*-n._textLabel.fontSize:1==n._positionOptions.indexOf(n._positionChoice)?0<_?c.range()[0]-c(Math.abs(t.value))-.5*n._textLabel.fontSize:c(0)-c(Math.abs(t.value))-.5*n._textLabel.fontSize:2==n._positionOptions.indexOf(n._positionChoice)?0<_?(c.range()[0]-c(Math.abs(t.value)))/2+.4*n._textLabel.fontSize:(c(0)-c(Math.abs(t.value)))/2+.4*n._textLabel.fontSize:void 0},colorFunc:function(){return n._textLabel.color},textFunc:function(t){return 0==t.value?"":t.value},fontSize:n._textLabel.fontSize,fontFamily:n._textLabel.fontFamily,labelShow:n._labelShow}).fillOpacity(n._fillOpacity),e.width(h).height(d).xTickLocations(n.xAxis.tickLocations).yTickLocations(n.yAxis.tickLocations.slice(1)).showX(n._gridShowX).showY(n._gridShowY).stroke(n._gridStroke).strokeDasharray(n._gridStrokeDasharray),s.width(u.step()).height(d).shadowColor("#ccc").hide(),n.coreGroup.attr("transform","translate("+n.yAxis.width+",0)");var p=n.group.selectAll(".change-waterfall-histogram-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(p).remove(),i.updateChangeWaterfall(),s.update(),o.update();var y=n.yAxis.width;e.translate(y,0).update()}},{key:"updateLegend",value:function(){var t=this.legend,e=this.widthOfNoMargin;if(!this._legendShow)return t.hide();t.show(),t.limitedWidth(e).fontSize(this._fontSize).fontFamily(this._fontFamily).fontColor(this._fontColor).horizontalAlign(this._legendX).each(function(t){var e=!1===t.active;d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}),this.configLegend(),t.update()}},{key:"configLegend",value:function(){var t=this.sortedDataCopy;this.legend.data(t).onClick(function(t){})}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._borderWidth=e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?e.borderColor:this._borderColor,this._fillOpacity=e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=Sn;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yRange||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total})}),0),Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total})}),0)*this._yScaleHeight]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}}]),n}();function On(t,e){var n=0;e.forEach(function(t){"objCol"===t.function&&(n=t.index,t.isLegend)});var i={},o=[],a=t.length,r=t[0];r.forEach(function(t,e){e!==n&&t&&(i[t]={name:t,data:[]})});for(var l=1;l<a;l++){var s=t[l],u=s[n];if(u)for(var c=0;c<s.length;c++){var h=r[c];c!==n&&h&&i[h].data.push({name:u,value:s[c]})}}for(var d in i)o.push(i[d]);return o.forEach(function(t,e){t.key=t.name+"-"+e}),o}function Cn(t,e){var n=0,i=1;if(e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"vCol"===t.function&&(i=t.index)}),P(t,[n,i])||!x(t,i))return[];var o={},a=[],r=t.length,l=t[0],s=l[i];o[s]={name:s,data:[]};for(var u=0,c=1;c<r;c++){var h=t[c],d=h[n];if(""!=d&&null!=d&&null!=d||(d="&-"+c),d){var _=l[i];1==c||2==c?u=isNaN(parseFloat(t[1][i]))?0:parseFloat(t[1][i]):u-=isNaN(parseFloat(t[c-1][i]))?0:parseFloat(t[c-1][i]),o[_].data.push({name:d,showAxisText:d!="&-"+c,value:""==h[i]||isNaN(parseFloat(h[i]))||null==h[i]||null==h[i]?0:h[i],total:u})}}for(var f in o)a.push(o[f]);return a.forEach(function(t,e){t.key=t.name+"-"+e}),a}var An=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","form-waterfall-histogram-chart"),e.grid=new Ct(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xAxis.minTickDistance(1),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e._curve=d3.curveCardinal,e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new xn(e.coreGroup),e.overlay=new At(e.coreGroup),e._histogramWidth=1,e._yScaleHeight=1.05,e._marginTop=20,e._barWidthPercent=.5,e._barCornerRadius=0,e._borderWidth=1,e._borderColor="none",e._fillOpacity=1,e._labelShow=!1,e._positionOptions=["","",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var n=this,r=n.activeData,t=r.toString()?r[0].data:[],e=n.grid,l=n.tooltip,i=n.rectPlot,o=n.overlay,s=n.selectOverlay,a=n._barWidthPercent?n._barWidthPercent:.8,u=n.xScale,c=n.yScale,h=n.widthOfCore,d=n.heightOfCore,_=d3.min(r,function(t){return d3.min(t.data,function(t){return+t.total-t.value})}),f=(n.widthOfNoMargin,n.heightOfMainGroup);n.yAxis.width,n.xAxis.height;_<0?(n.group.selectAll(".form-water-fall-histogram-chart .axis-x path").attr("transform","translate(0, "+-(c.range()[0]-c(0))+")"),n.group.selectAll(".form-water-fall-histogram-chart .axis-x line").attr("transform","translate(0, "+-(c.range()[0]-c(0))+")")):(n.group.selectAll(".form-water-fall-histogram-chart .axis-x path").attr("transform","translate(0,0)"),n.group.selectAll(".form-water-fall-histogram-chart .axis-x line").attr("transform","translate(0,0)")),o.data(u.domain()).isScalePoint(!1).bandWidth(u.step()).bandHeight(d).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];r.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:("$-0"==t.name?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),l.data(o).update(),s.translate(u(i),0),l.show()}).onMousemove(function(){l.move(),s.show()}).onMouseout(function(){l.hide(),s.hide()}),i.data(t).xScale(u).yScale(c).barCornerRadius(n._barCornerRadius).borderWidth(n._borderWidth).borderColor(n._borderColor).labelShow(n._labelShow).positionOptions(n._positionOptions).positionChoice(n._positionChoice).rectObj({xFunc:function(t,e){return u.step()*e+u.step()*(1-n._histogramWidth*a)/2},yFunc:function(t){return c(t.total)},widthFunc:function(){return u.step()*n._histogramWidth*a},heightFunc:function(t){return Math.abs(c(0)-c(t.value))}}).textObj({xFunc:function(t,e){return u.step()*e+u.step()*(1-n._histogramWidth*a)/2},yFunc:function(t){return c(t.total)},dxFunc:function(t,e){return u.step()*n._histogramWidth*a/2},dyFunc:function(t,e){return 0==n._positionOptions.indexOf(n._positionChoice)?.5*-n._textLabel.fontSize:1==n._positionOptions.indexOf(n._positionChoice)?c(0)-c(Math.abs(t.value))-.5*n._textLabel.fontSize:2==n._positionOptions.indexOf(n._positionChoice)?(c(0)-c(Math.abs(t.value)))/2+.4*n._textLabel.fontSize:void 0},colorFunc:function(){return n._textLabel.color},textFunc:function(t){return 0==t.value?"":t.value},fontSize:n._textLabel.fontSize,fontFamily:n._textLabel.fontFamily,labelShow:n._labelShow}).fillOpacity(n._fillOpacity),e.width(h).height(d).xTickLocations(n.xAxis.tickLocations.slice(1)).yTickLocations(n.yAxis.tickLocations).showX(n._gridShowX).showY(n._gridShowY).stroke(n._gridStroke).strokeDasharray(n._gridStrokeDasharray),s.width(u.step()).height(d).shadowColor("#ccc").hide(),n.coreGroup.attr("transform","translate("+n.yAxis.width+",0)");var p=n.group.selectAll(".form-waterfall-histogram-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(p).remove(),i.updateFormWaterfall(),s.update(),o.update();var y=n.yAxis.width;e.translate(y,0).update()}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=Cn;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._borderWidth=e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?e.borderColor:this._borderColor,this._fillOpacity=e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yRange||[],n=0<t.length?t[0].data.map(function(t){return t.name}):[0,1],i=0<t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total-t.value})}),0),t[0].data[0].value*this._yScaleHeight]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}}]),n}(),Fn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","simple-bar-plot"),e._xScale=null,e._yScale=null,e._fill=null,e._stroke="none",e._strokeWidth=0,e._showZeroLine=!0,e._zeroLineStroke="#000",e._fontColor="#000",e._fontSize=13,e._cornerRadius=0,e}return u(n,A),l(n,[{key:"update",value:function(){for(var e=this,t=e._data,n=e._xScale,i=e._yScale.clamp(!0),o=n.bandwidth()*e._barWidthPercent,a=i.domain(),r=a.every(function(t){return 0<=t})?"up":a.every(function(t){return t<=0})?"down":"both",l=i.range()[0],s=e._transition?e._duration:0,u=[],c=0;c<t.length;c++)u.push(t[c].value);var h=et(u,e._fontSize,e._fontFamily),_=e.group,f=_.selectAll(".rect").data(t);f.exit().remove();var p=f.enter().append("path").attr("class","rect").merge(f).style("fill",function(t){return e._fill||t.color}).style("stroke-width",e._strokeWidth).style("stroke",e._stroke||d.color).call(Ie,e),y=_.selectAll("text").data(t);y.exit().transition().duration(s).remove();var g=y.enter().append("text").attr("class","simple-bar-texts").merge(y).text(function(t){return t.value}).attr("fill",e._fontColor).attr("font-size",e._fontSize).style("font-family",e._fontFamily).style("display",e._labelShow?"block":"none");if("up"===r)p.attr("d",function(t){return tt({x:n(t.name)+o*(1-e._barWidthPercent),y:i(t.value),width:o,height:Math.abs(l-i(t.value)),cornerRadius:e._cornerRadius})}),g.attr("x",function(t){return n(t.name)+o*(1-e._barWidthPercent)}).attr("y",function(t){return i(t.value)}).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?Math.abs(l-i(t.value))-6:void 0}).attr("text-anchor","middle"),null==e._positionOptions||null==e._positionChoice?g.style("display","none"):o<h&&1==e._positionOptions.indexOf(e._positionChoice)?g.attr("transform",function(t){return"rotate(-90 "+(n(t.name)+o)+" "+(i(t.value)+Math.abs(l-i(t.value))-.5*e._fontSize-4)+" )"}).attr("text-anchor","start"):g.attr("transform","rotate(0)");else if("down"===r)p.attr("d",function(t){return tt({x:n(t.name)+o*(1-e._barWidthPercent),y:0,width:o,height:i(t.value),cornerRadius:e._cornerRadius})}),g.attr("x",function(t){return n(t.name)+o*(1-e._barWidthPercent)}).attr("y",0).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?i(t.value)-6:void 0}).attr("text-anchor","middle"),null==e._positionOptions||null==e._positionChoice?g.style("display","none"):o<h&&1==e._positionOptions.indexOf(e._positionChoice)?g.attr("transform",function(t){return"rotate(-90 "+(n(t.name)+o||0)+" "+(i(t.value)-.5*e._fontSize-4)+" )"}).attr("text-anchor","start"):g.attr("transform","rotate(0)");else{var v=Math.round(i(0));p.attr("d",function(t){return tt({x:n(t.name)+o*(1-e._barWidthPercent),y:0<=t.value?i(t.value):v,width:o,height:Math.abs(v-i(t.value)),cornerRadius:e._cornerRadius})}),g.attr("x",function(t){return n(t.name)+o*(1-e._barWidthPercent)}).attr("y",function(t){return 0<=t.value?i(t.value):v}).attr("dx",o/2).attr("dy",function(t){return null==e._positionOptions||null==e._positionChoice?0:0==e._positionOptions.indexOf(e._positionChoice)?-6:1==e._positionOptions.indexOf(e._positionChoice)?Math.abs(v-i(t.value))-6:void 0}).attr("text-anchor","middle"),null==e._positionOptions||null==e._positionChoice?g.style("display","none"):o<h&&1==e._positionOptions.indexOf(e._positionChoice)?g.attr("transform",function(t){return"rotate(-90 "+(n(t.name)+o||0)+" "+((0<=t.value?i(t.value):v)+Math.abs(v-i(t.value))-.5*e._fontSize-4)+" )"}).attr("text-anchor","start"):g.attr("transform","rotate(0)"),(_.select(".zero-line").empty()?_.append("line").attr("class","zero-line"):_.select(".zero-line")).attr("x1",n.range()[0]).attr("y1",v).attr("x2",n.range()[1]).attr("y2",v).style("stroke",e._showZeroLine?e._zeroLineStroke:"none")}if(null==e._positionOptions||null==e._positionChoice)g.style("display","none");else if(o<h&&1==e._positionOptions.indexOf(e._positionChoice)){for(var x=_.selectAll(".simple-bar-texts"),m=[],k=[],b=0;b<x._groups[0].length;b++){k.push(b);for(var S=b+1;S<x._groups[0].length;S++){var w=at(d3.select(x._groups[0][b])),O=at(d3.select(x._groups[0][S])),C=w.width;w.width=w.height,w.height=C;var A=O.width;O.width=O.height,O.height=A,rt(w,O)&&(m.push(b),d3.select(x._groups[0][b]).style("opacity","0"))}}for(var F=new Set(m),L=Array.from(F),M=$(L,k),z=0;z<L.length;z++){for(var R=[],T=0;T<M.length;T++){var P=at(d3.select(x._groups[0][L[z]])),W=at(d3.select(x._groups[0][M[T]])),D=P.width;P.width=P.height,P.height=D;var j=W.width;if(W.width=W.height,W.height=j,R.push(rt(P,W)),rt(P,W)){if(L[z]==M[T])continue;d3.select(x._groups[0][L[z]]).style("opacity","0")}}0==R.filter(function(t){return 1==t}).length&&M.push(L[z])}for(var N=0;N<M.length;N++)d3.select(x._groups[0][M[N]]).style("opacity","1")}else{for(var G=_.selectAll(".simple-bar-texts"),B=[],E=[],H=0;H<G._groups[0].length;H++){E.push(H);for(var V=H+1;V<G._groups[0].length;V++){rt(at(d3.select(G._groups[0][H])),at(d3.select(G._groups[0][V])))&&(B.push(H),d3.select(G._groups[0][H]).style("opacity","0"))}}for(var I=new Set(B),Y=Array.from(I),X=$(Y,E),Z=0;Z<Y.length;Z++){for(var Q=[],q=0;q<X.length;q++){var U=at(d3.select(G._groups[0][Y[Z]])),J=at(d3.select(G._groups[0][X[q]]));if(Q.push(rt(U,J)),rt(U,J)){if(Y[Z]==X[q])continue;d3.select(G._groups[0][Y[Z]]).style("opacity","0")}}0==Q.filter(function(t){return 1==t}).length&&X.push(Y[Z])}for(var K=0;K<X.length;K++)d3.select(G._groups[0][X[K]]).style("opacity","1")}function $(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}return e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}}]),n}(),Ln=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","simple-bar-chart"),e.grid=new Ct(e.coreGroup),e.core=new Fn(e.coreGroup),e.clipArea=new bt(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xTickShow=!0,e._yTickShow=!0,e._barWidthPercent=.5,e._cornerRadius=0,e._stroke="none",e._strokeWidth=0,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var t=this,e=t.activeData,n=t.grid,i=t.core,o=t.tooltip,a=t.clipArea,r=t.widthOfCore,l=t.heightOfCore;n.width(r).height(l).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(e).xScale(t.xScale).yScale(t.yScale).zeroLineStroke(t._axisLineStroke).cornerRadius(t._cornerRadius).stroke(t._stroke).barWidthPercent(t._barWidthPercent).strokeWidth(t._strokeWidth).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).textObj({colorFunc:function(){return t._fontColor}}).onMouseover(function(t,e){d3.select(this).style("stroke","#000").style("stroke-width",1);var n=[{text:""+(t.name=="$-"+e?"":t.name),color:t.color},{text:t.valueLabel+": "+t.value}];o.data(n).update().show()}).onMousemove(function(){o.move()}).onMouseout(function(){o.hide(),d3.select(this).style("stroke",i.stroke()).style("stroke-width",0)}),t.coreGroup.call(H,t.yAxis.width+.5,0),0!=t._clipShow.length?(a.width(r).height(l).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+a.id+")")):(a.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","")),a.update();var s=t.group.selectAll(".simple-bar-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="$-"+e});d3.selectAll(s).remove(),n.update(),i.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yRange||[]).slice().sort(d3.ascending),n=t.length?t.map(function(t){return t.name}):[0,1],i=void 0;if(t.length){var o=d3.min(t,function(t){return+t.value}),a=1.1*d3.max(t,function(t){return+t.value});i=o<0?a<=0?[o,0]:[o,a]:[0,a]}else i=[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?isNaN(parseFloat(e[0]))?i[1]:i[1]<e[0]?1.5*e[0]:i[1]:parseFloat(e[1])]}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&this.barWidthPercent(o(e.barWidthPercent?e.barWidthPercent:this._barWidthPercent)).cornerRadius(o(e.barCornerRadius?e.barCornerRadius:this._cornerRadius)).stroke(e.borderColor||this._stroke).strokeWidth(o(e.borderWidth?e.borderWidth:this._strokeWidth)),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}}]),n}(),Mn=function(t){function e(t){return r(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return u(e,F),l(e,[{key:"update",value:function(){var t=this,e=(t._data,t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(t._cornerRadius).startAngle(t._startAngle).endAngle(t._endAngle));t.pieFunc.value(function(t){return+t.value}).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod);var n=t.pieFunc(t._data),i=t.group.selectAll("path").data(n,function(t){return t.data.key});i.exit().remove();i.merge(i.enter().append("path")).attr("d",e).style("stroke",t._stroke).style("stroke-width",t._strokeWidth).style("fill",function(t){return t.data.color_special});return t}}]),e}();function zn(t,e){var n=0,i=1;if(e.forEach(function(t){"objCol"===t.function?n=t.index:"vCol"===t.function&&(i=t.index)}),P(t,[n,i])||!x(t,i))return[];var o=[],a=t[0][n],r=t[0][i],l=t.slice(1,2),s=parseFloat(l[0][i]);return s=10<s||10==s?(s/Math.pow(10,String(parseInt(s)).length)).toFixed(3):s<10&&1<s?(s/Math.pow(10,String(parseInt(s)).length+1)).toFixed(3):s.toFixed(3),isNaN(s)||o.push({name:l[0][n],value:+s,nameLabel:a,valueLabel:r}),o.forEach(function(t,e){t.key=T(t.name)+"-"+e}),o}var Rn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","Progress-Round-pie-chart"),e.pieBg=new Mn(e.mainGroup),e.core=e.pie=new F(e.mainGroup),e._innerRadius=0,e._padAngle=0,e._startAngle=0,e._endAngle=2*Math.PI,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=0,e._areaBorderWidth=0,e._areaBorderColor=null,e._numberShow=!0,e._nFontSize=35,e._nFontFamily="noto",e._nColor="0",e._textShow=!0,e._tFontSize=25,e._tFontFamily="noto",e._tColor="1",e}return u(n,O),l(n,[{key:"updateCore",value:function(){var a=this,t=a.pieBg,r=a.pie,e=a.widthOfNoMargin,n=.88*e,i=.88*a.heightOfMainGroup,o=a._startAngle,l=a._endAngle,s=M(n,i,o,l),u=s.radius,c=a._innerRadius||(a._innerRadiusRatio?a._innerRadiusRatio*u:.75*u),h=s.cx+(e-n)/2,d=s.cy+.06*a.heightOfMainGroup;t.data(a.activeData).innerRadius(c).outerRadius(u).cornerRadius(a._cornerRadius).startAngle(o).endAngle(-l*(1-(0<a.activeData.length?a.activeData[0].value:1))),a.pieBg.translate(h,d).update(),r.data(a.activeData).innerRadius(c).outerRadius(u).cornerRadius(a._cornerRadius).startAngle(o).endAngle(l*(0<a.activeData.length?a.activeData[0].value:0)).areaBorderColor(a._areaBorderColor).areaBorderWidth(a._areaBorderWidth).transition(a._transition).duration(a._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode);if(n.selectAll("text").remove(),1==r.data().length){var i=n.append("text").attr("class","middleNumber").attr("dy","-5px").style("text-anchor","middle").text((-1==String(100*t.data.value).indexOf(".")?100*t.data.value:(100*t.data.value).toFixed(1))+"% ").style("pointer-events","none").style("fill",isNaN(parseFloat(a._nColor))?a._nColor:a._colorList[a._nColor]).attr("font-size",a._nFontSize).attr("font-family",a._nFontFamily),o=n.append("text").attr("class","middleText").attr("dy","1em").style("text-anchor","middle").text(t.data.name+" ").style("pointer-events","none").style("fill",isNaN(parseFloat(a._tColor))?a._tColor:a._colorList[a._tColor]).attr("font-size",a._tFontSize).attr("font-family",a._tFontFamily);1==a._textShow&&0==a._numberShow?o.attr("dy","0.5em"):0==a._textShow&&1==a._numberShow&&i.attr("dy","0.5em"),1==a._textShow&&0<a.activeData.length?a.group.selectAll(".middleText").style("display","block"):a.group.selectAll(".middleText").style("display","none"),null!=a._textShow&&0!=a._textShow&&null!=a._tFontSize&&null!=a._tColor&&null!=a._tFontFamily&&0!=a.activeData.length||a.group.selectAll(".middleText").style("display","none"),1==a._numberShow&&0<a.activeData.length?a.group.selectAll(".middleNumber").style("display","block"):a.group.selectAll(".middleNumber").style("display","none"),null!=a._numberShow&&0!=a._numberShow&&null!=a._nFontSize&&null!=a._nColor&&null!=a._nFontFamily&&0!=a.activeData.length||a.group.selectAll(".middleNumber").style("display","none")}}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(u,1.05*u);return function(t){var e=n(t);return r.arcFunc.outerRadius(e),r.arcFunc(i)}});var e=[{text:i.data.name+": "+100*i.data.value+"%",color:i.data.color}];a.tooltip.data(e).update().show()}).onMousemove(function(){a.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*u,u);return function(t){var e=n(t);return r.arcFunc.outerRadius(e),r.arcFunc(i)}}),a.tooltip.hide()}),0==a.activeData.length&&(a.group.selectAll(".middleText").style("display","none"),a.group.selectAll(".middleNumber").style("display","none")),a.pie.translate(h,d).update()}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=zn;switch(n.dataType){case"cross-table":i=_;break;default:i=zn}return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._innerRadiusRatio=e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio,this._cornerRadius=e.cornerRadius?e.cornerRadius:this._cornerRadius,this._areaBorderWidth=e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth,this._areaBorderColor=e.areaBorderColor?e.areaBorderColor:this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(null!=n.numberLabel&&(this._numberShow=n.numberLabel?n.numberLabel.show:this._numberShow,this._nFontSize=n.numberLabel.fontSize?n.numberLabel.fontSize:this._nFontSize,this._nFontFamily=n.numberLabel.fontFamily?n.numberLabel.fontFamily:this._nFontFamily,this._nColor=n.numberLabel.color||0==n.numberLabel.color?n.numberLabel.color:this._nColor),null!=n.textLabel&&(this._textShow=n.textLabel?n.textLabel.show:this._textShow,this._tFontSize=n.textLabel.fontSize?n.textLabel.fontSize:this._tFontSize,this._tFontFamily=n.textLabel.fontFamily?n.textLabel.fontFamily:this._tFontFamily,this._tColor=n.textLabel.color||0==n.textLabel.color?n.textLabel.color:this._tColor))}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),n}(),Tn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","Half-Progress-pie-chart"),e.pieBg=new Mn(e.mainGroup),e.core=e.pie=new F(e.mainGroup),e._innerRadius=0,e._startAngle=-Math.PI/2,e._endAngle=Math.PI,e._padAngle=0,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=0,e._areaBorderWidth=0,e._areaBorderColor=null,e._numberShow=!0,e._nFontSize=35,e._nFontFamily="noto",e._nColor="0",e._textShow=!0,e._tFontSize=25,e._tFontFamily="noto",e._tColor="1",e}return u(n,O),l(n,[{key:"updateCore",value:function(){var o=this,t=o.pieBg,a=o.pie,e=o.widthOfNoMargin,n=.88*e,i=o.heightOfMainGroup,r=o._startAngle,l=o._endAngle,s=function(t,e,n,i){var o=Math.min(t,e),a=o/2,r=e/2+a/2;o==e&&(r=1.1*(a=.88*e),t/2<a&&(r=e/2+(a=t/2)/2));return{radius:a,cx:t/2,cy:r,quadrant:0}}(n,i),u=s.radius,c=o._innerRadius||(o._innerRadiusRatio?o._innerRadiusRatio*u:.75*u),h=s.cx+(e-n)/2,d=s.cy;t.data(o.activeData).innerRadius(c).outerRadius(u).cornerRadius(o._cornerRadius).startAngle(r+l*(0<o.activeData.length?o.activeData[0].value:0)).endAngle(l/2),a.data(o.activeData).innerRadius(c).outerRadius(u).cornerRadius(o._cornerRadius).startAngle(r).endAngle(r+l*(0<o.activeData.length?o.activeData[0].value:0)).areaBorderColor(o._areaBorderColor).areaBorderWidth(o._areaBorderWidth).transition(o._transition).duration(o._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode);if(n.selectAll("text").remove(),1==a.data().length){var i=n.append("text").attr("class","middleNumber").attr("dy","-"+(parseFloat(o._tFontSize)+5)).style("text-anchor","middle").text((-1==String(100*t.data.value).indexOf(".")?100*t.data.value:(100*t.data.value).toFixed(1))+"% ").style("pointer-events","none").style("fill",isNaN(parseFloat(o._nColor))?o._nColor:o._colorList[o._nColor]).attr("font-size",o._nFontSize).attr("font-family",o._nFontFamily);n.append("text").attr("class","middleText").attr("dy","-0.1em").style("text-anchor","middle").text(t.data.name+" ").style("pointer-events","none").style("fill",isNaN(parseFloat(o._tColor))?o._tColor:o._colorList[o._tColor]).attr("font-size",o._tFontSize).attr("font-family",o._tFontFamily);1==o._textShow&&0==o._numberShow||0==o._textShow&&1==o._numberShow&&i.attr("dy","-0.1em"),1==o._textShow&&0<o.activeData.length?o.group.selectAll(".middleText").style("display","block"):o.group.selectAll(".middleText").style("display","none"),null!=o._textShow&&0!=o._textShow&&null!=o._tFontSize&&null!=o._tColor&&null!=o._tFontFamily||o.group.selectAll(".middleText").style("display","none"),1==o._numberShow&&0<o.activeData.length?o.group.selectAll(".middleNumber").style("display","block"):o.group.selectAll(".middleNumber").style("display","none"),null!=o._numberShow&&0!=o._numberShow&&null!=o._nFontSize&&null!=o._nColor&&null!=o._nFontFamily||o.group.selectAll(".middleNumber").style("display","none")}}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(u,1.05*u);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}});var e=[{text:i.data.name+": "+100*i.data.value+"%",color:i.data.color}];o.tooltip.data(e).update().show()}).onMousemove(function(){o.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*u,u);return function(t){var e=n(t);return a.arcFunc.outerRadius(e),a.arcFunc(i)}}),o.tooltip.hide()}),0==o.activeData.length&&(o.group.selectAll(".middleText").style("display","none"),o.group.selectAll(".middleNumber").style("display","none")),o.pie.translate(h,d).update(),o.pieBg.translate(h,d).update()}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=zn;switch(n.dataType){case"cross-table":i=_;break;default:i=zn}return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._innerRadiusRatio=e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio,this._cornerRadius=e.cornerRadius?e.cornerRadius:this._cornerRadius,this._areaBorderWidth=e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth,this._areaBorderColor=e.areaBorderColor?e.areaBorderColor:this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(null!=n.numberLabel&&(this._numberShow=n.numberLabel?n.numberLabel.show:this._numberShow,this._nFontSize=n.numberLabel.fontSize?n.numberLabel.fontSize:this._nFontSize,this._nFontFamily=n.numberLabel.fontFamily?n.numberLabel.fontFamily:this._nFontFamily,this._nColor=n.numberLabel.color||0==n.numberLabel.color?n.numberLabel.color:this._nColor),null!=n.textLabel&&(this._textShow=n.textLabel?n.textLabel.show:_textShow,this._tFontSize=n.textLabel.fontSize?n.textLabel.fontSize:_tFontSize,this._tFontFamily=n.textLabel.fontFamily?n.textLabel.fontFamily:_tFontFamily,this._tColor=n.textLabel.color||0==n.textLabel.color?n.textLabel.color:this._tColor))}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),n}(),Pn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","half-pie-chart"),e.core=e.pie=new F(e.mainGroup),e.lineText=new R(e.mainGroup),e._innerRadius=0,e._startAngle=-Math.PI/2,e._endAngle=Math.PI/2,e._padAngle=0,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=0,e._areaBorderWidth=0,e._areaBorderColor=null,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){for(var r=this,o=r.pie,t=r.lineText,e=r.widthOfNoMargin,n=[],i=0;i<r.activeData.length;i++)n.push(r.activeData[i].name);var a=.74*e-et(n,r._fontSize,r._fontFamily);null==r._labelShow||null==r._positionOptions||null==r._positionChoice||null==r._contentOption||null==r._contentChoice?a=.88*e:0!=r._labelShow&&1!=r._positionOptions.indexOf(r._positionChoice)&&-1!=r._positionOptions.indexOf(r._positionChoice)||(a=.88*e);var l=r.heightOfMainGroup,s=r._startAngle,u=r._endAngle,c=function(t,e,n,i){var o=Math.min(t,e),a=o/2,r=e/2+a/2;o==e&&(r=1.1*(a=.88*e),t/2<a&&(r=e/2+(a=t/2)/2));return{radius:a,cx:t/2,cy:r,quadrant:0}}(a,l),h=c.radius,d=r._innerRadius||(r._innerRadiusRatio?r._innerRadiusRatio*h:.75*h);for(var _=[],f=0;f<r.activeData.length;f++)_.push(r.activeData[f].value);for(var p=0,y=0;y<r.activeData.length;y++)p+=r.activeData[y].value;for(var g=0;g<r.activeData.length;g++)r.activeData[g].percent=(r.activeData[g].value/p*100).toFixed(1);o.data(r.activeData).innerRadius(d).outerRadius(h).cornerRadius(r._cornerRadius).startAngle(s).endAngle(u).areaBorderColor(r._areaBorderColor).areaBorderWidth(r._areaBorderWidth).transition(r._transition).duration(r._duration).onTransitionEnd(function(t,e){var n=d3.select(this.parentNode),i="arc-path-"+t.data.key.replace(/\s*/g,"").replace(/\./g,"")+"-"+r.id;r.defs.select("#"+i).remove();var o=L((d+h)*r._labelRadiusRatio,t.startAngle+.025,t.endAngle-.025),a=r.defs.select("#"+i).empty()?r.defs.append("path").attr("d",o).attr("id",i):r.defs.select("#"+i).attr("d",o);null==r._labelShow||null==r._positionOptions||null==r._positionChoice||null==r._contentOption||null==r._contentChoice?r.group.selectAll(".chart-label-text").style("display","none"):0==r._labelShow?r.group.selectAll(".chart-label-text").style("display","none"):1==r._positionOptions.indexOf(r._positionChoice)&&(1==r._contentChoice.length?0==r._contentOption.indexOf(r._contentChoice[0])?z(n,a,t.data.name=="$-"+e?"":t.data.name,r._textLabel.fontSize,r._textLabel.fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("dx",0):1==r._contentOption.indexOf(r._contentChoice[0])?z(n,a,t.data.percent+"%",r._textLabel.fontSize,r._textLabel.fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("dx",0):2==r._contentOption.indexOf(r._contentChoice[0])&&z(n,a,t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("dx",0):2==r._contentChoice.length?0==r._contentOption.indexOf(r._contentChoice[0])&&1==r._contentOption.indexOf(r._contentChoice[1])||1==r._contentOption.indexOf(r._contentChoice[0])&&0==r._contentOption.indexOf(r._contentChoice[1])?z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%",r._textLabel.fontSize,r._textLabel.fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==r._contentOption.indexOf(r._contentChoice[0])&&2==r._contentOption.indexOf(r._contentChoice[1])||2==r._contentOption.indexOf(r._contentChoice[0])&&0==r._contentOption.indexOf(r._contentChoice[1])?z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==r._contentOption.indexOf(r._contentChoice[0])&&2==r._contentOption.indexOf(r._contentChoice[1])||2==r._contentOption.indexOf(r._contentChoice[0])&&1==r._contentOption.indexOf(r._contentChoice[1]))&&z(n,a,t.data.percent+"%  "+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==r._contentChoice.length&&z(n,a,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%  "+t.data.value,r._textLabel.fontSize,r._textLabel.fontFamily).attr("class",r.labelTextClass).style("pointer-events","none").style("fill",r._textLabel.color).style("font-size",r._textLabel.fontSize).style("font-family",r._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"))}).onMouseover(function(i,t){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(h,1.05*h);return function(t){var e=n(t);return o.arcFunc.outerRadius(e),o.arcFunc(i)}});var e=[{text:""+(i.data.name=="$-"+t?"":i.data.name),color:i.data.color},{text:i.data.valueLabel+": "+i.data.value}];r.tooltip.data(e).update().show()}).onMousemove(function(){r.tooltip.move()}).onMouseout(function(i){d3.select(this).transition().duration(30).attrTween("d",function(){var n=d3.interpolateNumber(1.05*h,h);return function(t){var e=n(t);return o.arcFunc.outerRadius(e),o.arcFunc(i)}}),r.tooltip.hide()});var v=c.cx+(e-a)/2,x=c.cy;null!=r._labelShow&&(0!=r._labelShow&&0==r._positionOptions.indexOf(r._positionChoice)?(t.data(r.activeData).innerRadius(d).outerRadius(h).cornerRadius(r._cornerRadius).startAngle(s).endAngle(u).fontSize(r._textLabel.fontSize).fontColor(r._textLabel.color).fontFamily(r._textLabel.fontFamily).labelShow(r._labelShow).positionOptions(r._positionOptions).positionChoice(r._positionChoice).contentOption(r._contentOption).contentChoice(r._contentChoice).values(_).areaType("half").transition(r._transition).duration(r._duration),r.group.select(".outside-text-polygon").attr("display","block")):r.group.select(".outside-text-polygon").attr("display","none")),r.lineText.translate(v||0,x).update(),r.pie.translate(v||0,x).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(e.innerRadiusRatio).cornerRadius(e.cornerRadius).areaBorderWidth(e.areaBorderWidth).areaBorderColor(e.areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._contentChoice=n.contentChoice?n.contentChoice:this._contentChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}}]),n}(),Wn=function(t){function a(t){r(this,a);var e=c(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.xAxis=null,e.yAxis=null,e.yAxisDoubleY=null,e.xScale=null,e.yScale=null,e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yOrientRight="right",e._xDomain=null,e._yDomain=null,e._xTitle="",e._yTitle="",e._axisLineStroke=null,e._xTickShow=!0,e._yTickShow=!0,e._gapPadding=20,e._titlePadding=20,e}return u(a,q),l(a,[{key:"update",value:function(){return this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this.updateTitle(),this.updateAxis(),this.updateCore(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();t.xAxis;var e=t.yAxis,n=t.yAxisDoubleY,i=t.xScale,o=t.yScale,a=(t._xType,t._yType),r=(t._xOrient,t._yOrient),l=t._yOrientRight,s=t._fontSize,u=t.widthOfNoMargin,c=t.heightOfMainGroup;i.domain(t._xDomain),o.domain(t._yDomain),e.scaleFunc(o).allowedMaxTextWidth(.5*u).type(a).orient(r).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(s).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),n.scaleFunc(o).allowedMaxTextWidth(.5*u).type(a).orient(l).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(s).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var h=(null==t._yTitle[0]?0:e.titleHeight)||(null==t._yTitle[1]?0:n.titleHeight),d=c/(3*s);e.tickCount(d),n.tickCount(d),o.nice().range([c-h,0]);e.width;var _=e.width,f=h;e.translate(_,f).update(),n.translate(_,f).update()}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yDomain||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"yOrientRight",value:function(t){return arguments.length?(this._yOrientRight=t,this):this._yOrientRight}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"axisLabelShowLeft",value:function(t){return arguments.length?(this._axisLabelShowLeft=t,this):this._axisLabelShowLeft}},{key:"axisLabelShowRight",value:function(t){return arguments.length?(this._axisLabelShowRight=t,this):this._axisLabelShowRight}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"setPublicOption",value:function(t){s(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.x||{},i=e.y||{},o=e.y1||{};this.axisLineStroke(e.color).xTitle(n.name).axisLabelShowLeft(i.labelShow).axisLabelShowRight(o.labelShow).xDomain(n.range).yDomain(i.range)}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return 0<e?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.yAxis||this.yAxisDoubleY?this.yAxis.titleHeight||this.yAxisDoubleY.titleHeight:0,n=this.heightOfMainGroup-t-e;return 0<n?n:0}}]),a}(),Dn="axis-group",jn="y-slope-title",Nn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-slope"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return u(n,ht),l(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,a=t._tickValueTexts,r=void 0;r=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),r.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+Dn).empty()?i.append("g").attr("class",Dn):i.select("."+Dn);s.transition().duration(t._transition?t._duration:0).call(r).on("start",function(){s.selectAll(".tick text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return a[e]}),s.selectAll(".tick line").style("stroke",t._lineStroke),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")});var u=Math.abs(n.range()[0]-n.range()[1]);if(t._title="left"==e?t._title[0]:"right"==e?t._title[1]:t._title,t._titleShow&&t._title){var c=i.select("."+jn).empty()?i.append("g").attr("class",jn):i.select("."+jn),h=c.select("text").empty()?c.append("text"):c.select("text"),d=V(t._title,o,t._fontFamily);h.attr("x",d>=2*t.width?-d/2:0).attr("y",u+this._fontSize+4).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",d>=2*t.width?"start":"middle").text(t._title)}else i.select("."+jn).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,a=e._type,r=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===a?o.domain():o.ticks(e._tickCount);var s=d3.max(t,function(t){return V(t,r,e._fontFamily)});return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,r,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,console.log(e),e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),n}(),Gn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","slope"),e._xScale=null,e._yScale=null,e._sWidth=null,e._stroke=null,e._lineWidth=2,e._strokeDasharry="",e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group;n.selectAll(".slope-lines").remove();var i=n.selectAll("line").data(t);i.exit().remove(),i.enter().append("line").attr("class","slope-lines").merge(i).style("fill","none").style("stroke",function(t){return e._stroke||t.color||"#000"}).style("stroke-width",e._lineWidth).style("stroke-dasharray",e._strokeDasharry).style("display","block").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(e._transition?e._duration:0).attr("x1",e._textLength).attr("y1",function(t){return t.data.length&&1==t.data[0].index?e._yScale(t.data[0].value):0}).attr("x2",e._sWidth).attr("y2",function(t){return 1<t.data.length?e._yScale(t.data[1].value):1==t.data.length&&2==t.data[0].index?e._yScale(t.data[0].value):0});for(var o=n.selectAll(".slope-lines").nodes(),a=0;a<o.length;a++)0==o[a].__data__.data.length?d3.select(o[a]).style("display","none"):1==o[a].__data__.data.length?o[a].__data__.data[0].tooltipValueShow||d3.select(o[a]).style("display","none"):2==o[a].__data__.data.length&&(o[a].__data__.data[0].tooltipValueShow&&o[a].__data__.data[1].tooltipValueShow||d3.select(o[a]).style("display","none"));return e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}}]),n}(),Bn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","slope-scatter-plot"),e._xScale=null,e._yScale=null,e._sWidth=null,e._circleRadius=2,e._circleBorderWidth=1,e._circleBorderColor="#000",e._fill=null,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var o=this,t=o.group,a=o._data,r=(o._xScale,o._yScale);t.selectAll(".slope-circles").remove(),t.selectAll(".slopeTexts text").remove(),t.selectAll(".slopeNumbers text").remove();var e=t.selectAll("g").data(a);e.exit().remove(),e.enter().append("g").merge(e).each(function(t,e){var n=d3.select(this).selectAll("circle").data(t.data);n.exit().remove(),n.enter().append("circle").attr("class","slope-circles").merge(n).style("fill",o._fill||t.color).style("stroke",o._circleBorderColor||t.color).style("stroke-width",o._circleBorderWidth).attr("r",o._circleRadius).attr("cx",function(t){return 1==t.index?o._textLength:2==t.index?o._sWidth:void 0}).attr("cy",function(t){return r(t.value)||0})});var n=t.append("g").selectAll("g").data(a);n.exit().remove(),n.enter().append("g").attr("class","slope-text-groups").merge(n).each(function(t,e){var n=d3.select(this).append("g").attr("class","slopeNumbers").selectAll("text").data(t.data);n.exit().remove(),n.enter().append("text").merge(n).text(function(t){return t.value}).style("text-anchor",function(t){return 1==t.index?"end":2==t.index?"start":void 0}).attr("fill",o._fontColor).attr("font-size",o._fontSize).style("font-family",o._fontFamily).style("display","block").attr("x",function(t){return 1==t.index?o._textLength:2==t.index?o._sWidth:void 0}).attr("y",function(t){return r(t.value)||0}).attr("dx",function(t){return 1==t.index?"-0.5em":2==t.index?V(a[e].name,o._fontSize,o._fontFamily)+o._fontSize:void 0}).attr("dy","0.3em");var i=d3.select(this).append("g").attr("class","slopeTexts").selectAll("text").data(t.data);i.exit().remove(),i.enter().append("text").merge(i).text(a[e].name).style("text-anchor",function(t){return 1==t.index?"end":2==t.index?"start":void 0}).attr("fill",o._fontColor).attr("font-size",o._fontSize).style("font-family",o._fontFamily).style("display","block").attr("x",function(t){return 1==t.index?o._textLength:2==t.index?o._sWidth:void 0}).attr("y",function(t){return r(t.value)||0}).attr("dx",function(t){return 1==t.index?-(V(a[e].data[0].value,o._fontSize,o._fontFamily)+o._fontSize):2==t.index?"0.5em":void 0}).attr("dy","0.3em")});var i=t.selectAll(".slopeTexts text").nodes().filter(function(t,e,n){return e%2==0}),l=t.selectAll(".slopeTexts text").nodes().filter(function(t,e){return e%2!=0}),s=t.selectAll(".slopeNumbers text").nodes().filter(function(t,e,n){return e%2==0}),u=t.selectAll(".slopeNumbers text").nodes().filter(function(t,e){return e%2!=0});null!=o._axisLabelShowLeft&&null!=o._axisLabelShowRight||(d3.selectAll(s).attr("fill","none"),d3.selectAll(u).attr("fill","none")),null==o._labelShow||null==o._positionOptions||null==o._positionChoice?(d3.selectAll(i).attr("fill","none"),d3.selectAll(l).attr("fill","none"),d3.selectAll(u).attr("dx","0.5em"),d3.selectAll(s).attr("dx","-0.5em")):0==o._labelShow?(d3.selectAll(i).attr("fill","none"),d3.selectAll(l).attr("fill","none"),d3.selectAll(u).attr("dx","0.5em"),d3.selectAll(s).attr("dx","-0.5em")):0==o._positionOptions.indexOf(o._positionChoice)?(d3.selectAll(l).attr("fill","none"),d3.selectAll(u).attr("dx","0.5em"),(0==o._axisLabelShowLeft&&1==o._axisLabelShowRight||0==o._axisLabelShowLeft&&0==o._axisLabelShowRight)&&d3.selectAll(i).attr("dx","-0.5em")):1==o._positionOptions.indexOf(o._positionChoice)?(d3.selectAll(i).attr("fill","none"),d3.selectAll(s).attr("dx","-0.5em")):2==o._positionOptions.indexOf(o._positionChoice)&&(0==o._axisLabelShowLeft&&1==o._axisLabelShowRight||0==o._axisLabelShowLeft&&0==o._axisLabelShowRight)&&d3.selectAll(i).attr("dx","-0.5em"),0==o._axisLabelShowLeft&&d3.selectAll(s).attr("fill","none"),0==o._axisLabelShowRight&&d3.selectAll(u).attr("fill","none");var c=t.selectAll(".slope-circles").nodes(),h=t.selectAll(".slopeTexts text").nodes(),p=t.selectAll(".slopeNumbers text").nodes(),d=h.concat(p);d3.selectAll(d);!function(t){for(var e=t,n=[],i=[],o=0;o<e._groups[0].length;o++){i.push(o);for(var a=o+1;a<e._groups[0].length;a++)rt(at(d3.select(e._groups[0][o])),at(d3.select(e._groups[0][a])))&&(n.push(o),d3.select(e._groups[0][o]).style("opacity","0"),d3.select(p[o]).style("opacity","0"))}for(var r=new Set(n),l=Array.from(r),s=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(l,i),u=0;u<l.length;u++){for(var c=[],h=0;h<s.length;h++){var d=at(d3.select(e._groups[0][l[u]])),_=at(d3.select(e._groups[0][s[h]]));if(c.push(rt(d,_)),rt(d,_)){if(l[u]==s[h])continue;d3.select(e._groups[0][l[u]]).style("opacity","0"),d3.select(p[l[u]]).style("opacity","0")}}0==c.filter(function(t){return 1==t}).length&&s.push(l[u])}for(var f=0;f<s.length;f++)d3.select(e._groups[0][s[f]]).style("opacity","1"),d3.select(p[s[f]]).style("opacity","1")}(d3.selectAll(h));for(var _=0;_<c.length;_++)c[_].__data__.tooltipValueShow||d3.select(c[_]).style("opacity","0");for(var f=0;f<h.length;f++)h[f].__data__.tooltipValueShow||d3.select(h[f]).style("opacity","0");for(var y=0;y<p.length;y++)p[y].__data__.tooltipValueShow||d3.select(p[y]).style("opacity","0");return o}},{key:"circleRadius",value:function(t){return arguments.length?(this._circleRadius=t,this):this._circleRadius}},{key:"circleBorderWidth",value:function(t){return arguments.length?(this._circleBorderWidth=t,this):this._circleBorderWidth}},{key:"circleBorderColor",value:function(t){return arguments.length?(this._circleBorderColor=t,this):this._circleBorderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"axisLabelShowLeft",value:function(t){return arguments.length?(this._axisLabelShowLeft=t,this):this._axisLabelShowLeft}},{key:"axisLabelShowRight",value:function(t){return arguments.length?(this._axisLabelShowRight=t,this):this._axisLabelShowRight}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"numberLength",value:function(t){return arguments.length?(this._numberLength=t,this):this._numberLength}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}}]),n}(),En=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","slopeOverlay-polygon"),e._width=0,e._height=0,e._shadowColor="#000",e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e.group,i=n.selectAll("polygon").data(t);i.exit().remove(),i.enter().append("polygon").attr("class","slope-polygons").merge(i).style("fill",e._shadowColor).style("fill-opacity",.85).style("opacity",0).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(e._transition?e._duration:0).attr("points",function(t){return e._textLength+","+((0<t.data.length?e._yScale(t.data[0].value):0)+.012*e._sHeight)+"\n        "+e._sWidth+","+((1<t.data.length?e._yScale(t.data[1].value):0)+.012*e._sHeight)+" \n        "+e._sWidth+","+((1<t.data.length?e._yScale(t.data[1].value):0)-.012*e._sHeight)+" \n        "+e._textLength+","+((0<t.data.length?e._yScale(t.data[0].value):0)-.012*e._sHeight)});for(var o=n.selectAll(".slope-polygons").nodes(),a=0;a<o.length;a++)0==o[a].__data__.data.length?d3.select(o[a]).style("display","none"):1==o[a].__data__.data.length?o[a].__data__.data[0].tooltipValueShow||d3.select(o[a]).style("display","none"):2==o[a].__data__.data.length&&(o[a].__data__.data[0].tooltipValueShow&&o[a].__data__.data[1].tooltipValueShow||d3.select(o[a]).style("display","none"));return e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),n}();function Hn(t,e){var n=0,i=!1;if(e.forEach(function(t){"objCol"===t.function&&(n=t.index,i=t.isLegend)}),P(t,[n],2))return[];var o=W(t,e),a={},r=[],l=o.length,s=o[0];if(i)for(var u=1;u<l;u++){var c=o[u],h=c[n];if(h){for(var d={name:h,index:u-1,data:[]},_=0;_<3;_++){var f=s[_];_!==n&&d.data.push({name:f,value:""==c[_]||isNaN(parseFloat(c[_]))||null==c[_]||null==c[_]?0:c[_],tooltipValueShow:!isNaN(parseFloat(c[_])),index:_})}r.push(d)}}else{s.forEach(function(t,e){e!==n&&t&&(a[t]={name:t,index:e-1,data:[]})});for(var p=1;p<l;p++){var y=o[p],g=y[n];if(g)for(var v=0;v<y.length+1;v++){var x=s[v];v!==n&&x&&a[x].data.push({name:g,index:p,value:""==y[v]||null==y[v]||null==y[v]?0:y[v],tooltipValueShow:!isNaN(parseFloat(y[v]))})}}for(var m in a)r.push(a[m])}return r.forEach(function(t,e){t.key=T(t.name)+"-"+e}),r}var Vn=function(t){function o(t){r(this,o);var e=c(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return e.elem.attr("class","slope-chart"),e.yAxis=new Nn(e.mainGroup),e.yAxisDoubleY=new Nn(e.mainGroup),e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.slopeOverlay=new En(e.coreGroup),e.slope=new Gn(e.coreGroup),e.scatterPlot=new Bn(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yOrientRight="right",e._curve=d3.curveCardinal,e._showPoints=!0,e._marginRight=0,e._marginLeft=20,e._circleRadius=3.5,e._lineWidth=2,e._circleBorderWidth=1,e._circleBorderColor=null,e._shadowColor="#ccc",e._labelShow=!0,e._positionOptions=["","",""],e._positionChoice="",e._axisLabelShowLeft=!0,e._axisLabelShowRight=!0,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(o,Wn),l(o,[{key:"updateCore",value:function(){var r=this,t=r.activeData,e=r.slopeOverlay,n=r.slope,i=r.scatterPlot,o=(r.tooltip,r.xScale),a=r.yScale,l=(r.widthOfCore,r.heightOfCore);r.widthOfNoMargin;for(var s=function(t){for(var e,n=0;n<t.length;n++)for(var i=n;i<t.length;i++)0<t[n].data.length&&t[n].data[0].value<t[i].data[0].value&&(e=t[i],t[i]=t[n],t[n]=e);return t}(t),u=0;u<s.length;u++)s[u].index=u;for(var c=[],h=0;h<t.length;h++)c.push(t[h].name);for(var d=[],_=0;_<t.length;_++)0<t[_].data.length&&d.push(t[_].data[0].value),1<t[_].data.length&&d.push(t[_].data[1].value);var f=0<t.length&&0<t[0].data.length?et(c,r._fontSize,r._fontFamily):0,p=0<t.length&&0<t[0].data.length?et(d,r._fontSize,r._fontFamily):0,y=f+p,g=r.widthOfNoMargin-f-p;null==r._labelShow||0==r._labelShow||null==r._positionOptions||null==r._positionChoice?(r.yAxis.translate(9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-p,0),g=r.widthOfNoMargin-p,y=p,0==r._axisLabelShowLeft&&1==r._axisLabelShowRight?(r.yAxis.translate(9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-p,0),g=r.widthOfNoMargin-p,y=0):1==r._axisLabelShowLeft&&0==r._axisLabelShowRight?(r.yAxis.translate(9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9,0),g=r.widthOfNoMargin,y=p):0==r._axisLabelShowLeft&&0==r._axisLabelShowRight&&(r.yAxis.translate(9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9,0),g=r.widthOfNoMargin,y=0)):0==r._positionOptions.indexOf(r._positionChoice)?(r.yAxis.translate(f+9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-p,0),g=r.widthOfNoMargin-p,0==r._axisLabelShowLeft&&1==r._axisLabelShowRight?(r.yAxis.translate(f+9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-p,0),g=r.widthOfNoMargin-p,y=f):1==r._axisLabelShowLeft&&0==r._axisLabelShowRight?(r.yAxis.translate(f+9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9,0),g=r.widthOfNoMargin):0==r._axisLabelShowLeft&&0==r._axisLabelShowRight&&(r.yAxis.translate(f+9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9,0),g=r.widthOfNoMargin,y=f)):1==r._positionOptions.indexOf(r._positionChoice)?(r.yAxis.translate(9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin-f+9-p,0),y=p,0==r._axisLabelShowLeft&&1==r._axisLabelShowRight?(r.yAxis.translate(9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-p-f,0),g=r.widthOfNoMargin-p-f,y=0):1==r._axisLabelShowLeft&&0==r._axisLabelShowRight?(r.yAxis.translate(9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-f,0),g=r.widthOfNoMargin-f,y=p):0==r._axisLabelShowLeft&&0==r._axisLabelShowRight&&(r.yAxis.translate(9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-f,0),g=r.widthOfNoMargin-f,y=0)):2==r._positionOptions.indexOf(r._positionChoice)&&(r.yAxis.translate(f+9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin-f+9-p,0),0==r._axisLabelShowLeft&&1==r._axisLabelShowRight?(r.yAxis.translate(f+9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-p-f,0),g=r.widthOfNoMargin-p-f,y=f):1==r._axisLabelShowLeft&&0==r._axisLabelShowRight?(r.yAxis.translate(f+9+p,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-f,0),g=r.widthOfNoMargin-f):0==r._axisLabelShowLeft&&0==r._axisLabelShowRight&&(r.yAxis.translate(f+9,0),r.yAxisDoubleY.translate(r.widthOfNoMargin+9-f,0),g=r.widthOfNoMargin-f,y=f)),i.data(s).xScale(o).yScale(a).fontSize(r._textLabel.fontSize).fontColor(r._textLabel.color).fontFamily(r._textLabel.fontFamily).labelShow(r._labelShow).positionOptions(r._positionOptions).positionChoice(r._positionChoice).axisLabelShowLeft(r._axisLabelShowLeft).axisLabelShowRight(r._axisLabelShowRight).textLength(y).numberLength(p).sWidth(g).circleBorderColor(r._circleBorderColor).circleBorderWidth(r._circleBorderWidth).circleRadius(r._circleRadius),n.data(s).xScale(o).yScale(a).textLength(y).sWidth(g).lineWidth(r._lineWidth).onMouseover(function(t,e){var n=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),i=r.coreGroup.selectAll("polygon").nodes(),o=d3.select(this).node().__data__.index;d3.select(i[o]).style("opacity",.45),d3.select(n[2*o+1]).attr("r",1.8*r._circleRadius),d3.select(n[2*o]).attr("r",1.8*r._circleRadius);var a=[{text:t.name,color:t.color},{text:t.data[0].name+": "+(t.data[0].tooltipValueShow?t.data[0].value:""),color:"none"},{text:t.data[1].name+": "+(t.data[1].tooltipValueShow?t.data[1].value:""),color:"none"}];r.tooltip.data(a).update().show()}).onMousemove(function(){r.tooltip.move();var t=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),e=r.coreGroup.selectAll("polygon").nodes(),n=d3.select(this).node().__data__.index;d3.select(e[n]).style("opacity",.45),d3.select(t[2*n+1]).attr("r",1.8*r._circleRadius),d3.select(t[2*n]).attr("r",1.8*r._circleRadius)}).onMouseout(function(t){r.tooltip.hide();var e=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),n=r.coreGroup.selectAll("polygon").nodes(),i=d3.select(this).node().__data__.index;d3.select(n[i]).style("opacity",0),d3.select(e[2*i+1]).attr("r",r._circleRadius),d3.select(e[2*i]).attr("r",r._circleRadius)}),e.data(s).xScale(o).yScale(a).textLength(y).sWidth(g).sHeight(l).shadowColor(r._shadowColor).onMouseover(function(t,e){var n=r.coreGroup.selectAll("circle").nodes(),i=d3.select(this).node().__data__.index;d3.select(this).style("opacity",.35),d3.select(n[2*i+1]).attr("r",1.8*r._circleRadius),d3.select(n[2*i]).attr("r",1.8*r._circleRadius);var o=[{text:t.name,color:t.color},{text:t.data[0].name+": "+(t.data[0].tooltipValueShow?t.data[0].value:""),color:"none"},{text:t.data[1].name+": "+(t.data[1].tooltipValueShow?t.data[1].value:""),color:"none"}];r.tooltip.data(o).update().show()}).onMousemove(function(){r.tooltip.move();var t=r.coreGroup.selectAll("circle").nodes(),e=d3.select(this).node().__data__.index;d3.select(this).style("opacity",.35),d3.select(t[2*e+1]).attr("r",1.8*r._circleRadius),d3.select(t[2*e]).attr("r",1.8*r._circleRadius)}).onMouseout(function(t){r.tooltip.hide();var e=r.coreGroup.selectAll("circle").nodes(),n=d3.select(this).node().__data__.index;d3.select(this).style("opacity",0),d3.select(e[2*n+1]).attr("r",r._circleRadius),d3.select(e[2*n]).attr("r",r._circleRadius)}),r.coreGroup.call(H,r.yAxis.width+.5,0),e.update(),n.update(),i.translate(r.yAxis.width+.5,0).update()}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=Hn;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t.map(function(t){return t.name}):[0,1]),n=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=e,this._yDomain=n}},{key:"setPublicOption",value:function(t){s(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.y.name||null,i=e.y1.name||null;this.yTitle([n,i])}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._circleRadius=0==e.circleRadius||e.circleRadius?e.circleRadius:this._circleRadius,this._lineWidth=e.lineWidth?e.lineWidth:this._lineWidth,this._circleBorderWidth=e.circleBorderWidth?e.circleBorderWidth:this._circleBorderWidth,this._circleBorderColor=e.circleBorderColor?e.circleBorderColor:this._circleBorderColor,this._shadowColor=e.shadowColor?e.shadowColor:this._shadowColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}},{key:"widthOfNoMargin",get:function(){var t=this._width-3*this._marginLeft-this._marginRight;return 0<t?t:0}}]),o}(),In=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bar-progress"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"bg",value:function(){var e=this,t=e._data;e.group.selectAll(".bg-rect").remove();var n=e.group.append("g").selectAll("rect").data(t,function(t){return t.key});n.exit().remove();var i=n.enter().append("rect").attr("class","bg-rect").merge(n).style("fill",function(t){return t.color_special}).style("fill-opacity",function(t){return e._fillOpacity}).style("stroke",function(t){return t.color_special}).style("stroke-width",function(t){return e._strokeWidth||0});return this._rectObj?i.attr("x",this._rectObj.xFunc).attr("y",this._rectObj.yFunc).attr("width",this._rectObj.widthFunc).attr("height",this._rectObj.heightFunc):i.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),e}},{key:"update",value:function(){var e=this,t=e._data;e.group.selectAll(".progress-rect").remove();var n=e.group.append("g").selectAll("rect").data(t,function(t){return t.key});n.exit().remove();var i=n.enter().append("g"),o=i.append("rect").attr("class","progress-rect").merge(n).style("fill",function(t){return t.color}).style("fill-opacity",function(t){return e._fillOpacity}).style("stroke",function(t){return e._strokeColor||t.color}).style("stroke-width",function(t){return e._strokeWidth||0});return e._rectObj?(o.attr("x",e._rectObj.xFunc),o.attr("y",e._rectObj.yFunc),o.attr("width",e._rectObj.widthFunc),o.attr("height",e._rectObj.heightFunc)):o.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),e._textObj&&(e.group.selectAll(".bar-text").remove(),i.append("text").attr("class","bar-text").merge(n).text(e._textObj.textFunc).attr("fill",e._textObj.colorFunc).attr("font-size",e._textObj.fontSize).attr("font-family",e._textObj.fontFamily).attr("x",e._textObj.xFunc).attr("y",e._textObj.yFunc).attr("dx",e._textObj.dxFunc).attr("dy",e._textObj.dyFunc).style("display",e._labelShow?"block":"none")),o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Yn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bar-progress-chart"),e.rect=new In(e.mainGroup),e.rectBg=new In(e.mainGroup),e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){var i=this,t=i.rect,e=i.rectBg,n=i.activeData,o=.9*i.widthOfNoMargin,a=.9*i.heightOfMainGroup;var r,l,s,u=(s=.15*(r=o),(l=a)<r/5&&(s=.6*l),s);e.data(n).rectObj({xFunc:function(t){return o*t.value},yFunc:a/2.1,widthFunc:function(t){return o*(1-t.value)},heightFunc:u}),t.data(n).labelShow(i._labelShow).rectObj({xFunc:0,yFunc:a/2.1,widthFunc:function(t){return o*t.value},heightFunc:u}).textObj({xFunc:function(t){return t.value},yFunc:a/2.1,dyFunc:u/2+.4*i._textLabel.fontSize,dxFunc:function(t,e){return 0==i._positionOptions.indexOf(i._positionChoice)?o*t.value-V((100*t.value).toFixed(1)+"%",i._textLabel.fontSize,i._fontFamily)-5:1==i._positionOptions.indexOf(i._positionChoice)?o*t.value/2-.5*V((100*t.value).toFixed(1)+"%",i._textLabel.fontSize,i._fontFamily):void 0},colorFunc:function(){return i._labelShow?i._textLabel.color:"none"},textFunc:function(t){return(100*t.value).toFixed(1)+"%"},fontSize:i._textLabel.fontSize,fontFamily:i._textLabel.fontFamily}).fillOpacity(1).onMouseover(function(t,e){var n=[{text:t.name+": "+(100*t.value).toFixed(1)+"%",color:t.color}];i.tooltip.data(n).update().show()}).onMousemove(function(){i.tooltip.move()}).onMouseout(function(t){i.tooltip.hide()}),i.rect.translate(.1*i.widthOfNoMargin/2,0).update(),i.rectBg.translate(.1*i.widthOfNoMargin/2,0).bg()}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=zn;switch(n.dataType){case"cross-table":i=_;break;default:i=zn}return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),n}(),Xn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polygon-radar"),e._lineFunc=null,e._startAngle=0,e._endAngle=2*Math.PI,e._radius=100,e._stroke=null,e._borderWidth=2,e._strokeDasharry="",e._transition=!0,e}return u(n,A),l(n,[{key:"update",value:function(){for(var i=this,t=i._data,o=(i.startAngle,i.endAngle,i._radius),e=t.length?[0,1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return parseFloat(+t.value)})})]:[0,1],n=d3.scaleLinear().domain(e).nice().range([0,o]),a=i._deadData[0].data.length,r=2*Math.PI/a,l=[],s=0;s<t.length;s++){l[s]=[];for(var u=0;u<t[s].data.length;u++){var c=t[s].data[u].value;l[s][u]=n(c)}}for(var h=[],d=0;d<l.length;d++)for(var _=l[d],f="",p=[],y=0;y<a;y++){var g=_[y],v=g*Math.sin(y*r),x=-g*Math.cos(y*r);f+=v+","+x+" ",p.push({x:v,y:x,value:t[d].data[y].value}),h[d]={polygon:f,points:p}}var m=i.group,k=m.selectAll("polygon").data(t);k.exit().remove(),k.enter().append("polygon").merge(k).style("fill","none").style("stroke-opacity",i._fillOpacity).style("stroke",function(t){return i._stroke||t.color||"#000"}).style("stroke-width",i._borderWidth).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(i._transition?i._duration:0).attr("points",function(t,e){return h[e].polygon}),m.selectAll(".circle-g").remove();var b=m.append("g").selectAll("g").data(t);b.exit().remove(),b.enter().append("g").attr("class","circle-g").merge(b).each(function(t,e){var n=d3.select(this).selectAll("circle").data(h[e].points);n.exit().remove(),n.enter().append("circle").attr("class","circle-"+e).attr("cx",function(t){return t.x||0}).attr("cy",function(t){return t.y||0}).merge(n).style("fill",t.color).style("stroke","#FFFFFF").style("stroke-width",1).style("stroke-width",i._strokeWidth).attr("r",i._endPointRadius).attr("cx",function(t){return t.x||0}).attr("cy",function(t){return t.y||0})}).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);for(var S=[],w=0;w<a;w++){for(var O=[],C=0;C<h.length;C++)O.push(h[C].points[w].value);S.push(d3.max(O))}m.selectAll(".polygon-radar-texts").remove();var A=m.append("g").selectAll("g").data(t);A.exit().remove(),A.enter().append("g").merge(A).each(function(t,e){var n=d3.select(this).append("g").selectAll("text").data(h[e].points);n.exit().remove(),n.enter().append("text").attr("class","polygon-radar-texts").merge(n).text(function(t,e){return t.value}).attr("fill",i._fontColor).attr("font-size",i._fontSize).style("font-family",i._fontFamily).attr("x",function(t,e){return t.value==S[e]?t.x+.06*o*(e*r==1.5*Math.PI?-1:Math.sin(e*r))||0:t.x-.06*o*Math.sin(e*r)||0}).attr("y",function(t,e){return t.value==S[e]?t.y+.06*o*(e*r==0?1.5:Math.cos(e*r))+(e*r==0?i._fontSize/2.5:0)||0:t.y-.06*o*(e*r==Math.PI?-1.5:Math.cos(e*r))+(e*r==Math.PI?i._fontSize/2.5:0)||0}).attr("text-anchor",function(t,e){return e*r==0||e*r==Math.PI?"middle":e*r>Math.PI&&t.value!=S[e]?"start":e*r>Math.PI&&t.value==S[e]||0<e*r&&e*r<Math.PI&&t.value!=S[e]?"end":void 0}).attr("dy",function(t,e){if(t.value==S[e])if(t.value==d3.max(S)){if(e*r<Math.PI/2||e*r>1.5*Math.PI)return"0.7em";if(e*r>Math.PI/2&&e*r<1.5*Math.PI)return"-0.7em";if(e*r==Math.PI/2||e*r==1.5*Math.PI)return"1.1em"}else{if(e*r==0)return"0.1em";if(e*r==Math.PI)return"0";if(e*r<Math.PI/2||e*r>1.5*Math.PI)return"0.5em";if(e*r>Math.PI/2&&e*r<1.5*Math.PI)return"-0.5em";if(e*r==Math.PI/2||e*r==1.5*Math.PI)return"0.9em"}else if(t.value!=S[e])return e*r==0||e*r>Math.PI&&e*r<1.5*Math.PI?0:"0.4em"}).style("display",i._labelShow?"block":"none")});for(var F=[],L=1.06*o,M=0;M<a;M++){var z=L*Math.sin(M*r),R=-L*Math.cos(M*r);F.push({x:z,y:R})}m.selectAll(".angle-text").remove();var T=m.append("g").selectAll("text").data(F);T.exit().remove(),T.enter().append("text").attr("class","angle-text").text(function(t,e){return i._deadData[0].data[e].name=="&-"+(e+1)?"":i._deadData[0].data[e].name}).style("font-size",i._themeFontSize).style("font-family",i._themeFontFamily).style("fill",i._themeFontColor).attr("x",function(t){return t.x}).attr("y",function(t){return t.y});for(var P=0;P<a;P++)P*r==0||P*r==Math.PI?d3.select(m.selectAll(".angle-text").nodes()[P]).attr("text-anchor","middle"):P*r>Math.PI?d3.select(m.selectAll(".angle-text").nodes()[P]).attr("text-anchor","end"):0<P*r&&P*r<Math.PI&&d3.select(m.selectAll(".angle-text").nodes()[P]).attr("text-anchor","start");for(var W=0;W<a;W++)W*r==Math.PI&&d3.select(m.selectAll(".angle-text").nodes()[W]).attr("dy","0.8em");for(var D=m.selectAll(".polygon-radar-texts"),j=[],N=[],G=0;G<D._groups[0].length;G++){N.push(G);for(var B=G+1;B<D._groups[0].length;B++){rt(at(d3.select(D._groups[0][G])),at(d3.select(D._groups[0][B])))&&(j.push(G),d3.select(D._groups[0][G]).style("opacity","0"))}}for(var E=new Set(j),H=Array.from(E),V=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(H,N),I=0;I<H.length;I++){for(var Y=[],X=0;X<V.length;X++){var Z=at(d3.select(D._groups[0][H[I]])),Q=at(d3.select(D._groups[0][V[X]]));if(Y.push(rt(Z,Q)),rt(Z,Q)){if(H[I]==V[X])continue;d3.select(D._groups[0][H[I]]).style("opacity","0")}}0==Y.filter(function(t){return 1==t}).length&&V.push(H[I])}for(var q=0;q<V.length;q++)d3.select(D._groups[0][V[q]]).style("opacity","1");return i}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"deadData",value:function(t){return arguments.length?(this._deadData=t,this):this._deadData}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),Zn="grid-polygon-path",Qn="grid-line",qn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.elem=t.append("g").attr("class","polygon-grid"),e.group=e.elem.append("g"),e._radius=100,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=8,e}return u(n,Y),l(n,[{key:"update",value:function(){for(var e=this,t=e._data,n=(e._startAngle,e._endAngle,e._radius),i=e._donutCount,o=t[0].data.length||e._sectorCount,a=2*Math.PI/o,r={webs:[],webPoints:[]},l=i;0<l;l--){for(var s="",u=[],c=n/i*l,h=0;h<o;h++){var d=c*Math.sin(h*a),_=-c*Math.cos(h*a);s+=d+","+_+" ",u.push({x:d,y:_})}r.webs.push(s),r.webPoints.push(u)}var f=e.group.style("fill","none").style("stroke",e._stroke).style("stroke-dasharray","none");!function(){if(!e._showX)return f.selectAll("."+Zn).remove();var t=f.selectAll("."+Zn).data(r.webs);t.exit().remove(),t.enter().append("polygon").attr("class",Zn).merge(t).attr("points",function(t){return t}).attr("fill","white").attr("fill-opacity",1),d3.selectAll(t.nodes().filter(function(t,e){return e%2!=0})).attr("fill","#e4e3e6").attr("fill-opacity",.4)}(),function(){if(!e._showY)return f.selectAll("."+Qn).remove();var t=f.selectAll("."+Qn).data(r.webPoints[0]);t.exit().remove(),t.enter().append("line").attr("class",Qn).merge(t).attr("x1",0).attr("y1",0).attr("x2",function(t){return t.x}).attr("y2",function(t){return t.y})}()}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=parseFloat(t),this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}}]),n}();function Un(t,e){var n=0,i=!1,o=[];if(e.forEach(function(t){"objCol"===t.function?(n=t.index,i=t.isLegend):"vCol"===t.function&&0==t.configurable&&o.push(t.index)}),P(t,[n],2))return[];var a=W(t,e),r={},l=[],s=a.length,u=a[0];if(i){for(var c=[],h=1;h<s;h++)c.push(a[h].length);c.sort(function(t,e){return e-t});for(var d=1;d<c[0];d++)if(d!==n){var _=u[d];""!=u[d]&&null!=u[d]&&null!=u[d]||(_="$-"+d),r[_+"-"+d]={name:_,showLegend:_!="$-"+d,data:[]}}for(var f=1;f<s;f++){var p=a[f],y=p[n];if(""!=y&&null!=y&&null!=y||(y="&-"+f),y)for(var g=0;g<c[0];g++){var v=u[g];""!=u[g]&&null!=u[g]&&null!=u[g]||(v="text-"+g),g!==n&&v&&r[v+"-"+g].data.push({name:y,showAxisText:y!="&-"+f,value:""==p[g]||isNaN(parseFloat(p[g]))||null==p[g]||null==p[g]?0:p[g],tooltipValueShow:!isNaN(parseFloat(p[g]))})}}for(var x in r)l.push(r[x])}else{for(var m=[],k=1;k<s;k++)m.push(a[k].length);m.sort(function(t,e){return e-t});for(var b=1;b<s;b++){var S=a[b],w=S[n];if(""!=w&&null!=w&&null!=w||(w="$-"+b),w){for(var O={name:w,showLegend:w!="$-"+b,data:[]},C=0;C<m[0];C++){var A=u[C];""!=A&&null!=A&&null!=A||(A="&-"+C),C!==n&&O.data.push({name:A,showAxisText:A!="&-"+C,value:""==S[C]||isNaN(parseFloat(S[C]))||null==S[C]||null==S[C]?0:S[C],tooltipValueShow:!isNaN(parseFloat(S[C]))})}l.push(O)}}}return l.forEach(function(t,e){t.key=T(t.name)+"-"+e}),l}var Jn=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.gridPolygon=new qn(e.mainGroup),e.coreGroup=e.mainGroup.append("g").attr("class","core-group"),e.radar=new Xn(e.coreGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._showPoints=!0,e._fillOpacity=0,e._endPointRadius=3.5,e._borderWidth=2,e._labelShow=!1,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,q),l(n,[{key:"updateCore",value:function(){var a=this,r=a.activeData,t=a.gridPolygon,e=a.radar,n=(a.tooltip,a.widthOfCore,a.heightOfCore,a.widthOfNoMargin),i=a.heightOfMainGroup,o=M(.84*n,.84*a.heightOfMainGroup,a._startAngle,a._endAngle).radius;e.data(r).deadData(a.sortedDataCopy).fontSize(a._textLabel.fontSize).fontColor(a._textLabel.color).fontFamily(a._textLabel.fontFamily).themeFontSize(a._fontSize).themeFontColor(a._fontColor).themeFontFamily(a._fontFamily).fillOpacity(.6).labelShow(a._labelShow).radius(o).borderWidth(a._borderWidth).endPointRadius(a._endPointRadius).onMouseover(function(t,e){var n=[{text:r[e].name=="$-"+(e+1)?"":r[e].name,color:r[e].color}];r[e].data.forEach(function(t,e){n.push({text:(t.name=="&-"+(e+1)?"":t.name)+": "+t.value,color:"none"})}),d3.select(this).style("stroke-opacity",1).style("stroke-width",1.5*a._borderWidth);var i=a.group.selectAll(".circle-g").nodes(),o=a.group.selectAll(".polygon-radar polygon").nodes();d3.selectAll(i[e].childNodes).style("r",1.5*a._endPointRadius),d3.select(o[e]).style("stroke-width",1.5*a._borderWidth),a.tooltip.data(n).update().show()}).onMousemove(function(t,e){d3.select(this).style("stroke-opacity",1).style("stroke-width",1.5*a._borderWidth);var n=a.group.selectAll(".circle-g").nodes(),i=a.group.selectAll(".polygon-radar polygon").nodes();d3.select(i[e]).style("stroke-width",1.5*a._borderWidth),d3.selectAll(n[e].childNodes).style("r",1.5*a._endPointRadius),a.tooltip.move()}).onMouseout(function(t,e){d3.select(this).style("stroke-opacity",.8).style("stroke-width",a._borderWidth);var n=a.group.selectAll(".circle-g").nodes(),i=a.group.selectAll(".polygon-radar polygon").nodes();d3.select(i[e]).style("stroke-width",a._borderWidth),d3.selectAll(n[e].childNodes).style("r",a._endPointRadius),a.tooltip.hide()}),t.data(a.sortedDataCopy).radius(o).fillOpacity(null==a._fillOpacity?0:a._fillOpacity).showX(a._gridShowX).showY(a._gridShowY).stroke(a._gridStroke).strokeDasharray(a._gridStrokeDasharray);var l=(a._width-a._marginLeft-a._marginRight)/2;a.gridPolygon.translate(l,i/2).update(),a.coreGroup.call(H,l,i/2),t.update(),e.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=Un;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._textLabel=n.textLabel?n.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&this.fillOpacity(e.fillOpacity).endPointRadius(e.endPointRadius).borderWidth(e.borderWidth)}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"widthOfNoMargin",get:function(){var t=this._width-3*this._marginLeft-this._marginRight;return 0<t?t:0}}]),n}(),Kn="axis-group",$n="y-ranking-title",ti=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-ranking"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return u(n,ht),l(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,a=t._tickValueTexts,r=void 0;r=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),r.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+Kn).empty()?i.append("g").attr("class",Kn):i.select("."+Kn);s.transition().duration(t._transition?t._duration:0).call(r).on("start",function(){s.selectAll(".tick text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return a[e]}),s.selectAll(".tick line").style("stroke",t._lineStroke).style("display","none"),s.select("path").style("stroke",t._lineStroke).style("display","none")});var u=Math.abs(n.range()[0]-n.range()[1]);if(t._titleShow&&t._title){var c=i.select("."+$n).empty()?i.append("g").attr("class",$n):i.select("."+$n),h=c.select("text").empty()?c.append("text"):c.select("text");V(t._title,o,t._fontFamily);c.call(H,-(this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),u/2),h.attr("y",-5).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(t._title)}else i.select("."+$n).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,a=e._type,r=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);(t="category"===a?o.domain():o.ticks(e._tickCount)).push(1),t.splice(t.indexOf(0),1);var s=d3.max(t,function(t){return V(t,r,e._fontFamily)});return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,r,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth+(this._title?1.125*this._fontSize+11:0):this._titleShow&&this._title?1.125*this._fontSize+11:0),t}}]),n}(),ei=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.grid=new Ct(e.coreGroup),e.linePlot=new Mt(e.coreGroup),e.scatterPlot=new zt(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new ti(e.mainGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.guideScatter=new zt(e.coreGroup),e.stackText=new kt(e.coreGroup),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._curve=d3.curveCardinal,e._showPoints=!0,e._endPointRadius=3.5,e._lineShadowColor="#ccc",e._lineWidth=2,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var t=this,n=t.activeData,e=t.grid,i=t.linePlot,o=t.scatterPlot,r=t.tooltip,a=t.overlay,l=t.guideLine,s=t.guideScatter,u=t.stackText,c=t.xScale,h=t.yScale,d=t.widthOfCore,_=t.heightOfCore;t.xAxis,t.yAxis;e.width(d).height(_).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(c).yScale(h).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).mainGroup(t.mainGroup).lineWidth(t._lineWidth),o.data(n).xScale(c).yScale(h).radius(t._endPointRadius).fill("#fff").strokeWidth(2),l.y1(0).y2(_).strokeDasharray(t._gridStrokeDasharray),s.xScale(c).yScale(h).radius(t._endPointRadius).fill("#fff"),a.data(c.domain()).isScalePoint(!1).bandWidth(c.step()).bandHeight(_).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),r.data(o).update().show(),l.x(c(i)+c.bandwidth()/2).update().show(),s.data(a).update().show()}).onMousemove(function(){r.move()}).onMouseout(function(){r.hide(),l.hide(),s.hide()}),u.data(n).xScale(c).yScale(h).type("mix").fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice),t.coreGroup.call(H,t.yAxis.width+.5,0),s.elem.style("pointer-events","none");var f=t.group.selectAll(".axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(f).remove(),a.update(),e.update(),i.update(),t._showPoints?o.update().show():o.hide(),u.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yRange,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})}),Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0)]:[1,0];this._xDomain=e,this._yDomain=n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._lineShadowColor=e.lineShadowColor?e.lineShadowColor:this._lineShadowColor,this._lineWidth=e.lineWidth?e.lineWidth:this._lineWidth),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=Ft;return n.dataSolveFunc(i),n}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}}]),n}(),ni="axis-group",ii="y-percent-title",oi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-percent"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e._tickPadding=2,e}return u(n,ht),l(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,a=t._tickValueTexts,r=void 0;r=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),r.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+ni).empty()?i.append("g").attr("class",ni):i.select("."+ni);s.transition().duration(t._transition?t._duration:0).call(r).on("start",function(){s.selectAll(".tick text").remove(),s.selectAll(".tick").append("text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dx",.6*-o).attr("dy",.4*o).text(function(t,e){return 100*a[e]+"%"}),s.selectAll(".tick line").style("stroke",t._lineStroke).style("display","none"),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none").style("display","none")});var u=Math.abs(n.range()[0]-n.range()[1]);if(t._titleShow&&t._title){var c=i.select("."+ii).empty()?i.append("g").attr("class",ii):i.select("."+ii),h=c.select("text").empty()?c.append("text"):c.select("text");V(t._title,o,t._fontFamily);c.call(H,-(this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),u/2),h.attr("y",-5).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(t._title)}else i.select("."+ii).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,a=e._type,r=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===a?o.domain():o.ticks(e._tickCount);var s=d3.max(t,function(t){return V(t,r,e._fontFamily)})+r;return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,r,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth+(this._title?1.125*this._fontSize+11:0):this._titleShow&&this._title?1.125*this._fontSize+11:0),t}}]),n}(),ai=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){var o=this,t=o._data,i=o.group;i.selectAll(".percentageStackBar").remove();var e=i.append("g").selectAll("g").data(t);e.exit().remove(),e.enter().append("g").merge(e).each(function(t,e){var n=o._rectObj.barWidthPercent,i=d3.select(this).selectAll("rect").data(t.data);i.exit().remove(),i.enter().append("rect").attr("class","percentageStackBar").merge(i).style("fill",function(t){return t.color}).style("fill-opacity",function(t){return o._fillOpacity}).style("stroke",function(t){return o._strokeColor||t.color}).style("stroke-width",function(t){return o._strokeWidth||0}).attr("x",function(t,e){return o._xScale.step()*e+o._xScale.step()*(1-n)/2}).attr("y",function(t){return o._yScale(t.total)}).attr("width",o._xScale.step()*n).attr("height",function(t){return 0<o._yScale(1-t.percent)?o._yScale(1-t.percent):0}),i.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),i.selectAll(".percentageStackBarTexts").remove();var n=i.append("g").selectAll("g").data(t);n.exit().remove(),n.enter().append("g").merge(n).each(function(t,e){var n=d3.select(this).append("g").attr("class","percentageStackBarTexts").selectAll("text").data(t.data);n.exit().remove(),n.enter().append("text").merge(n).text(function(t){return null==o._contentOption||null==o._contentChoice?0==t.value?"":t.value:0==o._contentOption.indexOf(o._contentChoice[0])?0==t.value?"":(100*parseFloat(t.percent)).toFixed(2)+"%":1==o._contentOption.indexOf(o._contentChoice[0])?0==t.value?"":t.value:void 0}).attr("fill",o._textObj.colorFunc).attr("font-size",o._fontSize).style("font-family",o._fontFamily).attr("x",function(t,e){return o._xScale.step()*e+.25*o._xScale.step()}).attr("y",function(t){return o._yScale(t.total)}).attr("text-anchor","middle").attr("dx",.25*o._xScale.step()).attr("dy",function(t){return null==o._positionOptions||null==o._positionChoice?0:0==o._positionOptions.indexOf(o._positionChoice)?o._yScale(1-t.percent)/2+.4*o._fontSize:1==o._positionOptions.indexOf(o._positionChoice)?o._yScale(1-t.percent)-.3*o._fontSize:void 0}).style("display",o._labelShow?"block":"none"),null!=o._labelShow&&null!=o._positionOptions&&null!=o._positionChoice&&null!=o._contentOption&&null!=o._contentChoice&&-1!=o._positionOptions.indexOf(o._positionChoice)||i.selectAll(".percentageStackBarTexts text").style("display","none")});for(var a=i.selectAll(".percentageStackBarTexts text"),r=[],l=[],s=0;s<a._groups[0].length;s++){l.push(s);for(var u=s+1;u<a._groups[0].length;u++){rt(at(d3.select(a._groups[0][s])),at(d3.select(a._groups[0][u])))&&(r.push(s),d3.select(a._groups[0][s]).style("opacity","0"))}}for(var c=new Set(r),h=Array.from(c),d=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(h,l),_=0;_<h.length;_++){for(var f=[],p=0;p<d.length;p++){var y=at(d3.select(a._groups[0][h[_]])),g=at(d3.select(a._groups[0][d[p]]));if(f.push(rt(y,g)),rt(y,g)){if(h[_]==d[p])continue;d3.select(a._groups[0][h[_]]).style("opacity","0")}}0==f.filter(function(t){return 1==t}).length&&d.push(h[_])}for(var v=0;v<d.length;v++)d3.select(a._groups[0][d[v]]).style("opacity","1");return o}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),ri=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new ai(e.coreGroup),e.overlay=new At(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new oi(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=null,e._curve=d3.curveCardinal,e._histogramWidth=1,e._yScaleHeight=1.05,e._barWidthPercent=.5,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=[],i=0;i<(0==n.length?0:n[0].data.length);i++){for(var o=0,a=0;a<n.length;a++)o+=parseFloat(n[a].data[i].value);e.push(o)}for(var r=0;r<n.length;r++)for(var l=0;l<n[r].data.length;l++)0==e[l]?n[r].data[l].percent=0:n[r].data[l].percent=n[r].data[l].value/e[l];for(var s=0;s<n.length;s++)for(var u=0;u<n[s].data.length;u++)n[s].data[u].total=0==s?parseFloat(n[s].data[u].percent):n[s-1].data[u].total+parseFloat(n[s].data[u].percent);var c=n,h=t.grid,d=t.tooltip,_=t.rectPlot,f=t.overlay,p=t.selectOverlay,y=t.xScale,g=t.yScale,v=t.widthOfCore,x=t.heightOfCore;f.data(y.domain()).isScalePoint(!1).bandWidth(y.step()).bandHeight(x).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(n[0].tooltipValueShow?n[0].value:""),color:t.color})}),d.data(o).update(),p.translate(y(i),0),d.show()}).onMousemove(function(){d.move(),p.show()}).onMouseout(function(){d.hide(),p.hide()}),_.data(c).xScale(y).yScale(g).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).rectObj({barWidthPercent:t._barWidthPercent}).textObj({colorFunc:function(){return t._textLabel.color}}).fillOpacity(1),h.width(v).height(x).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),p.width(y.step()).height(x).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)");var m=t.group.selectAll(".percentage-bar-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(m).remove(),_.update(),p.update(),f.update(),h.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]);this._xDomain=e,this._yDomain=[0,1]}}]),n}(),li=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","area-plot"),e._xScale=null,e._yScale=null,e._areaFunc=null,e._curve=d3.curveLinear,e._fillOpacity=.7,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._areaFunc||d3.area().x(function(t){return e._xScale(t.name)}).y0(e._yScale.range()[0]).y1(function(t){return e._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});n.curve(e._curve);var i=e.group.selectAll("path").data(t,function(t){return t.key});return i.exit().remove(),i.enter().append("path").merge(i).style("fill",function(t){return t.color}).style("fill-opacity",e._fillOpacity).transition().duration(e._transition?e._duration:0).attr("d",function(t){return n(t.data)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}}]),n}(),si=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-line-plot"),e._xScale=null,e._yScale=null,e._lineFunc=null,e._stroke=null,e._strokeWidth=2,e._strokeDasharry="",e._curve=d3.curveLinear,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var e=this,t=e._data,n=e._lineFunc||d3.line().x(function(t){return e._xScale(t.name)}).y(function(t){return e._yScale(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))});n.curve(e._curve);var i=e.group.selectAll("path").data(t,function(t){return t.key});return i.exit().remove(),i.enter().append("path").merge(i).style("fill","none").style("stroke",function(t){return e._stroke||t.color||"#000"}).style("stroke-width",e._strokeWidth).style("stroke-dasharray",e._strokeDasharry).transition().duration(e._transition?e._duration:0).attr("d",function(t){return n(t.data)}),e}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),ui=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-area-text"),e._xScale=null,e._yScale=null,e._lineFunc=null,e._stroke=null,e._strokeWidth=2,e._strokeDasharry="",e._curve=d3.curveLinear,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n._data,e=n.group;e.selectAll(".stackAreaTexts").remove();var i=e.selectAll("g").data(t);i.exit().remove(),i.enter().append("g").merge(i).each(function(t){var e=d3.select(this).append("g").attr("class","stackAreaTexts").selectAll("text").data(t.data.slice(1));e.exit().remove(),e.enter().append("text").merge(e).text(function(t){return null==n._contentOption||null==n._contentChoice?isNaN(parseFloat(t.value))||0==t.value?"":t.value:0==n._contentOption.indexOf(n._contentChoice[0])?isNaN(parseFloat(t.value))||0==t.value?"":(100*parseFloat(t.percent)).toFixed(1)+"%":1==n._contentOption.indexOf(n._contentChoice[0])?isNaN(parseFloat(t.value))||0==t.value?"":t.value:void 0}).attr("fill",n._textObj.colorFunc).attr("font-size",n._fontSize).style("font-family",n._fontFamily).attr("x",function(t,e){return n._xScale.step()*(e+1)+.15*n._xScale.step()}).attr("y",function(t){return n._yScale(t.total)}).attr("text-anchor","middle").attr("dx",.15*-n._xScale.step()).attr("dy",function(t){return null==n._positionOptions||null==n._positionChoice?0:0==n._positionOptions.indexOf(n._positionChoice)?0:1==n._positionOptions.indexOf(n._positionChoice)?n._fontSize:void 0}).style("display",n._labelShow?"block":"none")}),null!=n._labelShow&&null!=n._positionOptions&&null!=n._positionChoice&&null!=n._contentOption&&null!=n._contentChoice&&-1!=n._positionOptions.indexOf(n._positionChoice)||e.selectAll(".stackAreaTexts text").style("display","none");for(var o=e.selectAll(".stackAreaTexts text"),a=[],r=[],l=0;l<o._groups[0].length;l++){r.push(l);for(var s=l+1;s<o._groups[0].length;s++){rt(at(d3.select(o._groups[0][l])),at(d3.select(o._groups[0][s])))&&(a.push(l),d3.select(o._groups[0][l]).style("opacity","0"))}}for(var u=new Set(a),c=Array.from(u),h=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(c,r),d=0;d<c.length;d++){for(var _=[],f=0;f<h.length;f++){var p=at(d3.select(o._groups[0][c[d]])),y=at(d3.select(o._groups[0][h[f]]));if(_.push(rt(p,y)),rt(p,y)){if(c[d]==h[f])continue;d3.select(o._groups[0][c[d]]).style("opacity","0")}}0==_.filter(function(t){return 1==t}).length&&h.push(c[d])}for(var g=0;g<h.length;g++)d3.select(o._groups[0][h[g]]).style("opacity","1");for(var v=e.selectAll(".stackAreaTexts text").nodes(),x=0;x<v.length;x++)isNaN(v[x].__data__.value)&&d3.select(v[x]).style("opacity","0");return n}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}}]),n}(),ci=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","percentage-area-chart"),e.grid=new Ct(e.coreGroup),e.areaPlot=new li(e.coreGroup),e.linePlot=new si(e.coreGroup),e.percentareatext=new ui(e.mainGroup),e.overlay=new At(e.mainGroup),e.guideLine=new vt(e.coreGroup),e.guideScatter=new yn(e.coreGroup),e.clipArea=new bt(e.defs),e.AnimationArea=new St(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new oi(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=null,e._curve=null,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=[],i=0;i<(0==n.length?0:n[0].data.length);i++){for(var o=0,a=0;a<n.length;a++)o+=isNaN(parseFloat(n[a].data[i].value))?0:parseFloat(n[a].data[i].value);e.push(o)}for(var r=0;r<n.length;r++)for(var l=0;l<n[r].data.length;l++)0==e[l]||isNaN(parseFloat(n[r].data[l].value))?n[r].data[l].percent=0:n[r].data[l].percent=n[r].data[l].value/e[l];for(var s=0;s<n.length;s++)for(var u=0;u<n[s].data.length;u++)n[s].data[u].total=0==s?parseFloat(n[s].data[u].percent):n[s-1].data[u].total+parseFloat(n[s].data[u].percent);var c=t.grid,h=t.areaPlot,d=t.linePlot,_=t.percentareatext,f=t.guideScatter,p=t.tooltip,y=t.overlay,g=t.guideLine,v=(t.clipArea,t.AnimationArea,t.xScale),x=t.yScale,m=t.widthOfCore,k=t.heightOfCore;t.widthOfNoMargin,t.heightOfMainGroup;c.width(m).height(k).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),h.data(n).xScale(v).yScale(x).curve(t._curve).areaFunc(d3.area().x(function(t){return v(t.name)}).y0(function(t){return x(t.total-t.percent)}).y1(function(t){return x(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),d.data(n).xScale(v).yScale(x).curve(t._curve).lineFunc(d3.line().x(function(t){return v(t.name)}).y(function(t){return x(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),_.data(n).xScale(v).yScale(x).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).textObj({colorFunc:function(){return t._textLabel.color}}),f.data(n).xScale(v).yScale(x).fill("#fff"),g.y1(0).y2(k).strokeDasharray(t._gridStrokeDasharray),y.data(v.domain()).isScalePoint(!0).bandWidth(v.step()).bandHeight(k).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),p.data(o).update(),g.x(v(i)).update(),f.data(a).update(),p.show(),g.show(),f.show()}).onMousemove(function(){p.move()}).onMouseout(function(){p.hide(),g.hide(),f.hide()}),t.coreGroup.call(H,t.yAxis.width+.5,0),f.elem.style("pointer-events","none");var b=t.group.selectAll(".percentage-area-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(b).remove(),c.update(),h.update(),d.update(),_.translate(t.yAxis.width+.5,0).update(),y.translate(t.yAxis.width+.5,0).update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=Ft;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]);this._xDomain=e,this._yDomain=[0,1]}}]),n}(),hi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","arcDiagram-chart"),e._xScale=null,e._yScale=null,e._radius=function(){return 3},e._fill=null,e._stroke=null,e._strokeWidth=1,e._transition=!1,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e._startAngle=-Math.PI/2,e._endAngle=Math.PI/2,e._sWidth=null,e._areaBorderColor="#fff",e._areaBorderWidth=1,e._sortMethod=null,e}return u(n,A),l(n,[{key:"update",value:function(){for(var c=this,t=c.group,n=c._data,e=[],i=0;i<n[0].length;i++)e.push(parseFloat(n[0][i].value));var o=d3.max(e),a=d3.scaleLinear().domain([0,o]).range([4.5,8.5]).clamp(!0),r=c._sWidth,h=(c._sHeight,r/(n[0].length-1)),l=(c._xScale,c._yScale,c.arcFunc.startAngle(c._startAngle).endAngle(c._endAngle));l.setRadius=function(t){var e=.5*Math.abs(t.x2-t.x1);this.innerRadius(e-c._lineWidth/2).outerRadius(e+c._lineWidth/2)};var s=t.selectAll("path").data(n[1]);s.exit().remove(),s.merge(s.enter().append("path")).attr("transform",function(t,e){return t.x1=n[0][t.target].displayOrder*h,t.x2=n[0][t.source].displayOrder*h,"translate("+(t.x1+t.x2)/2+",0)"}).attr("d",function(t){return l.setRadius(t),l()}).style("stroke",function(t){return n[0][t.source].color}).style("stroke-width",0).style("fill",function(t){return n[0][t.source].color}).style("fill-opacity",c._lineOpacity).on("mouseover",c._onMouseover).on("mousemove",c._onMousemove).on("mouseout",c._onMouseout).transition().duration(c._transition?c._duration:0).ease(d3.easeLinear).on("start",c._onTransitionStart).on("end",c._onTransitionEnd),t.select(".arc-groups").remove();var u=t.append("g").attr("class","arc-groups").selectAll("circle").data(n[0]);u.exit().remove();u.enter().append("circle").attr("cx",function(t){return t.displayOrder*h||0}).attr("cy",0).merge(u).style("fill",function(t){return t.color}).style("fill-opacity",.5).style("stroke",function(t){return t.color}).style("stroke-width",1).attr("r",function(t){return a(t.value)}).attr("cx",function(t){return t.displayOrder*h||0}).attr("cy",0);t.select(".arc-texts").remove();var d=t.append("g").attr("class","arc-texts").selectAll("g").data(n[0]);function _(t){return!!/^[\u4E00-\u9FA5]+$/.test(t)}return d.exit().remove(),d.enter().append("g").attr("class","arc-text").attr("fill",c._fontColor).attr("font-size",c._fontSize).attr("text-anchor","start").attr("x",function(t){return _(t.name)?t.displayOrder*h-.5*c._fontSize||0:t.displayOrder*h||0}).attr("y",function(t){return _(t.name)?c._fontSize+9:0}).attr("dx",function(t){return _(t.name)?0:-(V(t.name,c._fontSize,c._fontFamily)+c._fontSize)}).attr("transform",function(t){return _(t.name)?"":"rotate(-90 "+(t.displayOrder*h||0)+" "+.3*-c._fontSize+" )"}).each(function(t){if(_(t.name))for(var e=d3.select(this),n=t.name.split("").reverse(),i=void 0,o=[],a=0,r=(e.node().getBoundingClientRect().height,+e.attr("x")),l=+e.attr("y"),s=e.text(null).append("text").attr("x",r).attr("y",l);i=n.pop();){o.push(i);var u=0<a?"-":"";s.text(u+o.join("")),s.node().getComputedTextLength()>c._fontSize&&(o.pop(),s.text(o.join("")),o=[i],s=e.append("text").attr("x",r).attr("y",++a*c._fontSize*1.3+l).text(i))}else d3.select(this).append("text").text(function(t){return t.name}).attr("fill",c._fontColor).attr("font-size",c._fontSize).attr("text-anchor","start").attr("x",function(t){return _(t.name)?t.displayOrder*h-.5*c._fontSize||0:t.displayOrder*h||0}).attr("y",function(t){return _(t.name)?c._fontSize+9:0}).attr("dx",function(t){return _(t.name)?0:-(V(t.name,c._fontSize,c._fontFamily)+c._fontSize)})}),c}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"lineOpacity",value:function(t){return arguments.length?(this._lineOpacity=t,this):this._lineOpacity}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}}]),n}(),di=function(t){function n(t,e){return r(this,n),c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e))}return u(n,w),l(n,[{key:"data",get:function(){var t,n,e=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),i=this.generateColorList(e.length);return n=i,(t=e)[0].forEach(function(t,e){t.color=n[e]}),t}}]),n}();function _i(t,e){var n=0,i=1,o=2;e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"targetCol"===t.function?i=t.index:"vCol"===t.function&&(o=t.index)});for(var a=[],r=t.length,l=[],s=1;s<r;s++){var u=t[s];""!=u[n]&&null!=u[n]&&null!=u[n]&&(l.push(u[n]),""!=u[i]&&null!=u[i]&&null!=u[i]&&l.push(u[i]))}Array.prototype.distinct=function(){var t,e,n=this.length;for(t=0;t<n;t++)for(e=t+1;e<n;e++)this[t]==this[e]&&(this.splice(e,1),n--,e--);return this};for(var c=l.distinct(),h=[],d=0;d<c.length;d++)h.push({name:c[d]});for(var _=[],f=1;f<r;f++){var p=t[f];_.push({source:c.indexOf(p[n]),target:c.indexOf(p[i]),s:p[n],t:p[i],value:""==p[o]||null==p[o]||null==p[o]?0:p[o]})}for(var y=0;y<h.length;y++)h[y].value=0,h[y].displayOrder=y;return a.push(h),a.push(_),a[0].forEach(function(t,e){t.key=t.name+"-"+e}),a}var fi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","arcDiagram-chart"),e.arcDiagram=new hi(e.mainGroup),e._innerRadius=0,e._startAngle=-Math.PI/2,e._endAngle=Math.PI/2,e.lineOpacity=.7,e.lineWidth=1,e}return u(n,O),l(n,[{key:"updateCore",value:function(){var r=this,t=r.activeData,l=[];l.push(C(t[0]));for(var e=[],n=0;n<l[0].length;n++)null!=l[0][n].name&&e.push(l[0][n].name);for(var s=et(e,r._fontSize,r._fontFamily),i=0;i<t[1].length;i++)-1==e.indexOf(t[1][i].s)||-1==e.indexOf(t[1][i].t)?t[1][i].active=!1:t[1][i].active=!0;l.push(C(t[1]));for(var o=0;o<l[0].length;o++)l[0][o].value=0,l[0][o].displayOrder=o;for(var a=0;a<l[1].length;a++)for(var u=0;u<l[0].length;u++)l[1][a].s==l[0][u].name&&(l[1][a].source=l[0][u].displayOrder),l[1][a].t==l[0][u].name&&(l[1][a].target=l[0][u].displayOrder);for(var c=0;c<l[1].length;c++){var h=l[1][c];l[0][h.source].value+=parseFloat(h.value),l[0][h.target].value+=parseFloat(h.value)}var d=r.arcDiagram,_=r.widthOfNoMargin,f=(r.heightOfNoMargin,_),p=r.heightOfMainGroup,y=r._startAngle,g=r._endAngle,v=function(t,e,n,i){var o=Math.min(t,e),a=o/2,r=0,l=e/2+a/2-s/2;o==e&&(r=(t-2*(a=.85*e-s/2))/2,l=1.1*a-s/2,t/2<a&&(r=0,l=e/2+(a=t/2)/2-s/2));return{radius:a,cx:r,cy:l,quadrant:0}}(f,p),x=v.radius;r._innerRadius||r._innerRadiusRatio&&r._innerRadiusRatio;for(var m=1e8,k=0,b=0;b<l[0].length;b++)m=Math.min(m,l[0][b].value),k=Math.max(k,l[0][b].value);function S(t,e,n,i,o){return i+(Math.min(Math.max(t,e),n)-e)/(n-e)*(o-i)}d.data(l).startAngle(y).endAngle(g).sWidth(2*x).lineWidth(r.lineWidth).lineOpacity(r.lineOpacity).fontSize(r._fontSize).fontColor(r._fontColor).transition(r._transition).duration(r._duration).onTransitionEnd(function(t,e){}).onMouseover(function(t,e){var n=d3.select(this)._groups[0][0].__data__.source,i=d3.select(this)._groups[0][0].__data__.target,o=d3.selectAll(".arc-groups circle").nodes();d3.select(o[n]).attr("r",function(t){return 1.3*(S(t.value,m,k,4.5,8.5)||4.5)}),d3.select(o[i]).attr("r",function(t){return 1.3*(S(t.value,m,k,4.5,8.5)||4.5)});var a=[{text:l[0][t.source].name+""+l[0][t.target].name+""+t.value,color:l[0][t.source].color}];r.tooltip.data(a).update().show()}).onMousemove(function(){var t=d3.select(this)._groups[0][0].__data__.source,e=d3.select(this)._groups[0][0].__data__.target,n=d3.selectAll(".arc-groups circle").nodes();d3.select(n[t]).attr("r",function(t){return 1.3*(S(t.value,m,k,4.5,8.5)||4.5)}),d3.select(n[e]).attr("r",function(t){return 1.3*(S(t.value,m,k,4.5,8.5)||4.5)}),r.tooltip.move()}).onMouseout(function(t){var e=d3.select(this)._groups[0][0].__data__.source,n=d3.select(this)._groups[0][0].__data__.target,i=d3.selectAll(".arc-groups circle").nodes();d3.select(i[e]).attr("r",function(t){return S(t.value,m,k,4.5,8.5)||4.5}),d3.select(i[n]).attr("r",function(t){return S(t.value,m,k,4.5,8.5)||4.5}),r.tooltip.hide()});var w=v.cx,O=v.cy;r.arcDiagram.translate(w||0,O||0).update()}},{key:"configLegend",value:function(){var e=this,i=e.sortedDataCopy;e.legend.data(i[0]).onClick(function(t){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i[0].forEach(function(e){e.key===t.key&&(e.active=!n),i[1].forEach(function(t){e.active==!n&&(t.s!=e.name&&t.t!=e.name||(t.active=!n))})}),e.onDataChange()})}},{key:"buildOption",value:function(t,e){var n=new di(t,e),i=_i;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display;0!==Object.getOwnPropertyNames(e).length&&(this.lineOpacity=e.lineOpacity?e.lineOpacity:this.lineOpacity,this.lineWidth=e.lineWidth?e.lineWidth:this.lineWidth)}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}}]),n}(),pi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","basic-horizontal-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new xn(e.coreGroup),e.overlay=new At(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new an(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._sortValue=null,e._barWidthPercent=.5,e._barCornerRadius=0,e._borderWidth=0,e._borderColor="none",e._fillOpacity=1,e._labelShow=!1,e._positionOptions=["","","",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var n=this,a=n.activeData,t=n.grid,e=n.rectPlot,r=n.tooltip,i=n.overlay,l=n.selectOverlay,o=n.barWidthPercent?n.barWidthPercent:.8,s=n.xScale,u=n.yScale,c=n.widthOfCore,h=n.heightOfCore,d=u.step(),_=[],f=[],p=0;p<n.activeData.length;p++)null==n._labelShow||null==n._positionOptions||null==n._positionChoice||-1==n._positionOptions.indexOf(n._positionChoice)?(_.push(0),f.push(0)):1==n._labelShow&&0==n._positionOptions.indexOf(n._positionChoice)?0<parseFloat(n.activeData[p].value)||0==parseFloat(n.activeData[p].value)?f.push(V(n.activeData[p].value,n._textLabel.fontSize,n._fontFamily)):parseFloat(n.activeData[p].value)<0&&_.push(V(n.activeData[p].value,n._textLabel.fontSize,n._fontFamily)):(_.push(0),f.push(0));Math.min(d3.min(a,function(t){return+t.value}),0);t.width(c-(0==_.length?0:d3.max(_))-(0==f.length?0:d3.max(f))).height(h).xTickLocations(n.xAxis.tickLocations).yTickLocations(n.yAxis.tickLocations).showX(n._gridShowX).showY(n._gridShowY).stroke(n._gridStroke).strokeDasharray(n._gridStrokeDasharray),i.data(u.domain()).isScalePoint(!1).isHorizontal(!0).bandWidth(c-(0==_.length?0:d3.max(_))-(0==f.length?0:d3.max(f))).bandHeight(u.step()).onMouseover(function(t,e){var n=u.domain()[a.length-e-1==-1?1:a.length-e-1==-2?0:a.length-e-1],i=a.filter(function(t){return t.name===n}),o=[];n&&1!=n&&((o=[{text:i[0].valueLabel}]).push({text:(i[0].showLegend?n:"")+": "+i[0].value,color:i[0].color}),l.translate(0,u(n))),r.data(o).update(),l.translate(0,u(n)),r.show()}).onMousemove(function(){r.move(),l.show()}).onMouseout(function(){r.hide(),l.hide()}),l.width(c-(0==_.length?0:d3.max(_))-(0==f.length?0:d3.max(f))).height(u.step()).shadowColor("#ccc").hide(),e.data(a).xScale(s).yScale(u).fontSize(n._fontSize).barCornerRadius(n._barCornerRadius).borderWidth(n._borderWidth).borderColor(n._borderColor).fillOpacity(n._fillOpacity).labelShow(n._labelShow).positionOptions(n._positionOptions).positionChoice(n._positionChoice).rectObj({xFunc:function(t,e){return 0<t.value||0==t.value?n.xScale(0):t.value<0?n.xScale(t.value):void 0},yFunc:function(t,e){return n.yScale.range()[0]-(e*d+(d-d*o)/2+d*o)},widthFunc:function(t){return 0<t.value||0==t.value?0<n.xScale(t.value)-n.xScale(0)?n.xScale(t.value)-n.xScale(0):0:t.value<0?0<n.xScale(0)-n.xScale(t.value)?n.xScale(0)-n.xScale(t.value):0:void 0},heightFunc:function(t){return d*o}}).textObj({xFunc:function(t,e){return n.xScale(t.value)},yFunc:function(t,e){return n.yScale.range()[0]-(e*d+(d-.9*d*o)/2+.7*d*o)},dyFunc:.5*d*o/2+n._textLabel.fontSize/3,colorFunc:function(){return n._textLabel.color},textFunc:function(t){return 0==t.value?"":t.value},fontSize:n._textLabel.fontSize,fontFamily:n._textLabel.fontFamily,labelShow:n._labelShow}),n.coreGroup.call(H,n.yAxis.width+.5,0);var y=n.group.selectAll(".basic-horizontal-bar-chart .axis-y-horizontal .tick text").nodes().filter(function(t,e){return t.__data__=="$-"+e});d3.selectAll(y).remove(),t.update(),l.update(),e.updateHorizontalBar(),i.update(),n.group.selectAll(".plane-grid .grid-x-line").attr("transform","translate("+(0==_.length?0:d3.max(_))+",0 )"),n.group.selectAll(".bands-overlay").attr("transform","translate("+(0==_.length?0:d3.max(_))+",0 )"),n.group.selectAll(".selectOverlay-rect").attr("x",""+(0==_.length?0:d3.max(_)))}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,a=e._xType,r=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e._width-e._marginLeft-e._marginRight,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).xRange(e._xRange).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).yRange(e._yRange).transition(e._transition).duration(e._duration);for(var d=[],_=[],f=0;f<e.activeData.length;f++)null==e._labelShow||null==e._positionOptions||null==e._positionChoice||-1==e._positionOptions.indexOf(e._positionChoice)?(d.push(0),_.push(0)):1==e._labelShow&&0==e._positionOptions.indexOf(e._positionChoice)?0<parseFloat(e.activeData[f].value)||0==parseFloat(e.activeData[f].value)?_.push(V(e.activeData[f].value,e._textLabel.fontSize,e._fontFamily)):parseFloat(e.activeData[f].value)<0&&d.push(V(e.activeData[f].value,e._textLabel.fontSize,e._fontFamily)):(d.push(0),_.push(0));n&&n.titleHeight;var p=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(3*u);t.tickCount(p).compute(),n.compute();var y=(c-n.width-(0==d.length?0:d3.max(d))-(0==_.length?0:d3.max(_)))/t._tickValues.length,g=d3.max(t._tickValues,function(t){return V(t,u,e._fontFamily)}),v=(t._tickShow?t._tickSize+t._tickPadding+(g<y?1.125*t._fontSize:t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-v,0]),n.compute(),i.range([0==d.length?0:d3.max(d),c-n.width-(0==_.length?0:d3.max(_))]),t.compute();var x=n.width,m=h-v,k=n.width;t.translate(x,m).update(),n.translate(k,0).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"computeDomain",value:function(){var t=this.activeData,e=((this._yRange||[]).slice().sort(d3.ascending),t.length?t.map(function(t){return t.name}):[0,1]),n=t.length?[1.1*Math.min(d3.min(t,function(t){return+t.value}),0),1.1*d3.max(t,function(t){return+t.value})]:[0,1];this._yDomain=e,this._xDomain=n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&(this.barWidthPercent=e.barWidthPercent?e.barWidthPercent:this.barWidthPercent,this.barCornerRadius=e.barCornerRadius?e.barCornerRadius:this.barCornerRadius,this.borderWidth=e.borderWidth?e.borderWidth:this.borderWidth,this.borderColor=e.borderColor?e.borderColor:this.borderColor,this.fillOpacity=e.fillOpacity?e.fillOpacity:this.fillOpacity)}}]),n}(),yi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){var i=this,t=i._data,o=i.group;o.selectAll("g").remove();var e=o.append("g").selectAll("g").data(t);e.exit().remove(),e.enter().append("g").merge(e).each(function(t){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").attr("class","stackBars").merge(e).style("fill",function(t){return t.color}).style("fill-opacity",function(t){return i._fillOpacity}).style("stroke",function(t){return i._strokeColor||t.color}).style("stroke-width",function(t){return i._strokeWidth||0}).attr("x",function(t,e){return i._xScale.step()*e+.25*i._xScale.step()}).attr("y",function(t){return 0<t.value||0==t.value?i._yScale(t.total):t.value<0?i._yScale(t.downtotal-t.value):void 0}).attr("width",i._xScale.step()/2).attr("height",function(t){return 0<t.value||0==t.value?0<i._yScale(0)-i._yScale(t.value)?i._yScale(0)-i._yScale(t.value):0:t.value<0?0<i._yScale(t.value)-i._yScale(0)?i._yScale(t.value)-i._yScale(0):0:void 0}),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),o.selectAll(".stackBarTexts").remove();var n=o.append("g").selectAll("g").data(t);n.exit().remove(),n.enter().append("g").merge(n).each(function(t,e){var n=d3.select(this).append("g").attr("class","stackBarTexts").selectAll("text").data(t.data);n.exit().remove(),n.enter().append("text").merge(n).text(function(t){return 0==t.value?"":t.value}).attr("fill",i._textObj.colorFunc).attr("font-size",i._fontSize).style("font-family",i._fontFamily).attr("x",function(t,e){return i._xScale.step()*e+.25*i._xScale.step()}).attr("y",function(t){if(null==i._positionOptions||null==i._positionChoice)return 0;if(0==i._positionOptions.indexOf(i._positionChoice)){if(0<t.value||0==t.value)return i._yScale(t.total)+(i._yScale(0)-i._yScale(t.value))/2+.4*i._fontSize;if(t.value<0)return i._yScale(t.downtotal-t.value)+(i._yScale(t.value)-i._yScale(0))/2+.4*i._fontSize}else if(1==i._positionOptions.indexOf(i._positionChoice)){if(0<t.value||0==t.value)return i._yScale(t.total)+(i._yScale(0)-i._yScale(t.value))-.2*i._fontSize;if(t.value<0)return i._yScale(t.downtotal-t.value)+(i._yScale(t.value)-i._yScale(0))-.2*i._fontSize}}).attr("text-anchor","middle").attr("dx",.25*i._xScale.step()).style("display",function(t){return i._labelShow&&t.textShow?"block":"none"}),0==i._labelShow||null==i._labelShow||null==i._positionOptions||null==i._positionChoice||-1==i._positionOptions.indexOf(i._positionChoice)?o.selectAll(".stackBarTexts").style("display","none"):o.selectAll(".stackBarTexts").style("display","block")});for(var a=o.selectAll(".stackBarTexts text"),r=[],l=[],s=0;s<a._groups[0].length;s++){l.push(s);for(var u=s+1;u<a._groups[0].length;u++){rt(at(d3.select(a._groups[0][s])),at(d3.select(a._groups[0][u])))&&(r.push(s),d3.select(a._groups[0][s]).style("opacity","0"))}}for(var c=new Set(r),h=Array.from(c),d=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(h,l),_=0;_<h.length;_++){for(var f=[],p=0;p<d.length;p++){var y=at(d3.select(a._groups[0][h[_]])),g=at(d3.select(a._groups[0][d[p]]));if(f.push(rt(y,g)),rt(y,g)){if(h[_]==d[p])continue;d3.select(a._groups[0][h[_]]).style("opacity","0")}}0==f.filter(function(t){return 1==t}).length&&d.push(h[_])}for(var v=0;v<d.length;v++)d3.select(a._groups[0][d[v]]).style("opacity","1");return i}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),gi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new yi(e.coreGroup),e.overlay=new At(e.coreGroup),e.clipArea=new bt(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=0;e<(0==n.length?0:n[0].data.length);e++)for(var i=0;i<n.length;i++)parseFloat(n[i].data[e].value);for(var o=0;o<n.length;o++)for(var a=0;a<n[o].data.length;a++)0==o?0<n[o].data[a].value||0==n[o].data[a].value?(n[o].data[a].total=parseFloat(n[o].data[a].value),n[o].data[a].downtotal=0):n[o].data[a].value<0&&(n[o].data[a].downtotal=parseFloat(n[o].data[a].value),n[o].data[a].total=0):0<n[o].data[a].value||0==n[o].data[a].value?(n[o].data[a].total=n[o-1].data[a].total+parseFloat(n[o].data[a].value),n[o].data[a].downtotal=n[o-1].data[a].downtotal):n[o].data[a].value<0&&(n[o].data[a].total=n[o-1].data[a].total,n[o].data[a].downtotal=n[o-1].data[a].downtotal+parseFloat(n[o].data[a].value)),0<n[o].data[a].value||0==n[o].data[a].value?t.yScale(0)-t.yScale(n[o].data[a].value)<t._textLabel.fontSize?n[o].data[a].textShow=!1:n[o].data[a].textShow=!0:n[o].data[a].value<0&&(t.yScale(n[o].data[a].value-t.yScale(0))<t._textLabel.fontSize?n[o].data[a].textShow=!1:n[o].data[a].textShow=!0);var r=n,l=t.grid,s=t.tooltip,u=t.rectPlot,c=t.overlay,h=t.selectOverlay,d=t.clipArea,_=t.xScale,f=t.yScale,p=t.widthOfCore,y=t.heightOfCore,g=1.1*Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.downtotal})}),0);g<0?(t.group.selectAll(".stack-bar-chart .axis-x-line path").attr("transform","translate(0, "+-(f.range()[0]-f(0))+")"),t.group.selectAll(".stack-bar-chart .axis-x-line line").attr("transform","translate(0, "+-(f.range()[0]-f(0))+")")):(t.group.selectAll(".stack-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".stack-bar-chart .axis-x-line line").attr("transform","translate(0,0)")),c.data(_.domain()).isScalePoint(!1).bandWidth(_.step()).bandHeight(y).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(n[0].tooltipValueShow?n[0].value:""),color:t.color})}),s.data(o).update(),h.translate(_(i),0),s.show()}).onMousemove(function(){s.move(),h.show()}).onMouseout(function(){s.hide(),h.hide()}),u.data(r).xScale(_).yScale(f).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).textObj({colorFunc:function(){return t._textLabel.color}}).fillOpacity(1),l.width(p).height(y).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),h.width(_.step()).height(y).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)"),0!=t._clipShow.length?d.width(p).height(y).paddingVertical([0,0]).transition(t._transition).duration(t._duration):d.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+d.id+")"),d.update();var v=t.group.selectAll(".stack-bar-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(v).remove(),u.update(),h.update(),c.update(),l.update(),g<0?(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",_.range()[0]).attr("y1",f.range()[0]).attr("x2",_.range()[1]).attr("y2",f.range()[0]).attr("stroke","rgb(233, 233, 233)")):t.coreGroup.selectAll(".fake-x-line").remove()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"computeDomain",value:function(){for(var t=this.activeData,e=0;e<t.length;e++)for(var n=0;n<t[e].data.length;n++)0==e?0<t[e].data[n].value||0==t[e].data[n].value?(t[e].data[n].total=parseFloat(t[e].data[n].value),t[e].data[n].downtotal=0):t[e].data[n].value<0&&(t[e].data[n].downtotal=parseFloat(t[e].data[n].value),t[e].data[n].total=0):0<t[e].data[n].value||0==t[e].data[n].value?(t[e].data[n].total=t[e-1].data[n].total+parseFloat(t[e].data[n].value),t[e].data[n].downtotal=t[e-1].data[n].downtotal):t[e].data[n].value<0&&(t[e].data[n].total=t[e-1].data[n].total,t[e].data[n].downtotal=t[e-1].data[n].downtotal+parseFloat(t[e].data[n].value));var i=this._yRange||[],o=t.length?t[0].data.map(function(t){return t.name}):[0,1],a=t.length?[1.1*Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.downtotal})}),0),1.1*Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total+1})}),0)]:[0,1];this._xDomain=o,this._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}}]),n}(),vi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-horizontal-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){var i=this,t=i._data,o=i.group;o.selectAll(".stackHorizontalBar").remove();var e=o.append("g").selectAll("g").data(t);e.exit().remove(),e.enter().append("g").merge(e).each(function(t){var e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").attr("class","stackHorizontalBar").merge(e).style("fill",function(t){return t.color}).style("fill-opacity",function(t){return i._fillOpacity}).style("stroke",function(t){return i._strokeColor||t.color}).style("stroke-width",function(t){return i._strokeWidth||0}).attr("y",function(t,e){return i._yScale(t.name)+i._yScale.step()*(1-i._barWidthPercent)/2}).attr("x",function(t){return 0<t.value||0==t.value?i._xScale(t.total-t.value):t.value<0?i._xScale(t.downtotal):void 0}).attr("height",i._yScale.step()*i._barWidthPercent).attr("width",function(t){return 0<t.value||0==t.value?Math.abs(i._xScale(0)-i._xScale(t.value)):t.value<0?Math.abs(i._xScale(t.value)-i._xScale(0)):void 0}),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),o.selectAll(".stackHorizontalBarTexts").remove();var n=o.append("g").selectAll("g").data(t);n.exit().remove(),n.enter().append("g").merge(n).each(function(t,e){var n=d3.select(this).append("g").attr("class","stackHorizontalBarTexts").selectAll("text").data(t.data);n.exit().remove(),n.enter().append("text").merge(n).text(function(t){return 0==t.value?"":t.value}).attr("fill",i._textObj.colorFunc).attr("font-size",i._fontSize).style("font-family",i._fontFamily).attr("text-anchor","start").attr("y",function(t,e){return i._yScale(t.name)+.75*i._yScale.step()}).attr("x",function(t,e){if(null==i._labelShow||null==i._positionOptions||null==i._positionChoice)return 0;if(1==i._positionOptions.indexOf(i._positionChoice)){if(0<t.value||0==t.value)return i._xScale(t.total-t.value)+.3*i._fontSize;if(t.value<0)return i._xScale(t.downtotal)+.3*i._fontSize}else if(0==i._positionOptions.indexOf(i._positionChoice)){if(d3.selectAll(".stackHorizontalBarTexts text").attr("text-anchor","middle"),0<t.value||0==t.value)return i._xScale(t.total-t.value)+Math.abs(i._xScale(0)-i._xScale(t.value))/2;if(t.value<0)return i._xScale(t.downtotal)+Math.abs(i._xScale(t.value)-i._xScale(0))/2}}).attr("dy",-(i._yScale.step()/4-i._fontSize/2.7)).style("display",i._labelShow?"block":"none"),null!=i._labelShow&&null!=i._positionOptions&&null!=i._positionChoice&&-1!=i._positionOptions.indexOf(i._positionChoice)||o.selectAll(".stackHorizontalBarTexts").style("display","none")});for(var a=o.selectAll(".stackHorizontalBarTexts text"),r=[],l=[],s=0;s<a._groups[0].length;s++){l.push(s);for(var u=s+1;u<a._groups[0].length;u++){rt(at(d3.select(a._groups[0][s])),at(d3.select(a._groups[0][u])))&&(r.push(s),d3.select(a._groups[0][s]).style("opacity","0"))}}for(var c=new Set(r),h=Array.from(c),d=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(h,l),_=0;_<h.length;_++){for(var f=[],p=0;p<d.length;p++){var y=at(d3.select(a._groups[0][h[_]])),g=at(d3.select(a._groups[0][d[p]]));if(f.push(rt(y,g)),rt(y,g)){if(h[_]==d[p])continue;d3.select(a._groups[0][h[_]]).style("opacity","0")}}0==f.filter(function(t){return 1==t}).length&&d.push(h[_])}for(var v=0;v<d.length;v++)d3.select(a._groups[0][d[v]]).style("opacity","1");return i}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=parseFloat(t),this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return ar}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),xi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stack-horizontal-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new vi(e.coreGroup),e.overlay=new At(e.coreGroup),e.clipArea=new bt(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new an(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=1,e._yScaleHeight=1.05,e._labelShow=!1,e._barWidthPercent=.5,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=0;e<(0==n.length?0:n[0].data.length);e++)for(var i=0;i<n.length;i++)parseFloat(n[i].data[e].value);for(var o=0;o<n.length;o++)for(var a=0;a<n[o].data.length;a++)0==o?0<n[o].data[a].value||0==n[o].data[a].value?(n[o].data[a].total=parseFloat(n[o].data[a].value),n[o].data[a].downtotal=0):n[o].data[a].value<0&&(n[o].data[a].downtotal=parseFloat(n[o].data[a].value),n[o].data[a].total=0):0<n[o].data[a].value||0==n[o].data[a].value?(n[o].data[a].total=n[o-1].data[a].total+parseFloat(n[o].data[a].value),n[o].data[a].downtotal=n[o-1].data[a].downtotal):n[o].data[a].value<0&&(n[o].data[a].total=n[o-1].data[a].total,n[o].data[a].downtotal=n[o-1].data[a].downtotal+parseFloat(n[o].data[a].value));var r=n,l=t.grid,s=t.tooltip,u=t.rectPlot,c=t.overlay,h=t.selectOverlay,d=t.clipArea,_=t.xScale,f=t.yScale,p=t.widthOfCore,y=t.heightOfCore,g=1.1*Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.downtotal})}),0);g<0?(d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+-(_.range()[0]-_(0))+",0)"),d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+-(_.range()[0]-_(0))+",0)")):(d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,0)")),c.data(f.domain()).isScalePoint(!1).isHorizontal(!0).bandWidth(p).bandHeight(f.step()).onMouseover(function(t,e){var i=f.domain()[f.domain().length-e-1==-1?1:f.domain().length-e-1==-2?0:f.domain().length-e-1],o=[{text:i=="&-"+(f.domain().length-e)?"":i}];i&&1!=i&&(n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(n[0].tooltipValueShow?n[0].value:""),color:t.color})}),h.translate(0,f(i))),s.data(o).update(),h.translate(0,f(i)),s.show()}).onMousemove(function(){s.move(),h.show()}).onMouseout(function(){s.hide(),h.hide()}),u.data(r).xScale(_).yScale(f).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).barWidthPercent(t._barWidthPercent).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).textObj({colorFunc:function(){return t._textLabel.color}}).fillOpacity(1),l.width(p).height(y).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),h.width(p).height(f.step()).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)"),0!=t._clipShow.length?d.width(p).height(y).paddingVertical([0,0]).transition(t._transition).duration(t._duration):d.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+d.id+")"),d.update();var v=t.group.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(v).remove(),u.update(),h.update(),c.update(),l.update(),g<0?(t.coreGroup.selectAll(".fake-y-line").remove(),this.coreGroup.append("g").attr("class","fake-y-line").append("line").attr("x1",_.range()[0]).attr("y1",f.range()[0]).attr("x2",_.range()[0]).attr("y2",f.range()[1]).attr("stroke","rgb(233, 233, 233)")):t.coreGroup.selectAll(".fake-y-line").remove()}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,a=e._xType,r=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e._width-e._marginLeft-e._marginRight,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).xRange(e._xRange).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).yRange(e._yRange).transition(e._transition).duration(e._duration);n&&n.titleHeight;var d=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(3*u);t.tickCount(d).compute(),n.compute();var _=(c-n.width)/t._tickValues.length,f=d3.max(t._tickValues,function(t){return V(t,u,e._fontFamily)}),p=(t._tickShow?t._tickSize+t._tickPadding+(f<.8*_?1.125*t._fontSize:1.2*t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-p,0]),i.range([0,c-n.width]),t.compute();var y=n.width,g=h-p,v=n.width;t.translate(y,g).update(),n.translate(v,0).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){for(var t=this.activeData,e=0;e<t.length;e++)for(var n=0;n<t[e].data.length;n++)0==e?0<t[e].data[n].value||0==t[e].data[n].value?(t[e].data[n].total=parseFloat(t[e].data[n].value),t[e].data[n].downtotal=0):t[e].data[n].value<0&&(t[e].data[n].downtotal=parseFloat(t[e].data[n].value),t[e].data[n].total=0):0<t[e].data[n].value||0==t[e].data[n].value?(t[e].data[n].total=t[e-1].data[n].total+parseFloat(t[e].data[n].value),t[e].data[n].downtotal=t[e-1].data[n].downtotal):t[e].data[n].value<0&&(t[e].data[n].total=t[e-1].data[n].total,t[e].data[n].downtotal=t[e-1].data[n].downtotal+parseFloat(t[e].data[n].value));var i=this._xRange||[],o=t.length?t[0].data.map(function(t){return t.name}):[0,1],a=t.length?[1.1*Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.downtotal})}),0),Math.max(1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total})}),0)]:[0,1];this._xDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])],this._yDomain=o}}]),n}(),mi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouped-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){for(var o=this,a=o._data,t=[],e=0;e<a.length;e++)for(var n=0;n<a[e].data.length;n++)t.push(Number(a[e].data[n].value));var r=et(t,o._fontSize,o._fontFamily),l=o.group;l.selectAll(".group-bar-rects").remove(),l.selectAll(".group-bar-texts").remove();var i=l.append("g").selectAll("g").data(a,function(t){return t.name});i.exit().remove(),i.enter().append("g").merge(i).each(function(t,n){var i=2*o._xScale.step()/3,e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").attr("class","group-bar-rects").merge(e).style("fill",function(t){return t.color}).style("fill-opacity",function(t){return o._fillOpacity}).style("stroke",function(t){return o._strokeColor||t.color}).style("stroke-width",function(t){return o._strokeWidth||0}).attr("x",function(t,e){return(i/a.length+(3<a.length||1==a.length?0:1))*n+i/4+o._xScale.step()*e}).attr("y",function(t){return t.value<0?o._yScale(0):0<t.value?o._yScale(t.value):void 0}).attr("width",0<i/a.length?i/a.length:0).attr("height",function(t){return t.value<0?o._yScale(t.value)-o._yScale(0)<0?0:o._yScale(t.value)-o._yScale(0):0<t.value?o._yScale(0)-o._yScale(t.value)<0?0:o._yScale(0)-o._yScale(t.value):void 0}),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)});var s=2*o._xScale.step()/3,u=0<s/a.length?s/a.length:0,c=l.append("g").selectAll("g").data(a,function(t){return t.name});if(c.exit().remove(),c.enter().append("g").merge(c).each(function(t,n){var e=d3.select(this).attr("class","groupedBarTexts").selectAll("text").data(t.data);e.exit().remove();var i=e.enter().append("text").attr("class","group-bar-texts").merge(e).text(function(t){return 0==t.value?"":t.value}).attr("fill",o._textObj.colorFunc).style("font-size",o._fontSize).style("font-family",o._fontFamily).attr("x",function(t,e){return(s/a.length+(3<a.length||1==a.length?0:1))*n+s/4+o._xScale.step()*e+(0<s/a.length?s/a.length:0)/2}).attr("text-anchor","middle").attr("y",function(t){return null==o._positionOptions||null==o._positionChoice?o._yScale(t.value):0==o._positionOptions.indexOf(o._positionChoice)?t.value<0?o._yScale(0)-.3*o._fontSize:o._yScale(t.value)-.3*o._fontSize:1==o._positionOptions.indexOf(o._positionChoice)?0<t.value?o._yScale(0)-.3*o._fontSize:o._yScale(t.value)-.3*o._fontSize:void 0}).style("display",o._labelShow?"block":"none");null==o._positionOptions||null==o._positionChoice||u<r&&1==o._positionOptions.indexOf(o._positionChoice)&&i.attr("transform",function(t,e){return 0<t.value?"rotate(-90 "+((s/a.length+(3<a.length||1==a.length?0:1))*n+s/4+o._xScale.step()*e+(0<s/a.length?s/a.length:0)/2||0)+"\n                         "+(o._yScale(t.value)+o._yScale(0)-o._yScale(t.value)-.65*o._fontSize)+" )":"rotate(-90 "+((s/a.length+(3<a.length||1==a.length?0:1))*n+s/4+o._xScale.step()*e+(0<s/a.length?s/a.length:0)/2||0)+"\n                         "+(o._yScale(t.value)-.65*o._fontSize)+" )"}).attr("text-anchor","start"),0==o._labelShow||null==o._labelShow||null==o._positionOptions||null==o._positionChoice||-1==o._positionOptions.indexOf(o._positionChoice)?l.selectAll(".groupedBarTexts").style("display","none"):l.selectAll(".groupedBarTexts").style("display","block")}),null==o._positionOptions||null==o._positionChoice||-1==o._positionOptions.indexOf(o._positionChoice))l.selectAll(".groupedBarTexts").style("display","none");else if(u<r&&1==o._positionOptions.indexOf(o._positionChoice)){for(var h=l.selectAll(".group-bar-texts"),d=[],_=[],f=0;f<h._groups[0].length;f++){_.push(f);for(var p=f+1;p<h._groups[0].length;p++){var y=at(d3.select(h._groups[0][f])),g=at(d3.select(h._groups[0][p])),v=y.width;y.width=y.height,y.height=v;var x=g.width;g.width=g.height,g.height=x,rt(y,g)&&(d.push(f),d3.select(h._groups[0][f]).style("opacity","0"))}}for(var m=new Set(d),k=Array.from(m),b=Y(k,_),S=0;S<k.length;S++){for(var w=[],O=0;O<b.length;O++){var C=at(d3.select(h._groups[0][k[S]])),A=at(d3.select(h._groups[0][b[O]])),F=C.width;C.width=C.height,C.height=F;var L=A.width;if(A.width=A.height,A.height=L,w.push(rt(C,A)),rt(C,A)){if(k[S]==b[O])continue;d3.select(h._groups[0][k[S]]).style("opacity","0")}}0==w.filter(function(t){return 1==t}).length&&b.push(k[S])}for(var M=0;M<b.length;M++)d3.select(h._groups[0][b[M]]).style("opacity","1")}else{for(var z=l.selectAll(".group-bar-texts"),R=[],T=[],P=0;P<z._groups[0].length;P++){T.push(P);for(var W=P+1;W<z._groups[0].length;W++){rt(at(d3.select(z._groups[0][P])),at(d3.select(z._groups[0][W])))&&(R.push(P),d3.select(z._groups[0][P]).style("opacity","0"))}}for(var D=new Set(R),j=Array.from(D),N=Y(j,T),G=0;G<j.length;G++){for(var B=[],E=0;E<N.length;E++){var H=at(d3.select(z._groups[0][j[G]])),V=at(d3.select(z._groups[0][N[E]]));if(B.push(rt(H,V)),rt(H,V)){if(j[G]==N[E])continue;d3.select(z._groups[0][j[G]]).style("opacity","0")}}0==B.filter(function(t){return 1==t}).length&&N.push(j[G])}for(var I=0;I<N.length;I++)d3.select(z._groups[0][N[I]]).style("opacity","1")}function Y(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}return o}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),ki=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouped-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new mi(e.coreGroup),e.overlay=new At(e.coreGroup),e.clipArea=new bt(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var t=this,n=t.activeData,e=n,i=t.grid,r=t.tooltip,o=t.rectPlot,a=t.overlay,l=t.selectOverlay,s=t.clipArea,u=t.xScale,c=t.yScale,h=t.widthOfCore,d=t.heightOfCore,_=1.1*Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.value})}),0);_<0?(t.group.selectAll(".grouped-bar-chart .axis-x-line path").attr("transform","translate(0, "+-(c.range()[0]-c(0))+")"),t.group.selectAll(".grouped-bar-chart .axis-x-line line").attr("transform","translate(0, "+-(c.range()[0]-c(0))+")")):(t.group.selectAll(".grouped-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".grouped-bar-chart .axis-x-line line").attr("transform","translate(0,0)")),a.data(u.domain()).isScalePoint(!1).bandWidth(u.step()).bandHeight(d).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(n[0].tooltipValueShow?n[0].value:""),color:t.color})}),r.data(o).update(),r.show()}).onMousemove(function(){r.move(),l.show()}).onMouseout(function(){r.hide(),l.hide()}),o.data(e).xScale(u).yScale(c).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).textObj({colorFunc:function(){return t._textLabel.color}}).fillOpacity(1),i.width(h).height(d).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),s.width(h).height(d).paddingVertical([0,0]).transition(t._transition).duration(t._duration),l.width(u.step()).height(d).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)"),0!=t._clipShow.length?(s.width(h).height(d).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+s.id+")"),s.update()):s.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+s.id+")"),s.update();var f=t.group.selectAll(".grouped-bar-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(f).remove(),o.update(),l.update(),a.update(),i.update(),_<0?(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",u.range()[0]).attr("y1",c.range()[0]).attr("x2",u.range()[1]).attr("y2",c.range()[0]).attr("stroke","rgb(233, 233, 233)")):t.coreGroup.selectAll(".fake-x-line").remove()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"computeDomain",value:function(){var t=this.activeData,e=this._yRange||[],n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[1.1*Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?isNaN(parseFloat(e[0]))?i[1]:i[1]<e[0]?1.5*e[0]:i[1]:parseFloat(e[1])]}}]),n}(),bi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","negative-horizontal-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){var v=this,x=v._data,m=v.group;m.selectAll(".negativeHoizontalBar").remove(),m.selectAll(".negativeHoizontalBarTexts").remove();var t=m.selectAll("g").data(x);t.exit().remove(),t.enter().append("g").merge(t).each(function(t,n){var i=2*v._yScale.step()/3,e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").attr("class","negativeHoizontalBar").merge(e).style("fill",function(t){return t.color}).style("fill-opacity",function(t){return v._fillOpacity}).style("stroke",function(t){return v._strokeColor||t.color}).style("stroke-width",function(t){return v._strokeWidth||0}).attr("y",function(t,e){return Math.abs(v._yScale.range()[0]-v._yScale.range()[1])-((i/x.length+(3<x.length||1==x.length?0:1))*n+i/4+v._yScale.step()*e)-(0<i/x.length?i/x.length:0)}).attr("x",function(t){return 0<t.value?v._xScale(0):t.value<0?v._xScale(t.value):void 0}).attr("height",0<i/x.length?i/x.length:0).attr("width",function(t){return 0<t.value?v._xScale(t.value)-v._xScale(0)<0?0:v._xScale(t.value)-v._xScale(0):t.value<0?v._xScale(0)-v._xScale(t.value)<0?0:v._xScale(0)-v._xScale(t.value):void 0}),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)});var e=m.append("g").selectAll("g").data(x);return e.exit().remove(),e.enter().append("g").merge(e).each(function(t,n){var i=2*v._yScale.step()/3,e=d3.select(this).append("g").attr("class","negativeHoizontalBarTexts").selectAll("text").data(t.data);e.exit().remove(),e.enter().append("text").merge(e).text(function(t){return 0==t.value?"":t.value}).attr("fill",v._textObj.colorFunc).attr("font-size",v._fontSize).style("font-family",v._fontFamily).attr("text-anchor","start").attr("x",function(t){return 0<t.value?v._xScale(0):t.value<0?v._xScale(t.value):void 0}).attr("y",function(t,e){return Math.abs(v._yScale.range()[0]-v._yScale.range()[1])-((i/x.length+(3<x.length||1==x.length?0:1))*n+i/4+v._yScale.step()*e)-(0<i/x.length?i/x.length:0)}).attr("dy",(0<i/x.length?i/x.length:0)/2+v._fontSize/3).attr("dx",function(t,e){if(null==v._positionOptions||null==v._positionChoice)return 0;if(0==v._positionOptions.indexOf(v._positionChoice)){if(0<t.value)return v._xScale(t.value)-v._xScale(0)+.3*v._fontSize;if(t.value<0)return.3*-v._fontSize}else if(1==v._positionOptions.indexOf(v._positionChoice)){if(0<t.value)return.3*v._fontSize;if(t.value<0)return v._xScale(0)-v._xScale(t.value)-.3*v._fontSize}}).style("display",v._labelShow?"block":"none"),d3.selectAll(d3.selectAll(".negativeHoizontalBarTexts text").nodes().filter(function(t){return t.__data__.value<0})).attr("text-anchor","end"),null!=v._labelShow&&0!=v._labelShow&&null!=v._positionOptions&&null!=v._positionChoice&&-1!=v._positionOptions.indexOf(v._positionChoice)||d3.selectAll(".negativeHoizontalBarTexts").style("display","none");for(var o=m.selectAll(".negativeHoizontalBarTexts text"),a=[],r=[],l=0;l<o._groups[0].length;l++){r.push(l);for(var s=l+1;s<o._groups[0].length;s++){rt(at(d3.select(o._groups[0][l])),at(d3.select(o._groups[0][s])))&&(a.push(l),d3.select(o._groups[0][l]).style("opacity","0"))}}for(var u=new Set(a),c=Array.from(u),h=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(c,r),d=0;d<c.length;d++){for(var _=[],f=0;f<h.length;f++){var p=at(d3.select(o._groups[0][c[d]])),y=at(d3.select(o._groups[0][h[f]]));if(_.push(rt(p,y)),rt(p,y)){if(c[d]==h[f])continue;d3.select(o._groups[0][c[d]]).style("opacity","0")}}0==_.filter(function(t){return 1==t}).length&&h.push(c[d])}for(var g=0;g<h.length;g++)d3.select(o._groups[0][h[g]]).style("opacity","1")}),v}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Si=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","grouped-horizontal-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new bi(e.coreGroup),e.overlay=new At(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new an(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=n,i=t.grid,a=t.tooltip,o=t.rectPlot,r=t.overlay,l=t.selectOverlay,s=t.xScale,u=t.yScale,c=t.widthOfCore,h=t.heightOfCore,d=d3.min(n,function(t){return d3.min(t.data,function(t){return+t.value})}),_=[],f=[],p=0;p<t.activeData.length;p++)for(var y=0;y<t.activeData[p].data.length;y++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(f.push(0),_.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?0<parseFloat(t.activeData[p].data[y].value)||0==parseFloat(t.activeData[p].data[y].value)?_.push(V(t.activeData[p].data[y].value,t._fontSize,t._fontFamily)):parseFloat(t.activeData[p].data[y].value)<0&&f.push(V(t.activeData[p].data[y].value,t._fontSize,t._fontFamily)):(f.push(0),_.push(0));d<0?(d3.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+(-(s.range()[0]-s(0))+(0==f.length?0:d3.max(f)))+",0)"),d3.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+(-(s.range()[0]-s(0))+(0==f.length?0:d3.max(f)))+","+-u.step()/2+")")):(d3.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),d3.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,"+-u.step()/2+")")),r.data(u.domain()).isScalePoint(!1).isHorizontal(!0).bandWidth(c-(0==f.length?0:d3.max(f))-(0==_.length?0:d3.max(_))).bandHeight(u.step()).onMouseover(function(t,e){var i=u.domain()[u.domain().length-e-1==-1?1:u.domain().length-e-1==-2?0:u.domain().length-e-1],o=[{text:i=="&-"+(u.domain().length-e)?"":i}];i&&1!=i&&(n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(n[0].tooltipValueShow?n[0].value:""),color:t.color})}),l.translate(0,u(i))),a.data(o).update(),a.show()}).onMousemove(function(){a.move(),l.show()}).onMouseout(function(){a.hide(),l.hide()}),o.data(e).xScale(s).yScale(u).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).textObj({colorFunc:function(){return t._textLabel.color}}).fillOpacity(1),i.width(c-(0==f.length?0:d3.max(f))-(0==_.length?0:d3.max(_))).height(h).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),l.width(c-(0==f.length?0:d3.max(f))-(0==_.length?0:d3.max(_))).height(u.step()).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)");var g=t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(g).remove(),o.update(),l.update(),r.update(),i.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+(0==f.length?0:d3.max(f))),t.group.selectAll(".bands-overlay").attr("transform","translate("+(0==f.length?0:d3.max(f))+",0 )"),t.group.selectAll(".plane-grid .grid-x-line").attr("transform","translate("+(0==f.length?0:d3.max(f))+",0 )")}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,a=e._xType,r=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e._width-e._marginLeft-e._marginRight,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).xRange(e._xRange).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).yRange(e._yRange).transition(e._transition).duration(e._duration);n&&n.titleHeight;e.data().forEach(function(t){t.data.forEach(function(t){})});for(var d=[],_=[],f=0;f<e.activeData.length;f++)for(var p=0;p<e.activeData[f].data.length;p++)null==e._labelShow||null==e._positionOptions||null==e._positionChoice||-1==e._positionOptions.indexOf(e._positionChoice)?(_.push(0),d.push(0)):1==e._labelShow&&0==e._positionOptions.indexOf(e._positionChoice)?0<parseFloat(e.activeData[f].data[p].value)||0==parseFloat(e.activeData[f].data[p].value)?d.push(V(e.activeData[f].data[p].value,e._textLabel.fontSize,e._textLabel.fontFamily)):parseFloat(e.activeData[f].data[p].value)<0&&_.push(V(e.activeData[f].data[p].value,e._textLabel.fontSize,e._textLabel.fontFamily)):(_.push(0),d.push(0));var y=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(3*u);t.tickCount(y).compute(),n.compute();var g=Math.abs(0==_.length?0:d3.max(_)-(c-n.width-(0==d.length?0:d3.max(d))))/t._tickValues.length,v=d3.max(t._tickValues.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,u,e._fontFamily)}),x=(t._tickShow?t._tickSize+t._tickPadding+(v<.8*g?1.125*t._fontSize:1.2*t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-x,0]),n.compute(),i.range([0==_.length?0:d3.max(_),c-n.width-(0==d.length?0:d3.max(d))]),t.compute();var m=n.width,k=h-x,b=n.width;t.translate(m,k).update(),n.translate(b,0).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yRange,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[1.05*Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})}),0)]:[0,1];this._xDomain=n,this._yDomain=e}}]),n}(),wi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","negative-horizontal-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new bi(e.coreGroup),e.overlay=new At(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new an(e.mainGroup),e.yAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._sortValue=0,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=n,i=t.grid,a=t.tooltip,o=t.rectPlot,r=t.overlay,l=t.selectOverlay,s=t.xScale,u=t.yScale,c=t.widthOfCore,h=t.heightOfCore,d=d3.min(n,function(t){return d3.min(t.data,function(t){return+t.value})}),_=[],f=[],p=0;p<t.activeData.length;p++)for(var y=0;y<t.activeData[p].data.length;y++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(f.push(0),_.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?0<parseFloat(t.activeData[p].data[y].value)||0==parseFloat(t.activeData[p].data[y].value)?_.push(V(t.activeData[p].data[y].value,t._fontSize,t._fontFamily)):parseFloat(t.activeData[p].data[y].value)<0&&f.push(V(t.activeData[p].data[y].value,t._fontSize,t._fontFamily)):(f.push(0),_.push(0));d<0?(d3.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+(-(s.range()[0]-s(0))+(0==f.length?0:d3.max(f)))+",0)"),d3.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+(-(s.range()[0]-s(0))+(0==f.length?0:d3.max(f)))+","+-u.step()/2+")")):(d3.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),d3.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,"+-u.step()/2+")")),r.data(u.domain()).isScalePoint(!1).isHorizontal(!0).bandWidth(c-(0==f.length?0:d3.max(f))-(0==_.length?0:d3.max(_))).bandHeight(u.step()).onMouseover(function(t,e){var i=u.domain()[u.domain().length-e-1==-1?1:u.domain().length-e-1==-2?0:u.domain().length-e-1],o=[{text:i=="&-"+(u.domain().length-e)?"":i}];i&&1!=i&&(n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(n[0].tooltipValueShow?n[0].value:""),color:t.color})}),l.translate(0,u(i))),a.data(o).update(),l.translate(0,u(i)),a.show()}).onMousemove(function(){a.move(),l.show()}).onMouseout(function(){a.hide(),l.hide()}),o.data(e).xScale(s).yScale(u).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).textObj({colorFunc:function(){return t._textLabel.color}}).fillOpacity(1),i.width(c-(0==f.length?0:d3.max(f))-(0==_.length?0:d3.max(_))).height(h).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),l.width(c-(0==f.length?0:d3.max(f))-(0==_.length?0:d3.max(_))).height(u.step()).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)");var g=t.group.selectAll(".negative-horizontal-bar-chart .axis-y-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(g).remove(),o.update(),l.update(),r.update(),i.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+(0==f.length?0:d3.max(f))),t.group.selectAll(".bands-overlay").attr("transform","translate("+(0==f.length?0:d3.max(f))+",0 )"),t.group.selectAll(".plane-grid .grid-x-line").attr("transform","translate("+(0==f.length?0:d3.max(f))+",0 )"),d<0?(t.coreGroup.selectAll(".fake-y-line").remove(),this.coreGroup.append("g").attr("class","fake-y-line").append("line").attr("x1",s.range()[0]).attr("y1",u.range()[0]).attr("x2",s.range()[0]).attr("y2",u.range()[1]).attr("stroke","rgb(233, 233, 233)")):t.coreGroup.selectAll(".fake-y-line").remove()}},{key:"updateAxis",value:function(){var e=this;e.computeDomain();var t=e.xAxis,n=e.yAxis,i=e.xScale,o=e.yScale,a=e._xType,r=e._yType,l=e._xOrient,s=e._yOrient,u=e._fontSize,c=e._width-e._marginLeft-e._marginRight,h=e.heightOfMainGroup;i.domain(e._xDomain),t.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(e._xTitle).tickShow(e._xTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).xRange(e._xRange).transition(e._transition).duration(e._duration),o.domain(e._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(e._yTitle).tickShow(e._yTickShow).lineStroke(e._axisLineStroke).fontSize(u).fontColor(e._fontColor).fontFamily(e._fontFamily).yRange(e._yRange).transition(e._transition).duration(e._duration);n&&n.titleHeight;e.data().forEach(function(t){t.data.forEach(function(t){})});for(var d=[],_=[],f=0;f<e.activeData.length;f++)for(var p=0;p<e.activeData[f].data.length;p++)null==e._labelShow||null==e._positionOptions||null==e._positionChoice||-1==e._positionOptions.indexOf(e._positionChoice)?(_.push(0),d.push(0)):1==e._labelShow&&0==e._positionOptions.indexOf(e._positionChoice)?0<parseFloat(e.activeData[f].data[p].value)||0==parseFloat(e.activeData[f].data[p].value)?d.push(V(e.activeData[f].data[p].value,e._textLabel.fontSize,e._textLabel.fontFamily)):parseFloat(e.activeData[f].data[p].value)<0&&_.push(V(e.activeData[f].data[p].value,e._textLabel.fontSize,e._textLabel.fontFamily)):(_.push(0),d.push(0));var y=e._tickCount?e._tickCount:(c-n.allowedMaxTextWidth())/(3*u);t.tickCount(y).compute(),n.compute();var g=Math.abs(0==_.length?0:d3.max(_)-(c-n.width-(0==d.length?0:d3.max(d))))/t._tickValues.length,v=d3.max(t._tickValues.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,u,e._fontFamily)}),x=(t._tickShow?t._tickSize+t._tickPadding+(v<.8*g?1.125*t._fontSize:1.2*t._tickTextHeight):0)+(t._title&&t._titleShow?t._titlePadding+1.25*t._fontSize:0);o.range([h-x,0]),n.compute(),i.range([0==_.length?0:d3.max(_),c-n.width-(0==d.length?0:d3.max(d))]),t.compute();var m=n.width,k=h-x,b=n.width;t.translate(m,k).update(),n.translate(b,0).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=_;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yRange,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[1.05*Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*Math.max(d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})}),0)]:[0,1];this._xDomain=n,this._yDomain=e}}]),n}(),Oi="axis-group",Ci="y-mix-title",Ai=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y-mix"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e._tickPadding=2,e}return u(n,ht),l(n,[{key:"update",value:function(){var n=this,i=n._orient,t=n._scaleFunc,e=n.group,o=n._fontSize,a=n._tickValueTexts,r=void 0;r=n.axisFunc="right"===i?d3.axisRight(t):d3.axisLeft(t);var l=null;"number"===n._type&&n._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),r.tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding).tickFormat(l),e.select(".axis-group").remove();var s=e.select("."+Oi).empty()?e.append("g").attr("class",Oi):e.select("."+Oi);s.transition().duration(n._transition?n._duration:0).call(r).on("start",function(){s.selectAll(".tick text").remove(),s.selectAll(".tick").append("text").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dx",function(t,e){return"left"==i?.6*-o:"right"==i?.6*o:void 0}).attr("dy",.4*o).text(function(t,e){return a[e]+(n._unit?n._unit:"")}),s.selectAll(".tick line").style("stroke",n._lineStroke).style("display","none"),s.select("path").style("stroke",n._lineStroke).style("display","none")});var u=Math.abs(t.range()[0]-t.range()[1]);if(n._titleShow&&n._title){var c=e.select("."+Ci).empty()?e.append("g").attr("class",Ci):e.select("."+Ci),h=c.select("text").empty()?c.append("text"):c.select("text");V(n._title,o,n._fontFamily);c.call(H,-(this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),u/2),h.attr("y",-5).style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(n._title),"second"==n._times&&(c.call(H,this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0,u/2),h.attr("y",-5).style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("transform","rotate(90)").style("text-anchor","middle").text(n._title))}else e.select("."+Ci).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,a=e._type,r=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===a?o.domain():o.ticks(e._tickCount);for(var s=0;s<t.length;s++)t[s]=t[s]+(e._unit?e._unit:"");var u=d3.max(t,function(t){return V(t,r,e._fontFamily)});return t="category"===a?o.domain():o.ticks(e._tickCount),u<=l?(n=t,i=u):(n=t.map(function(t){return I(t,l,r,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"times",value:function(t){return arguments.length?(this._times=t,this):this._times}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth+(this._title?1.125*this._fontSize+11:0):this._titleShow&&this._title?1.125*this._fontSize+11:0),t}}]),n}(),Fi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","mix-line-bar-rect"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){for(var o=this,a=o._data,t=[],e=0;e<a.length;e++)for(var n=0;n<a[e].data.length;n++)t.push(Number(a[e].data[n].value));et(t,o._fontSize,o._fontFamily);var i=o.group;i.selectAll("g").remove();var r=i.append("g").selectAll("g").data(a,function(t){return t.name});return r.exit().remove(),r.enter().append("g").attr("class","mix-line-bar-bar-rects").merge(r).each(function(t,n){var i=2*o._xScale.step()/3,e=d3.select(this).selectAll("rect").data(t.data);e.exit().remove(),e.enter().append("rect").merge(e).style("fill",function(t){return o._fillColor||t.color}).style("fill-opacity",function(t){return o._fillOpacity}).style("stroke",function(t){return o._strokeColor||t.color}).style("stroke-width",function(t){return o._strokeWidth||0}).attr("x",function(t,e){return(i/a.length+(3<a.length||1==a.length?0:1))*n+i/4+o._xScale.step()*e}).attr("y",function(t){return t.value<0?o._yScale(0):0<t.value?o._yScale(t.value):void 0}).attr("width",0<i/a.length?i/a.length:0).attr("height",function(t){return t.value<0?o._yScale(t.value)-o._yScale(0)<0?0:o._yScale(t.value)-o._yScale(0):0<t.value?o._yScale(0)-o._yScale(t.value)<0?0:o._yScale(0)-o._yScale(t.value):void 0}),e.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}),o}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}(),Li=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","mix-line-bar-text"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e}return u(n,A),l(n,[{key:"update",value:function(){for(var r=this,l=r._data,t=[],e=0;e<l.length;e++)for(var n=0;n<l[e].data.length;n++)t.push(Number(l[e].data[n].value));var s=et(t,r._fontSize,r._fontFamily),u=r.group;u.selectAll("g").remove(),u.append("g").selectAll("g").data(l,function(t){return t.name}).exit().remove();var i=u.append("g").selectAll("g").data(l,function(t){return t.name});return i.exit().remove(),i.enter().append("g").merge(i).each(function(t,n){var i=2*r._xScale.step()/3,e=d3.select(this).attr("class","mixLineBarTexts").selectAll("text").data(t.data);e.exit().remove();var o=e.enter().append("text").attr("class","mix-line-bar-texts").merge(e).text(function(t){return 0==t.value?"":t.value}).attr("fill",r._textObj.colorFunc).style("font-size",r._fontSize).style("font-family",r._fontFamily).attr("x",function(t,e){return(i/l.length+(3<l.length||1==l.length?0:1))*n+i/4+r._xScale.step()*e+(0<i/l.length?i/l.length:0)/2}).attr("text-anchor","middle").attr("y",function(t){return null==r._positionOptions||null==r._positionChoice?r._yScale(t.value):0==r._positionOptions.indexOf(r._positionChoice)?t.value<0?r._yScale(0)-.3*r._fontSize:r._yScale(t.value)-.3*r._fontSize:1==r._positionOptions.indexOf(r._positionChoice)?(r._yScale(0)+r._yScale(t.value))/2+.35*r._fontSize:2==r._positionOptions.indexOf(r._positionChoice)?0<t.value?r._yScale(0)-.3*r._fontSize:r._yScale(t.value)-.3*r._fontSize:void 0}).style("display",r._labelShow?"block":"none"),a=0<i/l.length?i/l.length:0;null==r._positionOptions||null==r._positionChoice||a<s&&2==r._positionOptions.indexOf(r._positionChoice)&&o.attr("transform",function(t,e){return 0<t.value?"rotate(-90 "+((i/l.length+(3<l.length||1==l.length?0:1))*n+i/4+r._xScale.step()*e+(0<i/l.length?i/l.length:0)/2||0)+"\n                         "+(r._yScale(t.value)+r._yScale(0)-r._yScale(t.value)-.65*r._fontSize)+" )":"rotate(-90 "+((i/l.length+(3<l.length||1==l.length?0:1))*n+i/4+r._xScale.step()*e+(0<i/l.length?i/l.length:0)/2||0)+"\n                         "+(r._yScale(t.value)-.65*r._fontSize)+" )"}).attr("text-anchor","start"),0==r._labelShow||null==r._labelShow||null==r._positionOptions||null==r._positionChoice?u.selectAll(".mixLineBarTexts").style("display","none"):u.selectAll(".mixLineBarTexts").style("display","block")}),r}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}}]),n}(),Mi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-tooltip"),e._width=0,e._height=0,e._shadowColor="#000",e}return u(n,A),l(n,[{key:"update",value:function(){var t=this._data,e=this.group,n=this._defs;n.selectAll("#bg").remove();var i=n.append("filter").attr("x","-15%").attr("y","-25%").attr("width","135%").attr("height","150%").attr("id","bg");i.append("feFlood").attr("flood-color","black"),i.append("feComposite").attr("in","SourceGraphic");var o=e.selectAll("text").attr("class","axis-tooltip-text").data(t);o.exit().remove();o.enter().append("g").append("text").merge(o).text(function(t){return t.text}).attr("filter","url(#bg)").style("fill","white").style("fill-opacity",1).style("opacity",.8).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("dy","0.4em").attr("font-size",10).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);return this}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),n}();function zi(t,e){var n=0,i=0;e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"vCol"===t.function&&""==t.name&&(i=t.index)});for(var o={},a=[],r=t.length,l=t[0],s=[],u=1;u<r;u++)s.push(t[u].length);s.sort(function(t,e){return e-t});for(var c=[],h=0;h<r;h++)for(var d=0;d<s[0];d++)c.push(isNaN(parseFloat(t[h][d])));if(0==c.filter(function(t,e){return 0==t}).length)return[];for(var _=1;_<s[0];_++)if(_!==n){var f=l[_];""!=f&&null!=f&&null!=f||(f="$-"+_),o[f]=_==i?{name:f,data:[],showLegend:f!="$-"+_,type:""}:{name:f,showLegend:f!="$-"+_,data:[]}}for(var p=1;p<r;p++){var y=t[p],g=y[n];if(""!=g&&null!=g&&null!=g||(g="&-"+p),g)for(var v=0;v<s[0];v++){var x=l[v];v!==n&&(""!=l[v]&&null!=l[v]&&null!=l[v]||(x="$-"+v),o[x].data.push({name:g,showAxisText:g!="&-"+p,value:v==i||""!=y[v]&&null!=y[v]&&null!=y[v]&&!isNaN(parseFloat(y[v]))?y[v]:0,tooltipValueShow:!isNaN(parseFloat(y[v]))}))}}for(var m in o)a.push(o[m]);return a.forEach(function(t,e){t.key=t.name+"-"+e}),a}var Ri=function(t){function o(t){r(this,o);var e=c(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));return e.elem.attr("class","mix-line-bar-chart"),e.grid=new Ct(e.coreGroup),e.selectOverlay=new fn(e.coreGroup),e.rectPlot=new Fi(e.coreGroup),e.linePlot=new gn(e.coreGroup),e.scatterPlot=new xt(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.textPlot=new Li(e.coreGroup),e.stackText=new kt(e.coreGroup),e.overlay=new At(e.coreGroup),e.xAxis=new ft(e.mainGroup),e.yAxis=new Ai(e.mainGroup),e.yAxisDoubleY=new Ai(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e.yScaleRight=d3.scaleLinear(),e.axisTooltip=new Mi(e.mainGroup),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._yOrientRight="right",e._sortValue=0,e._curve=null,e._histogramWidth=.7,e._yScaleHeight=1.05,e._bardisplay=!1,e._barpositionOptions=["","",""],e._barpositionChoice="",e._linedisplay=!1,e._linepositionOptions=["",""],e._linepositionChoice="",e._lineWidth=2,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(o,ct),l(o,[{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.yAxisDoubleY,o=t.xScale,a=t.yScale,r=t.yScaleRight,l=t._xType,s=t._yType,u=t._xOrient,c=t._yOrient,h=t._yOrientRight,d=t._fontSize,_=t.widthOfNoMargin,f=t.heightOfMainGroup;o.domain(t._xDomain),a.domain(t._yDomain),r.domain(t._yDomain1),e.scaleFunc(o).allowedMaxTextHeight(.3*f).type(l).orient(u).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),n.scaleFunc(a).allowedMaxTextWidth(.5*_).type(s).orient(c).title(t._yLeftName).unit(t._yLeftTitle?t._yLeftTitle:null).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),i.scaleFunc(r).allowedMaxTextWidth(.5*_).type(s).orient(h).title(t._yRightName).times("second").unit(t._yRightTitle?t._yRightTitle:null).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);n.titleHeight;var p=(f-e.allowedMaxTextHeight())/(3*d);n.tickCount(p),i.tickCount(p),n.compute(),i.compute();var y=t.activeData,g=n.width,v=i.width;0==y.filter(function(t){return""==t.type}).length&&(g=n.width,v=t._yRightName?24:0),0==y.filter(function(t){return""!=t.type}).length&&(g=t._yLeftName?24:0,v=i.width),0==y.length&&(g=t.yAxis.width,v=t.yAxisDoubleY.width),o.range([0,_-g-v]),e.compute(),a.range([f-e.height,0]),r.range([f-e.height,0]);var x=g,m=f-e.height,k=g;e.translate(x,m),n.translate(k,0);var b=_-v;i.translate(b,0),0==y.length&&(e.translate(x,m),n.translate(k,0),i.translate(b,0)),e.update(),n.update(),i.update()}},{key:"updateCore",value:function(){var l=this,s=l.activeData,t=s,e=l.grid,u=l.tooltip,n=(l.axisTooltip,l.rectPlot),i=l.textPlot,o=l.linePlot,a=l.overlay,r=l.scatterPlot,c=l.selectOverlay,h=l.guideLine,d=l.stackText,_=l.xScale,f=l.yScale,p=l.yScaleRight,y=1.2*Math.min(d3.min(s.filter(function(t){return""!=t.type}),function(t){return d3.min(t.data,function(t){return+t.value})}),0);y<0?(l.group.selectAll(".mix-line-bar-chart .axis-x-line path").attr("transform","translate(0, "+-(f.range()[0]-f(0))+")"),l.group.selectAll(".mix-line-bar-chart .axis-x-line line").attr("transform","translate(0, "+-(f.range()[0]-f(0))+")")):(l.group.selectAll(".mix-line-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),l.group.selectAll(".mix-line-bar-chart .axis-x-line line").attr("transform","translate(0,0)"));var g=l.yAxis.width,v=l.yAxisDoubleY.width;0==s.filter(function(t){return""==t.type}).length&&(g=l.yAxis.width,v=l._yRightName?24:0),0==s.filter(function(t){return""!=t.type}).length&&(g=l._yLeftName?24:0,v=l.yAxisDoubleY.width),0==s.length&&(g=l.yAxis.width,v=l.yAxisDoubleY.width);var x=l.widthOfNoMargin-g-v,m=l.heightOfCore;e.width(x).height(m).xTickLocations(l.xAxis.tickLocations).yTickLocations(l.yAxis.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),0==s.filter(function(t){return""!=t.type}).length&&e.width(x).height(m).xTickLocations(l.xAxis.tickLocations).yTickLocations(l.yAxisDoubleY.tickLocations).showX(l._gridShowX).showY(l._gridShowY).stroke(l._gridStroke).strokeDasharray(l._gridStrokeDasharray),a.data(_.domain()).isScalePoint(!1).bandWidth(_.step()).bandHeight(m).onMouseover(function(t,e){u.show(),c.show();var n=l.elem.node().parentNode,i=(d3.mouse(n),e);d3.select(l.group.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes()[i]).attr("r",5),d3.selectAll(l.group.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes().filter(function(t,e){return e!=i})).attr("r",3.5)}).onMousemove(function(t,e){var n=l.elem.node().parentNode,i=d3.mouse(n),o=(d3.mouse(this)[0],d3.mouse(this)[1],_.step(),e),a=t,r=[{text:a=="&-"+(o+1)?"":a}];a&&(s.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===a});r.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(n[0].tooltipValueShow?n[0].value:""),color:t.color})}),c.translate(_(a),0)),u.data(r).update().move([i[0],i[1]]),d3.select(l.group.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes()[o]).attr("r",5),d3.selectAll(l.group.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes().filter(function(t,e){return e!=o})).attr("r",3.5)}).onMouseout(function(){u.hide(),c.hide(),d3.selectAll(l.group.selectAll(".mix-line-bar-chart .scatter-plot circle").nodes()).attr("r",3.5)}),n.data(t.filter(function(t){return""!=t.type})).xScale(_).yScale(f).fontSize(l._textLabel.fontSize).fontColor(l._textLabel.color).fontFamily(l._textLabel.fontFamily).labelShow(l._bardisplay).positionOptions(l._barpositionOptions).positionChoice(l._barpositionChoice).textObj({colorFunc:function(){return l._textLabel.color}}).fillOpacity(1),o.data(s.filter(function(t){return""==t.type})).xScale(_).yScale(p).labelShow(l._linedisplay).positionOptions(l._linepositionOptions).positionChoice(l._linepositionChoice).lineWidth(l._lineWidth).curve(l._curve).lineFunc(d3.line().x(function(t){return _(t.name)}).y(function(t){return p(t.value)}).defined(function(t){return!isNaN(parseFloat(t.value))})),r.data(s.filter(function(t){return""==t.type})).xScale(_).yScale(p).stroke("#fff").strokeWidth(1).radius(3.5),h.x1(0).x2(x).strokeDasharray(l._gridStrokeDasharray),i.data(t.filter(function(t){return""!=t.type})).xScale(_).yScale(f).fontSize(l._textLabel.fontSize).fontColor(l._textLabel.color).fontFamily(l._textLabel.fontFamily).labelShow(l._bardisplay).positionOptions(l._barpositionOptions).positionChoice(l._barpositionChoice).textObj({colorFunc:function(){return l._textLabel.color}}).fillOpacity(1),d.data(s.filter(function(t){return""==t.type})).xScale(_).yScale(p).type("mix").fontSize(l._textLabel.fontSize).fontColor(l._textLabel.color).fontFamily(l._textLabel.fontFamily).labelShow(l._linedisplay).positionOptions(l._linepositionOptions).positionChoice(l._linepositionChoice),c.width(_.step()).height(m).shadowColor("#ccc").hide(),l.coreGroup.attr("transform","translate("+g+",0)");var k=l.group.selectAll(".mix-line-bar-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(k).remove(),n.update(),o.translate(_.step()/2,0).update(),r.translate(_.step()/2,0).update(),i.update(),d.update(),c.update(),a.update(),e.update(),y<0?(l.coreGroup.selectAll(".fake-x-line").remove(),l.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",_.range()[0]).attr("y1",f.range()[0]).attr("x2",_.range()[1]).attr("y2",f.range()[0]).attr("stroke","rgb(233, 233, 233)")):l.coreGroup.selectAll(".fake-x-line").remove();var b=l.group.selectAll(".mix-line-bar-texts").nodes(),S=l.group.selectAll(".ranking-text-group text").nodes(),w=b.concat(S),O=d3.selectAll(w);if(null==l._barpositionOptions||null==l._barpositionChoice||-1==l._barpositionOptions.indexOf(l._barpositionChoice))l.group.selectAll(".mixLineBarTexts").style("display","none");else if(0==l._barpositionOptions.indexOf(l._barpositionChoice)||1==l._barpositionOptions.indexOf(l._barpositionChoice)){for(var C=[],A=[],F=0;F<O._groups[0].length;F++){A.push(F);for(var L=F+1;L<O._groups[0].length;L++){rt(at(d3.select(O._groups[0][F])),at(d3.select(O._groups[0][L])))&&(C.push(F),d3.select(O._groups[0][F]).style("opacity","0"))}}for(var M=new Set(C),z=Array.from(M),R=ot(z,A),T=0;T<z.length;T++){for(var P=[],W=0;W<R.length;W++){var D=at(d3.select(O._groups[0][z[T]])),j=at(d3.select(O._groups[0][R[W]]));if(P.push(rt(D,j)),rt(D,j)){if(z[T]==R[W])continue;d3.select(O._groups[0][z[T]]).style("opacity","0")}}0==P.filter(function(t){return 1==t}).length&&R.push(z[T])}for(var N=0;N<R.length;N++)d3.select(O._groups[0][R[N]]).style("opacity","1")}else if(2==l._barpositionOptions.indexOf(l._barpositionChoice)){for(var G=[],B=[],E=0;E<O._groups[0].length;E++){B.push(E);for(var H=E+1;H<O._groups[0].length;H++){var V=at(d3.select(O._groups[0][E])),I=at(d3.select(O._groups[0][H]));if(E<b.length){var Y=V.width;V.width=V.height,V.height=Y}if(H<b.length){var X=I.width;I.width=I.height,I.height=X}rt(V,I)&&(G.push(E),d3.select(O._groups[0][E]).style("opacity","0"))}}for(var Z=new Set(G),Q=Array.from(Z),q=ot(Q,B),U=0;U<Q.length;U++){for(var J=[],K=0;K<q.length;K++){var $=at(d3.select(O._groups[0][Q[U]])),tt=at(d3.select(O._groups[0][q[K]]));if(Q[U]<b.length){var et=$.width;$.width=$.height,$.height=et}if(q[K]<b.length){var nt=tt.width;tt.width=tt.height,tt.height=nt}if(J.push(rt($,tt)),rt($,tt)){if(Q[U]==q[K])continue;d3.select(O._groups[0][Q[U]]).style("opacity","0")}}0==J.filter(function(t){return 1==t}).length&&q.push(Q[U])}for(var it=0;it<q.length;it++)d3.select(O._groups[0][q[it]]).style("opacity","1")}function ot(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setPublicOption",value:function(t){s(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"setPublicOption",this).call(this,t);var e=t.axis,n=e.x||{},i=e.y||{};this.axisLineStroke(e.color).xTitle(n.name).yTitle(i.name).xTickShow(n.labelShow).yTickShow(i.labelShow).xDomain(n.range).yDomain(i.range).yLeftName(i.leftName).yLeftTitle(i.leftTitle).yRightName(i.rightName).yRightTitle(i.rightTitle)}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=zi;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._bardisplay=e?e.bardisplay:this._bardisplay,this._linedisplay=e?e.linedisplay:this._linedisplay,this._barpositionChoice=e.barpositionChoice?e.barpositionChoice:this._barpositionChoice,this._linepositionChoice=e.linepositionChoice?e.linepositionChoice:this._linepositionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain,t.length?t[0].data.map(function(t){return t.name}):[0,1]),n=t.length?[1.2*Math.min(d3.min(t.filter(function(t){return""!=t.type}),function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.2*Math.max(d3.max(t.filter(function(t){return""!=t.type}),function(t){return d3.max(t.data,function(t){return+t.value})}),0)]:[0,1],i=t.length?[1.2*Math.min(d3.min(t.filter(function(t){return""==t.type}),function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.2*Math.max(d3.max(t.filter(function(t){return""==t.type}),function(t){return d3.max(t.data,function(t){return+t.value})}),0)]:[0,1];this._xDomain=e,this._yDomain=n,this._yDomain1=i}}]),o}(),Ti=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","deformed-pie-chart"),e.core=e.rose=new E(e.mainGroup),e.lineText=new R(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e._labelShow=!0,e._positionOptions=["","",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){for(var u=this,c=u.rose,t=u.lineText,e=u._startAngle,n=u._endAngle,i=u.widthOfNoMargin,o=u.heightOfMainGroup,h=u._fontSize,a=(u.legend.height(),[]),r=0;r<u.activeData.length;r++)a.push(u.activeData[r].name);et(a,u._fontSize,u._fontFamily);var l=.74*u.heightOfMainGroup,s=.74*u.widthOfNoMargin;null==u._labelShow||null==u._positionOptions||null==u._positionChoice||null==u._contentOption||null==u._contentChoice||0==u._contentChoice.length?(l=.88*u.heightOfMainGroup,s=.88*u.widthOfNoMargin):0!=u._labelShow&&0!=u._positionOptions.indexOf(u._positionChoice)&&1!=u._positionOptions.indexOf(u._positionChoice)&&-1!=u._positionOptions.indexOf(u._positionChoice)||(l=.88*u.heightOfMainGroup,s=.88*u.widthOfNoMargin);for(var d=s,_=l,f=M(d,_,e,n),p=f.radius,y=f.cx,g=f.cy,v=p+h,x=[],m=0;m<u.activeData.length;m++)x.push(u.activeData[m].value);for(var k=0,b=0;b<u.activeData.length;b++)k+=u.activeData[b].value;for(var S=0;S<u.activeData.length;S++)u.activeData[S].percent=(u.activeData[S].value/k*100).toFixed(1);var w=u.activeData.sort(function(t,e){return e.key.slice(-1)-t.key.slice(-1)});w.unshift(w[w.length-1]),w.pop(w[w.length-1]),c.data(w).radius(p).fontSize(u._textLabel.fontSize).fontFamily(u._textLabel.fontFamily).fontColor(u._textLabel.color).labelShow(u._labelShow).positionOptions(u._positionOptions).positionChoice(u._positionChoice).contentOption(u._contentOption).contentChoice(u._contentChoice).startAngle(e).endAngle(n).cornerRadius(u._cornerRadius).stroke(u._stroke).strokeWidth(u._strokeWidth).sortMethod(u._sortMethod).transition(u._transition).duration(u._duration).onTransitionEnd(function(t,e){var n=c.arcFunc.outerRadius()(t),i=d3.select(this.parentNode),o=t.startAngle,a=t.endAngle,r="arc-path-"+t.data.key+"-"+u.id,l=L(n-h,o+.015,a-.015),s=u.defs.select("#"+r).empty()?u.defs.append("path").attr("d",l).attr("id",r):u.defs.select("#"+r).attr("d",l);0==u._labelShow||null==u._labelShow||null==u._positionOptions||null==u._positionChoice||null==u._contentOption||null==u._contentChoice||1==u._positionOptions.indexOf(u._positionChoice)||2==u._positionOptions.indexOf(u._positionChoice)||0==u._contentChoice.length?u.group.selectAll(".chart-label-text").style("display","none"):0==u._positionOptions.indexOf(u._positionChoice)&&(1==u._contentChoice.length?0==u._contentOption.indexOf(u._contentChoice[0])?z(i,s,t.data.name=="$-"+e?"":t.data.name,u._textLabel.fontSize,u._textLabel.fontFamily,"53%").attr("class",u.labelTextClass).style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily):1==u._contentOption.indexOf(u._contentChoice[0])?z(i,s,t.data.percent+"%",u._textLabel.fontSize,u._textLabel.fontFamily,"53%").attr("class",u.labelTextClass).style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily):2==u._contentOption.indexOf(u._contentChoice[0])&&z(i,s,t.data.value,u._textLabel.fontSize,u._textLabel.fontFamily,"53%").attr("class",u.labelTextClass).style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily):2==u._contentChoice.length?0==u._contentOption.indexOf(u._contentChoice[0])&&1==u._contentOption.indexOf(u._contentChoice[1])||1==u._contentOption.indexOf(u._contentChoice[0])&&0==u._contentOption.indexOf(u._contentChoice[1])?z(i,s,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%",u._textLabel.fontSize,u._textLabel.fontFamily,"53%").attr("class",u.labelTextClass).style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==u._contentOption.indexOf(u._contentChoice[0])&&2==u._contentOption.indexOf(u._contentChoice[1])||2==u._contentOption.indexOf(u._contentChoice[0])&&0==u._contentOption.indexOf(u._contentChoice[1])?z(i,s,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.value,u._textLabel.fontSize,u._textLabel.fontFamily,"53%").attr("class",u.labelTextClass).style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==u._contentOption.indexOf(u._contentChoice[0])&&2==u._contentOption.indexOf(u._contentChoice[1])||2==u._contentOption.indexOf(u._contentChoice[0])&&1==u._contentOption.indexOf(u._contentChoice[1]))&&z(i,s,t.data.percent+"%  "+t.data.value,u._textLabel.fontSize,u._textLabel.fontFamily,"53%").attr("class",u.labelTextClass).style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==u._contentChoice.length&&z(i,s,(t.data.name=="$-"+e?"":t.data.name+"  ")+t.data.percent+"%  "+t.data.value,u._textLabel.fontSize,u._textLabel.fontFamily,"53%").attr("class",u.labelTextClass).style("pointer-events","none").style("fill",u._textLabel.color).style("font-size",u._textLabel.fontSize).style("font-family",u._textLabel.fontFamily).attr("text-anchor","start").attr("xml:space","preserve"))}).onMouseover(function(t,e){d3.select(this).transition().style("opacity",.8);var n=[{text:""+(t.data.name=="$-"+e?"":t.data.name),color:t.data.color},{text:t.data.valueLabel+": "+t.data.value}];u.tooltip.data(n).update().show()}).onMousemove(function(){u.tooltip.move()}).onMouseout(function(t){d3.select(this).transition().style("opacity",1),u.tooltip.hide()});var O=(i-d)/2+y,C=(o-_)/2+g,A=(v-p)/2;switch(f.quadrant){case 4:O+=A,C+=A;break;case 1:O-=A,C+=A;break;case 2:O-=A,C-=A;break;case 3:O+=A,C-=spcae}if(null!=u._labelShow)if(0!=u._labelShow&&2==u._positionOptions.indexOf(u._positionChoice)){var F=u.activeData.sort(function(t,e){return e.key.slice(-1)-t.key.slice(-1)});F.unshift(F[F.length-1]),F.pop(F[F.length-1]),t.data(F).outerRadius(p).type("change").cornerRadius(u._cornerRadius).startAngle(e).endAngle(n).fontSize(u._textLabel.fontSize).fontColor(u._textLabel.color).fontFamily(u._textLabel.fontFamily).labelShow(u._labelShow).positionOptions(u._positionOptions).positionChoice(u._positionChoice).contentOption(u._contentOption).contentChoice(u._contentChoice).values(x).transition(u._transition).duration(u._duration),u.lineText.translate(O||0,C).update(),u.group.selectAll(".outside-text-polygon").attr("display","block")}else 0!=u._labelShow&&0!=u._positionOptions.indexOf(u._positionChoice)&&1!=u._positionOptions.indexOf(u._positionChoice)&&-1!=u._positionOptions.indexOf(u._positionChoice)||u.group.selectAll(".outside-text-polygon").attr("display","none");c.translate(O||0,C).update()}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._contentChoice=n.contentChoice?n.contentChoice:this._contentChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel),this.cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).stroke(e.areaBorderColor||this._stroke).strokeWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._strokeWidth))}}]),n}(),Pi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._padAngle=.01,e._labelRadiusRatio=.5,e._innerRadiusRatio=.75,e._cornerRadius=null,e._areaBorderColor="#fff",e._areaBorderWidth=0,e._labelShow=!0,e._positionOptions=["",""],e._positionChoice="",e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,D),l(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(e).length&&this.innerRadiusRatio(o(e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(o(e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(o(e.areaBorderWidth?e.areaBorderWidth:this._areaBorderWidth)).areaBorderColor(e.areaBorderColor||this._areaBorderColor),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._contentChoice=n.contentChoice?n.contentChoice:this._contentChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel)}}]),n}(),Wi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","funnel-polygon"),e._fontColor="#ffffff",e}return u(n,A),l(n,[{key:"update",value:function(){for(var n=this,i=n._data,t=d3.max(i,function(t){return Math.abs(t.value)}),o=0<i.length?i[0].value:0,a=d3.scaleLinear().domain([0,t]).range([0,n._sWidth]),r=(0<n._sHeight?n._sHeight:0)/i.length,e=n.group,l=0;l<i.length;l++)i[l].percent=Math.ceil(i[l].value/t*100);n.group.selectAll(".funnel-groups").remove();var s=e.selectAll("polygon").data(i);s.exit().remove();var u=s.enter().append("g").attr("class","funnel-groups");u.append("polygon").merge(s).attr("class","funnel-polygons").style("fill",function(t){return t.color}).style("fill-opacity",1).style("stroke","#ffffff").style("opacity",1).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(n._transition?n._duration:0).attr("points",function(t,e){return e==i.length-1?a(i[e].total)/2+(n._sWidth-a(o))/2+.05*n._sWidth+","+r*e+"\n        "+(a(t.value)+a(i[e].total)/2+(n._sWidth-a(o))/2+.05*n._sWidth)+","+r*e+" \n        "+(a(t.value)/2+a(i[e].total)/2+(n._sWidth-a(o))/2+.05*n._sWidth)+","+r*(e+1):a(i[e].total)/2+(n._sWidth-a(o))/2+.05*n._sWidth+","+r*e+"\n        "+(a(t.value)+a(i[e].total)/2+(n._sWidth-a(o))/2+.05*n._sWidth)+","+r*e+" \n        "+(a(i[e+1].value)+a(i[e+1].total)/2+(n._sWidth-a(o))/2+.05*n._sWidth)+","+r*(e+1)+" \n        "+(a(i[e+1].total)/2+(n._sWidth-a(o))/2+.05*n._sWidth)+","+r*(e+1)});var c=u.append("g").merge(s).attr("class","funnel-text-group");return c.append("text").text(function(t,e){return t.name=="$-"+e?"":t.name}).attr("class","funnel-texts-name").style("fill",n._fontColor).style("font-size",n._fontSize).style("font-family",n._fontFamily).attr("x",function(t,e){return a(t.value)/2+a(i[e].total)/2+.05*n._sWidth+(n._sWidth-a(o))/2}).attr("y",function(t,e){return r*(e+1)-r/2}).attr("text-anchor","middle").attr("dy","0.3em").style("display",n._labelShow?"block":"none"),c.append("text").text(function(t){return t.percent+"%"}).attr("class","funnel-texts-percent").style("fill",n._fontColor).style("font-size",n._fontSize).style("font-family",n._fontFamily).attr("x",function(t,e){return a(t.value)/2+a(i[e].total)/2+.05*n._sWidth+(n._sWidth-a(o))/2}).attr("y",function(t,e){return r*(e+1)-r/2}).attr("text-anchor","middle").attr("dy","0.3em").style("display",n._labelShow?"block":"none"),c.append("text").text(function(t){return t.value}).attr("class","funnel-texts-value").style("fill",n._fontColor).style("font-size",n._fontSize).style("font-family",n._fontFamily).attr("x",function(t,e){return a(t.value)/2+a(i[e].total)/2+.05*n._sWidth+(n._sWidth-a(o))/2}).attr("y",function(t,e){return r*(e+1)-r/2}).attr("text-anchor","middle").attr("dy","0.3em").style("display",n._labelShow?"block":"none"),0==n._labelShow||null==n._labelShow||null==n._contentOption||null==n._contentChoice||0==n._contentChoice.length?(e.selectAll(".funnel-texts-name").style("display","none"),e.selectAll(".funnel-texts-percent").style("display","none"),e.selectAll(".funnel-texts-value").style("display","none")):1==n._contentChoice.length&&n._labelShow?0==n._contentOption.indexOf(n._contentChoice[0])?(e.selectAll(".funnel-texts-name").style("display","block"),e.selectAll(".funnel-texts-percent").style("display","none"),e.selectAll(".funnel-texts-value").style("display","none")):1==n._contentOption.indexOf(n._contentChoice[0])?(e.selectAll(".funnel-texts-name").style("display","none"),e.selectAll(".funnel-texts-percent").style("display","block"),e.selectAll(".funnel-texts-value").style("display","none")):2==n._contentOption.indexOf(n._contentChoice[0])&&(e.selectAll(".funnel-texts-name").style("display","none"),e.selectAll(".funnel-texts-percent").style("display","none"),e.selectAll(".funnel-texts-value").style("display","block")):2==n._contentChoice.length&&n._labelShow?0==n._contentOption.indexOf(n._contentChoice[0])&&1==n._contentOption.indexOf(n._contentChoice[1])||1==n._contentOption.indexOf(n._contentChoice[0])&&0==n._contentOption.indexOf(n._contentChoice[1])?(e.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),e.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),e.selectAll(".funnel-texts-value").style("display","none"),c.attr("transform",function(t,e){return"translate("+(V(t.name=="$-"+e?"":t.name,n._fontSize,n._fontFamily)-V(t.percent,n._fontSize,n._fontFamily))/2+", 0)"})):0==n._contentOption.indexOf(n._contentChoice[0])&&2==n._contentOption.indexOf(n._contentChoice[1])||2==n._contentOption.indexOf(n._contentChoice[0])&&0==n._contentOption.indexOf(n._contentChoice[1])?(e.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),e.selectAll(".funnel-texts-percent").style("display","none"),e.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),c.attr("transform",function(t,e){return"translate("+(V(t.name=="$-"+e?"":t.name,n._fontSize,n._fontFamily)-V(t.value,n._fontSize,n._fontFamily))/2+", 0)"})):(1==n._contentOption.indexOf(n._contentChoice[0])&&2==n._contentOption.indexOf(n._contentChoice[1])||2==n._contentOption.indexOf(n._contentChoice[0])&&1==n._contentOption.indexOf(n._contentChoice[1]))&&(e.selectAll(".funnel-texts-name").style("display","none"),e.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),e.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),c.attr("transform",function(t,e){return"translate("+(V(t.percent,n._fontSize,n._fontFamily)-V(t.value,n._fontSize,n._fontFamily))/2+", 0)"})):3==n._contentChoice.length&&n._labelShow&&(e.selectAll(".funnel-texts-name").attr("text-anchor","end").attr("dx","-1.5em"),e.selectAll(".funnel-texts-percent"),e.selectAll(".funnel-texts-value").attr("text-anchor","start").attr("dx","1.5em"),c.attr("transform",function(t,e){return"translate("+(V(t.name=="$-"+e?"":t.name,n._fontSize,n._fontFamily)-V(t.value,n._fontSize,n._fontFamily))/2+", 0)"})),n}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}}]),n}(),Di=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","funnel-chart"),e.funnel=new Wi(e.mainGroup),e._sortValue=null,e._labelShow=!0,e._contentOption=["","",""],e._contentChoice=[""],e._textLabel={color:"#FFFFFF",fontFamily:"noto",fontSize:12},e}return u(n,O),l(n,[{key:"updateCore",value:function(){for(var i=this,t=i.activeData,e=i.funnel,n=.69*i.widthOfNoMargin,o=.92*i.heightOfMainGroup,a=0;a<t.length;a++)t[a].percent=0==a?0:t[a-1].value-t[a].value;for(var r=0;r<t.length;r++)t[r].total=0==r?0:t[r-1].total+parseFloat(t[r].percent);e.data(t).sWidth(n).sHeight(o).labelShow(i._labelShow).contentOption(i._contentOption).contentChoice(i._contentChoice).transition(i._transition).duration(i._duration).fontSize(i._textLabel.fontSize).fontColor(i._textLabel.color).fontFamily(i._textLabel.fontFamily).onTransitionEnd(function(t,e){}).onMouseover(function(t,e){d3.select(this).transition().duration(30).style("opacity",.8);var n=[{text:""+(t.name=="$-"+e?"":t.name),color:t.color},{text:t.valueLabel+": "+t.value}];i.tooltip.data(n).update().show()}).onMousemove(function(){i.tooltip.move()}).onMouseout(function(t){d3.select(this).transition().duration(30).style("opacity",1),i.tooltip.hide()}),i.funnel.translate(.15*n,.04*o).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}}]),n}(),ji="axis-group",Ni="y-title",Gi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","axis-y"),e._orient="left",e._type="number",e._allowedMaxTextWidth=100,e._tickTextWidth=0,e}return u(n,ht),l(n,[{key:"update",value:function(){var t=this,e=t._orient,n=t._scaleFunc,i=t.group,o=t._fontSize,a=t._tickValueTexts,r=void 0;r=t.axisFunc="right"===e?d3.axisRight(n):d3.axisLeft(n);var l=null;"number"===t._type&&t._tickValues.every(function(t){return 0===Math.abs(t)||1<Math.abs(t)})&&(l=d3.format("d")),r.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=i.select("."+ji).empty()?i.append("g").attr("class",ji):i.select("."+ji);if(s.transition().duration(t._transition?t._duration:0).call(r).on("start",function(){s.selectAll(".tick text").style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text(function(t,e){return a[e]}),s.selectAll(".tick line").style("stroke",t._lineStroke),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")}),t._titleShow&&t._title){var u=i.select("."+Ni).empty()?i.append("g").attr("class",Ni):i.select("."+Ni),c=u.select("text").empty()?u.append("text"):u.select("text"),h=V(t._title,o,t._fontFamily);c.attr("x",h>=2*t.width?2-t.width:0).attr("y",-this._fontSize).style("font-size",o+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",h>=2*t.width?"start":"middle").text(t._title)}else i.select("."+Ni).remove()}},{key:"compute",value:function(){var e=this,t=[],n=[],i=0;var o=e._scaleFunc,a=e._type,r=e._fontSize,l=(e._minTickDistance,e._allowedMaxTextWidth);t="category"===a?o.domain():o.ticks(e._tickCount),"number"===a&&0!=o.domain()[0]&&t.push(-1==String(o.domain()[0]).indexOf(".")?o.domain()[0]:o.domain()[0].toFixed(0));var s=d3.max(t,function(t){return V(t,r,e._fontFamily)});return s<=l?(n=t,i=s):(n=t.map(function(t){return I(t,l,r,e._fontFamily)}),i=l),e._tickValues=t,e._tickValueTexts=n,e._tickTextWidth=i,e}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),n}(),Bi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","histogram-chart"),e.selectOverlay=new fn(e.coreGroup),e.grid=new Ct(e.coreGroup),e.rectPlot=new xn(e.coreGroup),e.overlay=new At(e.coreGroup),e.xAxis=new Je(e.mainGroup),e.yAxis=new Gi(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e._curve=d3.curveCardinal,e._histogramWidth=.7,e._yScaleHeight=1.05,e}return u(n,Qe),l(n,[{key:"updateCore",value:function(){var a=this,r=a.activeData,t=r.toString()?r[0].data:[],e=a.grid,l=a.tooltip,n=a.rectPlot,i=a.overlay,o=a.selectOverlay,s=a.xScale,u=a.yScale,c=a.widthOfCore,h=a.heightOfCore;i.data(s.domain()).bandWidth(s.step()).bandHeight(h).isScalePoint(!1).onMouseover(function(t,e){var n=s.domain()[e],i=[{text:n}];r.forEach(function(t){var e=t.data.filter(function(t){return t.name===n});i.push({text:t.name+": "+e[0].value,color:t.color})}),o.translate(s(n),0),l.data(i).update(),l.show(),o.show()}).onMousemove(function(){l.move()}).onMouseout(function(){l.hide(),o.hide()}),n.data(t).xScale(s).yScale(u).rectObj({xFunc:function(t,e){return s.step()*e+.15*s.step()},yFunc:function(t,e){return u(t.value)},widthFunc:function(t){return.7*s.step()},heightFunc:function(t){return u.range()[0]-u(t.value)}}).fillOpacity(1).onMousemove(function(t){var e=a.elem.node().parentNode,n=d3.mouse(e),i=r[0].name,o=[{text:t.name},{text:i+": "+t.value,color:t.color}];l.show(),l.data(o).update().move([n[0],n[1]]),d3.select(this).style("cursor","pointer")}).onMouseout(function(){l.hide()}),e.width(c).height(h).xTickLocations(a.xAxis.tickLocations.slice(1)).yTickLocations(a.yAxis.tickLocations.slice(1)).showX(a._gridShowX).showY(a._gridShowY).stroke(a._gridStroke).strokeDasharray(a._gridStrokeDasharray),o.width(s.step()).height(h).hide(),a.coreGroup.attr("transform","translate("+a.yAxis.width+","+a.yAxis.titleHeight+")"),n.update(),o.update(),i.update(),e.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=On;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.activeData,e=(this._yDomain||[]).slice().sort(d3.ascending),n=t.length?t[0].data.map(function(t){return t.name}):[0,1],i=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.value})}),0),1.05*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.value})})]:[0,1];this._xDomain=n,this._yDomain=[isNaN(parseFloat(e[0]))?i[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?i[1]:parseFloat(e[1])]}}]),n}(),Ei=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","bee-line-chart"),e._showPoints=!1,e._curve=d3.curveLinear,e._strokeWidth=2,e._labelShow=!1,e._endPointRadius=3.5,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,Rt),l(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&this.strokeWidth(o(e.lineWidth?e.lineWidth:this._strokeWidth)).curve(i[e.lineType]||this._curve)}}]),n}(),Hi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","stacked-linear-chart"),e.elem.attr("class","stacked-linear-chart"),e.grid=new Ct(e.coreGroup),e.areaPlot=new De(e.coreGroup),e.linePlot=new gn(e.coreGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.guideScatter=new yn(e.coreGroup),e.stackText=new kt(e.coreGroup),e.clipArea=new bt(e.defs),e.AnimationArea=new St(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xScale=d3.scalePoint(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._sortValue=null,e._endPointRadius=2,e._radius=3.5,e._curve=d3.curveLinear,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){for(var t=this,n=t.activeData,e=t.grid,i=t.areaPlot,o=t.linePlot,a=(t.StackedScatterPlot,t.stackText),r=t.tooltip,l=t.overlay,s=t.guideLine,u=t.guideScatter,c=t.clipArea,h=(t.AnimationArea,t.xScale),d=t.yScale,_=t.widthOfCore,f=t.heightOfCore,p=0;p<n.length;p++)for(var y=0;y<n[p].data.length;y++)n[p].data[y].value=parseFloat(n[p].data[y].value),n[p].data[y].total=0==p?isNaN(parseFloat(n[p].data[y].value))?0:parseFloat(n[p].data[y].value):n[p-1].data[y].total+(isNaN(parseFloat(n[p].data[y].value))?0:parseFloat(n[p].data[y].value));Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.total})}),0);e.width(_).height(f).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(h).yScale(d).fillOpacity(.7).curve(t._curve).areaFunc(d3.area().x(function(t){return h(t.name)}).y0(function(t){return d(t.total-t.value)}).y1(function(t){return d(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),o.data(n).xScale(h).yScale(d).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).mainGroup(t.mainGroup).curve(t._curve).lineFunc(d3.line().x(function(t){return h(t.name)}).y(function(t){return d(t.total)}).defined(function(t){return!isNaN(parseFloat(t.value))})),u.data(n).xScale(h).yScale(d).radius(3.5).stroke("#fff").strokeWidth(2),s.y1(0).y2(f).stroke("#c6c6c6").strokeDasharray("0 0"),l.data(h.domain()).bandWidth(h.step()).bandHeight(f).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),r.data(o).update(),s.x(h(i)).update(),u.data(a).update(),r.show(),s.show(),u.show()}).onMousemove(function(){r.move()}).onMouseout(function(){r.hide(),s.hide(),u.hide()}),a.data(n).xScale(h).yScale(d).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice),t.coreGroup.call(H,t.yAxis.width+.5,0),0!=t._clipShow.length?c.width(_).height(f).paddingVertical([0,0]).transition(t._transition).duration(t._duration):c.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+c.id+")"),c.update(),u.elem.style("pointer-events","none");var g=t.group.selectAll(".stacked-linear-chart .axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(g).remove(),e.update(),l.update(),i.update(),o.update(),a.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"setSelfOption",value:function(t){var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=Ft;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){for(var t=this.activeData,e=0;e<t.length;e++)for(var n=0;n<t[e].data.length;n++)t[e].data[n].value=parseFloat(t[e].data[n].value),t[e].data[n].total=0==e?isNaN(parseFloat(t[e].data[n].value))?0:parseFloat(t[e].data[n].value):t[e-1].data[n].total+(isNaN(parseFloat(t[e].data[n].value))?0:parseFloat(t[e].data[n].value));var i=this._yRange||[],o=t.length?t[0].data.map(function(t){return t.name}):[0,1],a=t.length?[Math.min(d3.min(t,function(t){return d3.min(t.data,function(t){return+t.total})}),0),1.1*d3.max(t,function(t){return d3.max(t.data,function(t){return+t.total})})]:[0,1];this._xDomain=o,this._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}}]),n}(),Vi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","smooth-line-chart"),e._showPoints=!1,e._curve=d3.curveCardinal,e._strokeWidth=2,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,Rt),l(n,[{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&this.strokeWidth(o(e.lineWidth?e.lineWidth:this._strokeWidth)).curve(i[e.lineType]||this._curve)}}]),n}(),Ii="axis-group",Yi="x-title",Xi=function(t){function e(t){return r(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return u(e,ft),l(e,[{key:"update",value:function(){var n=this,i=n._orient,t=n._scaleFunc,e=n.group,o=n._fontSize,a=n._tickTextRotate,r=n._tickValueTexts,l=void 0;if("top"===i){(l=n.axisFunc=d3.axisTop(t)).tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding).tickFormat(n._tickFormat);var s=e.select("."+Ii).empty()?e.append("g").attr("class",Ii):e.select("."+Ii);s.style("font-size",o+"px").style("font-family",n._fontFamily).transition().duration(n._transition?n._duration:0).call(l).on("start",function(){s.selectAll(".tick text").remove(),s.selectAll(".tick").append("text").style("fill",n._fontColor).attr("dx",0).attr("dy","-1em").attr("transform","rotate(0)").style("text-anchor","middle").text(function(t){return t+"%"}).filter(function(){return a}).attr("dx","-0.5em").attr("dy","-0.3em").style("text-anchor","end").attr("transform","rotate("+n._tickTextRotate+")").filter(function(){return"top"!==i}),s.selectAll(".tick line").style("stroke",n._lineStroke),s.select("path").style("stroke",n._lineStroke).style("display",n._axisLineShow?"block":"none")});var u=Math.abs(t.range()[0]-t.range()[1]);if(n._titleShow&&n._title){var c=e.select("."+Yi).empty()?e.append("g").attr("class",Yi):e.select("."+Yi),h=c.select("text").empty()?c.append("text"):c.select("text"),d=r.map(function(t){return t+"%"}),_=u/d.length,f=d3.max(d,function(t){return V(t,o,n._fontFamily)});c.call(H,u/2+Math.abs(t.range()[0]),-(this._tickShow?this._tickSize+this._tickPadding+(f<.8*_?this._tickTextHeight:1.2*this._tickTextHeight):0)),h.attr("text-anchor","middle").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dy",-6).text(n._title)}else e.select("."+Yi).remove()}else{(l=n.axisFunc=d3.axisBottom(t)).tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding);var p=e.select("."+Ii).empty()?e.append("g").attr("class",Ii):e.select("."+Ii);p.style("font-size",o+"px").style("font-family",n._fontFamily).transition().duration(n._transition?n._duration:0).call(l).on("start",function(t,e){p.selectAll(".tick text").remove(),p.selectAll(".tick").append("text").style("fill",n._fontColor).attr("dx",0).attr("dy",parseFloat(o)+6).attr("transform","rotate(0)").style("text-anchor","middle").text(function(t){return t+"%"}).filter(function(){return a}).attr("dx","-0.6em").attr("dy","0.5em").style("text-anchor","end").attr("transform","rotate("+n._tickTextRotate+")").filter(function(){return"bottom"!==i}),p.selectAll(".tick line").style("stroke",n._lineStroke),p.select("path").style("stroke",n._lineStroke).style("display",n._axisLineShow?"block":"none")});var y=n.group.selectAll(".axis-x-line .tick text").nodes().filter(function(t,e){return"&-"==String(t.__data__).slice(0,2)}),g=n.group.selectAll(".axis-x-line .tick text").nodes().filter(function(t,e){return"$-"==String(t.__data__).slice(0,2)});d3.selectAll(y).remove(),d3.selectAll(g).remove();var v=Math.abs(t.range()[0]-t.range()[1]);if(n._titleShow&&n._title){var x=e.select("."+Yi).empty()?e.append("g").attr("class",Yi):e.select("."+Yi),m=x.select("text").empty()?x.append("text"):x.select("text"),k=r.map(function(t){return t+"%"}),b=v/k.length,S=d3.max(k,function(t){return V(t,o,n._fontFamily)});x.call(H,v/2+Math.abs(t.range()[0]),this._tickShow?this._tickSize+this._tickPadding+(S<.8*b?this._tickTextHeight:1.2*this._tickTextHeight):0),m.attr("text-anchor","middle").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dy",1.125*o/2+6).text(n._title)}else e.select("."+Yi).remove()}}},{key:"compute",value:function(){var n=this,i=[],o=[],a=0,r=0;function l(){n._tickTextRotate=a,n._tickValues=i,n._tickValueTexts=o,n._tickTextHeight=r}var t=n._scaleFunc,e=n._type,s=n._fontSize,u=(n._minTickDistance,n._allowedMaxTextHeight),c=Math.abs(t.range()[0]-t.range()[1]),h=void 0,d=void 0;if(i="category"===e?t.domain():t.ticks(),function(){var t=!1;h=c/i.length;var e=i.map(function(t){return t+="%"});(d=d3.max(e,function(t){return V(t,s,n._fontFamily)}))<.8*h&&(a=0,o=i,r=1.125*s,l(),t=!0);return t}())return n;a="top"===n._orient?45:-45;var _=Math.abs(Math.sin(Math.PI/4));d*_<u?(r=d*_,o=i):(r=u,o=i.map(function(t){return I(t,r/_,s,n._fontFamily)}));Math.abs(Math.cos(Math.PI/4));var f=c/i.length;if("category"!=e&&f<2*s){var p=Math.ceil(2*s/f);i=i.filter(function(t,e){return e%p==0})}return l(),n}},{key:"height",get:function(){var e=this,t=this._scaleFunc,n=Math.abs(t.range()[0]-t.range()[1]),i=this._tickValueTexts.map(function(t){return t+"%"}),o=n/i.length,a=d3.max(i.filter(function(t,e){return t!="$-"+e&&t!="&-"+(e+1)}),function(t){return V(t,e._fontSize,e._fontFamily)}),r=0;return this.isShow&&(r=(this._tickShow?(a?this._tickSize+this._tickPadding:0)+(a<.8*o?this._tickTextHeight:1.2*this._tickTextHeight):0)+(this._title&&this._titleShow?this._titlePadding+1.25*this._fontSize:0)),r}}]),e}(),Zi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rect-plot"),e._xScale=null,e._yScale=null,e._rectObj=null,e._textObj=null,e._fillColor="",e._strokeColor="",e._strokeWidth="",e._fillOpacity=.7,e._barCornerRadius=5,e._borderColor="#000",e._borderWidth=1,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,e=this,t=e._data,i=e.group;i.selectAll(".symmetric-rect").remove();var o=i.selectAll("rect").data(t,function(t){return t.key});o.exit().remove();var a=o.enter().append("g").attr("class","symmetric-rect").append("rect").merge(o).style("fill",function(t){return e._fillColor||t.color}).style("fill-opacity",function(t){return e._fillOpacity}).style("stroke",function(t){return e._strokeColor||t.color}).style("stroke-width",function(t){return e._strokeWidth||0});if(this._rectObj?(a.attr("x",e._rectObj.xFunc),a.attr("y",this._rectObj.yFunc),a.attr("width",this._rectObj.widthFunc),a.attr("height",this._rectObj.heightFunc)):a.attr("x",function(t){return t.value}).attr("y",function(t){return t.value}).attr("width",function(t){return t.value}).attr("height",function(t){return t.value}),this._textObj){i.selectAll(".symmetric-texts").remove();var r=i.append("g").attr("class","symmetric-texts").selectAll("text").data(t,function(t){return t.key});r.exit().remove();r.enter().append("g").append("text").merge(r).text(this._textObj.textFunc).attr("fill",e._textObj.colorFunc).attr("font-size",e._textObj.fontSize).attr("font-family",e._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("text-anchor","middle").style("display",function(t,e){return n._textObj.labelShow&&t.textShow?"block":"none"})}return a.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),n}();function Qi(t,e){var n=0,i=[];if(e.forEach(function(t){"objCol"===t.function?(n=t.index,t.isLegend):"vCol"===t.function&&0!=t.configurable&&i.push(t.index-1)}),P(t,[n],2))return[];var o=W(t,e),a=o[0],r=o.slice(1),l=a.slice(1),s=[],u=[],c=[],h=r.map(function(t){return t.slice(1)});return l.forEach(function(t,e){s.push({name:t,data:[]})}),r.forEach(function(t){var e=0;t.slice(1).forEach(function(t){e+=""==t||isNaN(parseFloat(t))||null==t||null==t?0:parseFloat(t)}),u.push(e)}),h.forEach(function(t,e){c.push(t.map(function(t){return 0==u[e]?0:(t/u[e]*100).toFixed(2)}))}),r.forEach(function(n,i){s.forEach(function(t,e){t.data.push({name:""==n[0]?"&-"+i:n[0],type:t.name,value:""==n[e+1]||isNaN(parseFloat(n[e+1]))||null==n[e+1]||null==n[e+1]?0:parseFloat(n[e+1]),total:u[i],rate:c[i][e]+"%"})})}),s.forEach(function(t,e){t.key=T(t.name)+"-"+e}),s}var qi=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","symmetric-chart"),e.grid=new Ct(e.coreGroup),e.rectPlot=new Zi(e.coreGroup),e.xAxis=new Xi(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xAxis.minTickDistance(5),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="top",e._yOrient="left",e._sortValue=null,e._curve=d3.curveCardinal,e._histogramWidth=.5,e._yScaleHeight=1.05,e._shapeType="rect",e._labelShow=!1,e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"update",value:function(){return this._marginLeft=this._yTitle?0:24,this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),"top"==this._xOrient?(this._legendShow&&0!=this.legend.height()?this._gapPadding=this._xTitle&&"top"==this._legendY?8:20:this._gapPadding=0,this._marginTop=this._xTitle&&0==this._legendShow?8:20,this._marginTop=this._xTitle&&0==this.legend.height()?8:20):(this._marginTop=20,this._legendShow&&0!=this.legend.height()?this._gapPadding=this._xTitle&&"bottom"==this._legendY?8:20:this._gapPadding=0),this.updateTitle(),this.updateAxis(),this.updateCore(),this.updateScale(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateCore",value:function(){for(var a=this,t=a.activeData,e=a.grid,r=a.tooltip,n=a.rectPlot,o=a.xScale,i=a.yScale,l=a.widthOfCore,s=a.heightOfCore,u=0;u<t.length;u++)for(var c=0;c<t[u].data.length;c++){var h=Math.abs(o.domain()[0])+Math.abs(o.domain()[1]);t[u].data[c].rate.replace(/\%$/,"")/h*o.range()[1]<V(t[u].data[c].value,a._fontSize,a._fontFamily)?t[u].data[c].textShow=!1:t[u].data[c].textShow=!0}n.data(a.drawData).xScale(o).yScale(i).rectObj({xFunc:function(t,e){return o(t.x)},yFunc:function(t,e){return"top"==a._xOrient?i(t.name)+i.step()*(1-a._histogramWidth)/2+a.xAxis.height:i(t.name)+i.step()*(1-a._histogramWidth)/2},widthFunc:function(t){var e=Math.abs(o.domain()[0])+Math.abs(o.domain()[1]);return t.rate.replace(/\%$/,"")/e*o.range()[1]},heightFunc:function(t){return i.step()*a._histogramWidth}}).textObj({xFunc:function(t,e){var n=Math.abs(o.domain()[0])+Math.abs(o.domain()[1]),i=t.rate.replace(/\%$/,"")/n*o.range()[1];return o(t.x)+i/2},yFunc:function(t,e){return"top"==a._xOrient?i(t.name)+i.step()*(1-a._histogramWidth)/2+a.xAxis.height:i(t.name)+i.step()*(1-a._histogramWidth)/2},dxFunc:0,dyFunc:function(t){return i.step()*a._histogramWidth/2+a._textLabel.fontSize/2},colorFunc:function(){return a._textLabel.color},textFunc:function(t){return 0==t.value?"":t.value},fontSize:a._textLabel.fontSize,fontFamily:a._textLabel.fontFamily,labelShow:a._labelShow}).fillOpacity(1).onMousemove(function(t,e){var n=a.elem.node().parentNode,i=d3.mouse(n),o=[{text:"&-"==t.name.slice(0,2)?"":t.name},{text:t.type,color:t.color},{text:":"+t.value},{text:":"+t.rate}];r.show(),r.data(o).update().move([i[0],i[1]]),d3.select(this).style("cursor","pointer")}).onMouseout(function(){r.hide()}),e.width(l).height(s).xTickLocations(a.xAxis.tickLocations.slice()).yTickLocations(a.yAxis.tickLocations.slice()).showX(a._gridShowX).showY(a._gridShowY).stroke(a._gridStroke).strokeDasharray(a._gridStrokeDasharray),a.coreGroup.attr("transform","translate("+a.yAxis.width+",0)");var d=a.group.selectAll(".symmetric-chart .axis-y-line .tick text").nodes().filter(function(t,e){return"&-"==t.__data__.slice(0,2)});d3.selectAll(d).remove(),n.update(),"top"==a._xOrient?e.translate(0,a.xAxis.height).update():e.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var n=new mn(t,e);this.rawData=t.dataSrc.data[0];var i=Qi;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){t.display;var e=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel)}},{key:"computeDomain",value:function(){var t=this.activeData||[];this.drawData=function(t,e,n){for(var i=[],o=[],a=[],r=n.slice(1).map(function(t){return t.slice(1)}),l=[],s=[],u=[],c=[],h=0<t.length?t[0].data.length:0,d=[],_=0;_<h;_++){for(var f=[],p=0;p<t.length;p++)f.push(t[p].data[_].value);d.push(f)}var y=Math.floor(e.length/2);if(t.forEach(function(t){o.push(t.key.split("-")[1])}),r.forEach(function(e){var n=[];o.forEach(function(t){n.push(e[t])})}),d.forEach(function(t){var e=0;t.forEach(function(t){e+=""==t||isNaN(parseFloat(t))||null==t||null==t?0:parseFloat(t)}),l.push(e)}),d.forEach(function(t,e){a.push(t.map(function(t){return 0==l[e]?0:(t/l[e]*100).toFixed(2)}))}),-1!=o.indexOf(y.toString())&&e.length%2!=0&&1!=e.length){var g=o.indexOf(y.toString());a.forEach(function(t,e){var n=-t[g]/2,i=t[g]/2;s.push([]),s[e][g]=-(t[g]/2).toFixed(2);for(var o=g-1;0<=o;o--)s[e][o]=parseFloat((-t[o]+s[e][o+1]).toFixed(2)),n+=-t[o];for(var a=g+1;a<t.length;a++)s[e][a]=parseFloat((s[e][a-1]+ +t[a-1]).toFixed(2)),i+=+t[a];u.push(n),c.push(i)})}else{for(var v=-1,x=0;x<o.length;x++){if(+o[x]>=y){v=x;break}if(x==o.length-1){v=x+1;break}}a.forEach(function(t,e){var n=0,i=+t[v]||0;s.push([]),s[e][v]=0;for(var o=v-1;0<=o;o--)s[e][o]=parseFloat((-t[o]+s[e][o+1]).toFixed(2)),n+=-t[o];for(var a=v+1;a<t.length;a++)s[e][a]=parseFloat((s[e][a-1]+ +t[a-1]).toFixed(2)),i+=+t[a];u.push(n),c.push(i)})}return t.forEach(function(t,n){t.data.forEach(function(t,e){t.x=s[e][n],t.rate=a[e][n]+"%"})}),t.forEach(function(t){t.range=[Math.min.apply(null,u),Math.max.apply(null,c)],t.data.forEach(function(t){i.push(t)})}),i}(t,this.data(),this.rawData)||[];var e=[],n=[];t[0]&&(t[0].data.forEach(function(t){n.push(t.name)}),e=[t[0].range[0]-5,t[0].range[1]+5]),this._xDomain=""==e?[-100,100]:e,this._yDomain=""==n?[0,1]:n.reverse()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,a=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),o.domain(t._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);n&&n.titleHeight;var d=t._tickCount?t._tickCount:(c-n.allowedMaxTextWidth())/(2*u);if(e.tickCount(d).compute(),n.compute(),i.range([0,c-n.width]),e.compute(),o.range([h-e.height,0]),n.compute(),"top"==l){var _=n.width,f=e.height,p=n.width,y=e.height;e.translate(_,f).update(),n.translate(p,y).update(),this.coreGroup.selectAll("line").remove(),this.coreGroup.append("line").attr("x1",i(0)).attr("y1",e.height).attr("x2",i(0)).attr("y2",o.range()[0]+e.height).attr("stroke","#000000")}else{var g=n.width,v=h-e.height,x=n.width;e.translate(g,v).update(),n.translate(x,0).update(),this.coreGroup.selectAll("line").remove(),this.coreGroup.append("line").attr("x1",i(0)).attr("y1",0).attr("x2",i(0)).attr("y2",o.range()[0]).attr("stroke","#000000")}}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return""!=t.name});t.legend.data(i).shapeType("rect").onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}}]),n}();var Ui=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","simple-line-texts"),e._xScale=null,e._yScale=null,e._transition=!1,e}return u(n,A),l(n,[{key:"update",value:function(){var n=this,t=n._data,e=n.group,i=n._xScale,o=n._yScale;e.selectAll("filter").remove();var a=n._defs.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow").attr("filterUnits","objectBoundingBox");a.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",1).attr("result","blurredAlpha"),a.append("feOffset").attr("in","blurredAlpha").attr("dx",0).attr("dy",0).attr("result","offsetBlurredAlpha"),a.append("feFlood").attr("result","flooded").style("flood-color","#000000").style("flood-opacity","1"),a.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),a.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var r=e.selectAll("g").data(t,function(t){return t.name});r.exit().remove(),r.enter().append("g").attr("class","simple-text-group").merge(r).each(function(t){var e=d3.select(this).selectAll("text").data(t.data);e.exit().remove(),e.enter().append("text").attr("x",function(t){return i(t.name)+("mix"==n._type?i.bandwidth()/2:0)||0}).attr("y",function(t){return o(t.value)||0}).merge(e).text(function(t){return isNaN(parseFloat(t.value))?"":t.value}).style("fill",n._fontColor).style("font-size",n._fontSize).style("font-family",n._fontFamily).attr("x",function(t){return i(t.name)+("mix"==n._type?i.bandwidth()/2:0)||0}).attr("y",function(t){return o(t.value)||0}).attr("text-anchor","middle").style("display",n._labelShow?"block":"none")}),null==n._labelShow||null==n._positionOptions||null==n._positionChoice||-1==n._positionOptions.indexOf(n._positionChoice)?e.selectAll(".simple-text-group text").style("display","none"):0==n._positionOptions.indexOf(n._positionChoice)?e.selectAll(".simple-text-group text").attr("dy",.4*-n._fontSize):1==n._positionOptions.indexOf(n._positionChoice)&&e.selectAll(".simple-text-group text").attr("dy",1.3*n._fontSize);for(var l=e.selectAll(".simple-text-group text"),s=[],u=[],c=0;c<l._groups[0].length;c++){u.push(c);for(var h=c+1;h<l._groups[0].length;h++){rt(at(d3.select(l._groups[0][c])),at(d3.select(l._groups[0][h])))&&(s.push(c),d3.select(l._groups[0][c]).style("opacity","0"))}}for(var d=new Set(s),_=Array.from(d),f=function(t,e){for(var n=e,i=[],o=t.concat(n),a={},r=0;r<o.length;r++)o[r]in a?a[o[r]]++:a[o[r]]=1;for(var l in a)1==a[l]&&i.push(Number(l));return i}(_,u),p=0;p<_.length;p++){for(var y=[],g=0;g<f.length;g++){var v=at(d3.select(l._groups[0][_[p]])),x=at(d3.select(l._groups[0][f[g]]));if(y.push(rt(v,x)),rt(v,x)){if(_[p]==f[g])continue;d3.select(l._groups[0][_[p]]).style("opacity","0")}}0==y.filter(function(t){return 1==t}).length&&f.push(_[p])}for(var m=0;m<f.length;m++)d3.select(l._groups[0][f[m]]).style("opacity","1");return n}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}}]),n}(),Ji=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","simple-line-chart"),e.grid=new Ct(e.coreGroup),e.linePlot=new Mt(e.coreGroup),e.scatterPlot=new zt(e.coreGroup),e.clipArea=new bt(e.defs),e.xAxis=new ft(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.overlay=new At(e.coreGroup),e.guideLine=new vt(e.coreGroup),e.guideScatter=new zt(e.coreGroup),e.SimpleLineText=new Ui(e.coreGroup),e.xScale=d3.scaleBand(),e.yScale=d3.scaleLinear(),e._xType="category",e._yType="number",e._xOrient="bottom",e._yOrient="left",e._showPoints=!0,e._curve=d3.curveLinear,e._lineWidth=2,e._strokeWidth=1,e._endPointRadius=3.5,e._labelShow=!1,e._positionOptions=["",""],e._positionChoice="",e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var t=this,n=t.activeData,e=t.grid,i=t.linePlot,o=t.scatterPlot,a=t.clipArea,r=t.tooltip,l=t.overlay,s=t.guideLine,u=t.guideScatter,c=t.SimpleLineText,h=t.xScale,d=t.yScale,_=t.widthOfCore,f=t.heightOfCore;Math.min(d3.min(n,function(t){return d3.min(t.data,function(t){return+t.value})}),0);e.width(_).height(f).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),i.data(n).xScale(h).yScale(d).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).curve(t._curve).strokeWidth(t._lineWidth),o.data(n).xScale(h).yScale(d).radius(t._endPointRadius).stroke("#fff").strokeWidth(t._strokeWidth),s.y1(0).y2(f).strokeDasharray(t._gridStrokeDasharray),u.xScale(h).yScale(d).fill("#fff"),l.data(h.domain()).isScalePoint(!1).bandWidth(h.step()).bandHeight(f).onMouseover(function(t,e){var i=t,o=[{text:i=="&-"+(e+1)?"":i}],a=[];n.forEach(function(t,e){var n=t.data.filter(function(t){return t.name===i});a.push({key:t.key,name:t.name,color:t.color,data:n}),o.push({text:("$-0"==t.name?"":t.name)+": "+(isNaN(parseFloat(n[0].value))?"":n[0].value),color:t.color})}),r.data(o).update().show(),s.x(h(i)+h.bandwidth()/2).update().show(),u.data(a).update().show()}).onMousemove(function(){r.move()}).onMouseout(function(){r.hide(),s.hide(),u.hide()}),c.data(n).xScale(h).yScale(d).type("mix").defs(t.defs).fontSize(t._textLabel.fontSize).fontColor(t._textLabel.color).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice),t.coreGroup.call(H,t.yAxis.width+.5,0),0!=t._clipShow.length?a.width(_).height(f).paddingVertical([0,0]).transition(t._transition).duration(t._duration):a.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url(#"+a.id+")"),a.update(),u.elem.style("pointer-events","none");var p=t.group.selectAll(".axis-x-line .tick text").nodes().filter(function(t,e){return t.__data__=="&-"+(e+1)});d3.selectAll(p).remove(),l.update(),e.update(),i.update(),o.update().show(),c.update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"buildOption",value:function(t,e){var n=new w(t,e),i=Sn;return n.dataSolveFunc(i),n}},{key:"setSelfOption",value:function(t){var e=t.display,n=t.label;0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=n?n.display:this._labelShow,this._positionChoice=n.positionChoice?n.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel);var i={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._strokeWidth=o(e.lineWidth?e.lineWidth:this._strokeWidth),this._curve=i[e.lineType]||this._curve)}}]),n}(),Ki="axis-group",$i="x-title",to=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e._hmsShow=null,e}return u(n,ft),l(n,[{key:"update",value:function(){var n=this,t=n._orient,e=n._scaleFunc,i=n.group,o=n._fontSize,a=n._tickTextRotate,r=n._tickValueTexts,l=void 0;(l=n.axisFunc="top"===t?d3.axisTop(e):d3.axisBottom(e)).tickValues(n._tickShow?n._tickValues:[]).tickSizeInner(n._tickShow?n._tickSize:0).tickSizeOuter(0).tickPadding(n._tickPadding).tickFormat(n._tickFormat);var s=i.select("."+Ki).empty()?i.append("g").attr("class",Ki):i.select("."+Ki);s.style("font-size",o+"px").style("font-family",n._fontFamily).transition().duration(n._transition?n._duration:0).call(l).on("start",function(){s.selectAll(".tick text").remove(),s.selectAll(".tick").append("text").style("fill",n._fontColor).attr("dx",0).attr("dy","1.5em").attr("transform","rotate(0)").style("text-anchor","middle").text(function(t){var e=new Date(t);return n._hmsShow?e.toLocaleDateString()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds():e.toLocaleDateString()}).filter(function(){return a}).attr("dx","-0.5em").style("text-anchor","end").attr("transform","rotate("+n._tickTextRotate+")").filter(function(){return"top"!==t}).attr("dy","0.5em"),s.selectAll(".tick line").style("stroke",n._lineStroke),s.select("path").style("stroke",n._lineStroke).style("display",n._axisLineShow?"block":"none")});var u=Math.abs(e.range()[0]-e.range()[1]);if(n._titleShow&&n._title){var c=i.select("."+$i).empty()?i.append("g").attr("class",$i):i.select("."+$i),h=c.select("text").empty()?c.append("text"):c.select("text"),d=u/r.length,_=d3.max(r,function(t){return V(t,o,n._fontFamily)});c.call(H,u/2+Math.abs(e.range()[0]),this._tickShow?this._tickSize+this._tickPadding+(_<.8*d?this._tickTextHeight:1.2*this._tickTextHeight):0),h.attr("text-anchor","middle").style("font-size",o+"px").style("font-family",n._fontFamily).style("fill",n._fontColor).attr("dy",1.125*o/2+6).text(n._title)}else i.select("."+$i).remove()}},{key:"compute",value:function(){var o=this,_=[],a=[],r=0,l=0,t=!1;function s(){o._tickTextRotate=r,o._tickValues=_,o._tickValueTexts=a,o._tickTextHeight=l,o._rotateFlag=t}var f=o._scaleFunc,e=o._type,u=o._fontSize,n=(o._minTickDistance,o._allowedMaxTextHeight),c=Math.abs(f.range()[0]-f.range()[1]),h=void 0,d=void 0;if(function(){if(""==f.domain())return;for(var t=[1,2,6,12,24,48,168],e=new Date(f.domain()[0]),n=new Date(f.domain()[1]),i=parseInt(n.getTime()-e.getTime()),o=!1,a=0,r=0;r<t.length;r++)if(i/(36e5*t[r])<=12){o=!0,a=36e5*t[r];break}if(o)for(var l=0;!(f.domain()[0]+a*l>=f.domain()[1]);l++)_.push(f.domain()[0]+a*l);else{var s=e.toLocaleDateString().split("/"),u=n.toLocaleDateString().split("/");if(3<=u[0]-s[0]){a=Math.ceil((u[0]-s[0])/12);for(var c=0;!(+new Date(e).setFullYear(parseInt(s[0])+c*a)>=f.domain()[1]);c++)_.push(+new Date(e).setFullYear(parseInt(s[0])+c*a))}else if(i<=31536e6)for(var h=0;!(+new Date(e).setMonth(parseInt(s[1])-1+h)>=f.domain()[1]);h++)_.push(+new Date(e).setMonth(parseInt(s[1])-1+h));else for(var d=0;!(+new Date(e).setMonth(parseInt(s[1])-1+3*d)>=f.domain()[1]);d++)_.push(+new Date(e).setMonth(parseInt(s[1])-1+3*d))}}(),function(){var t=!1;h=c/_.length;for(var e=[],n=0;n<_.length;n++){var i=new Date(_[n]);o._hmsShow?e.push(i.toLocaleDateString()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()):e.push(i.toLocaleDateString())}(d=d3.max(e,function(t){return V(t,u,o._fontFamily)}))<h&&(r=0,a=_,l=1.125*u,s(),t=!0);return t}())return o;r="top"===o._orient?45:-45;var i=Math.abs(Math.sin(Math.PI/4));d*i<n?(l=d*i,a=_,t=!1):(l=n,a=_.map(function(t){return I(t,l/i,u,o._fontFamily)}),t=!0);Math.abs(Math.cos(Math.PI/4));var p=c/_.length;if("category"===e&&p<2*u){var y=Math.ceil(2*u/p);_=_.filter(function(t,e){return e%y==0})}return s(),o}},{key:"hmsShow",value:function(t){return arguments.length?(this._hmsShow=t,this):this._hmsShow}}]),n}();function eo(t,e){var n=0,i=1,o=2,a=3;if(e.forEach(function(t){""===t.name?n=t.index:""===t.name?i=t.index:""===t.name?o=t.index:""===t.name&&(a=t.index)}),P(t,[n,i,o]))return[];var r={},l=[],s=t.slice(1).map(function(t){return t[n]}),u=t.slice(1);for(var c in u.forEach(function(t,e){l.push({name:""==s[e]||null==s[e]||null==s[e]?"&-"+e:s[e],data:[{name:""==s[e]||null==s[e]||null==s[e]?"&-"+e:s[e],showLegend:""!=s[e]&&null!=s[e]&&null!=s[e],timeStart:t[i],timeEnd:t[o],tip:t[a]}]})}),r)l.push(r[c]);return l.forEach(function(t,e){t.key=t.name+"-"+e}),l}var no=function(t){function n(t){r(this,n);var e=c(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","gantt-chart"),e.grid=new Ct(e.coreGroup),e.rectPlot=new xn(e.coreGroup),e.xAxis=new to(e.mainGroup),e.yAxis=new gt(e.mainGroup),e.xAxis.minTickDistance(1),e.xScale=d3.scaleLinear(),e.yScale=d3.scaleBand(),e._xType="number",e._yType="category",e._xOrient="bottom",e._yOrient="left",e._sortValue=-1,e._curve=d3.curveCardinal,e._rectHeight=.5,e}return u(n,ct),l(n,[{key:"updateCore",value:function(){var e,a=this,t=a.activeData,n=(e=[],t.forEach(function(t){e.push(t.data[0])}),e),i=a.grid,r=a.tooltip,o=a.rectPlot,l=a.xScale,s=a.yScale,u=a.widthOfCore,c=a.heightOfCore;o.data(n).xScale(l).yScale(s).rectObj({xFunc:function(t){return l(+new Date(t.timeStart))},yFunc:function(t){return s(t.name)+s.step()*(1-a._rectHeight)/2},widthFunc:function(t){return l(+new Date(t.timeEnd))-l(+new Date(t.timeStart))},heightFunc:function(){return s.step()*a._rectHeight}}).fillOpacity(1).onMousemove(function(t,e){var n=a.elem.node().parentNode,i=d3.mouse(n),o=[{text:t.name=="&-"+e?"":t.name,color:t.color},{text:t.name=="&-"+e?"":t.name},{text:": "+t.timeStart},{text:": "+t.timeEnd}];r.show(),r.data(o).update().move([i[0],i[1]]),d3.select(this).style("cursor","pointer")}).onMouseout(function(){r.hide()}),i.width(u).height(c).xTickLocations(a.xAxis.tickLocations.slice(0)).yTickLocations(a.yAxis.tickLocations.slice(0)).showX(a._gridShowX).showY(a._gridShowY).stroke(a._gridStroke).strokeDasharray(a._gridStrokeDasharray),a.coreGroup.attr("transform","translate("+a.yAxis.width+",0)"),o.update(),i.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,n=t.yAxis,i=t.xScale,o=t.yScale,a=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;i.domain(t._xDomain),e.scaleFunc(i).allowedMaxTextHeight(.3*h).type(a).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),o.domain(t._yDomain),n.scaleFunc(o).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke("transparent").fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);n&&n.titleHeight;n.compute(),i.range([0,c-n.width]),e.compute(),o.range([h-e.height,0]),n.compute();var d=n.width,_=h-e.height,f=n.width;e.translate(d,_).update(),n.translate(f,0).update()}},{key:"configLegend",value:function(){var t=this,i=t.sortedDataCopy.filter(function(t,e){return 1==t.showLegend});t.legend.data(i).onClick(function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach(function(t){t.key===e.key&&(t.active=!n)}),t.onDataChange()})}},{key:"buildOption",value:function(t,e){var n=new mn(t,e),i=eo;return n.dataSolveFunc(i),n}},{key:"computeDomain",value:function(){var t=this.data(),e=this.activeData,n=e.length?e.map(function(t){return t.name}):[0,1],i=!1,o=[],a=[];t.forEach(function(t){i||(1<t.data[0].timeStart.split(" ").length&&(i=!0),1<t.data[0].timeEnd.split(" ").length&&(i=!0))}),e.forEach(function(t){o.push(+new Date(t.data[0].timeStart)),o.push(+new Date(t.data[0].timeEnd))}),""!=o&&(a=[Math.min.apply(null,o),Math.max.apply(null,o)]),this._xDomain=a,this._yDomain=n,this.xAxis.hmsShow(i)}}]),n}(),io=new Date;io.toLocaleDateString(),console.log("d3Chart update"+io),t.RoundCornerDonutChart=D,t.RoundCornerPieChart=N,t.WaveCircleChart=B,t.IconBarChart=it,t.RoseChart=U,t.QuarterRoseChart=J,t.RadialBarChart=st,t.RadialLineChart=ut,t.OverlapAreaChart=Lt,t.StepLineChart=Tt,t.SankeyChart=ne,t.SimpleSankeyChart=ie,t.VerticalSankeyChart=ae,t.ChordChart=ue,t.IconPieChart=he,t.TwoLevelDonutChart=ye,t.OneLevelTreemapChart=me,t.TwoLevelTreemapChart=be,t.SunburstChart=Ae,t.TreeChart=ze,t.WeightedTreeChart=Te,t.StreamgraphChart=Ne,t.RadarChart=Be,t.PyramidChart=Ve,t.MultipleBarChart=Ke,t.GroupingBubbleChart=rn,t.CalendarHeatmapChart=dn,t.HollowChart=pn,t.StackedChart=vn,t.FormWaterfallHistogramChart=An,t.ChangeWaterfallHistogramChart=wn,t.SimpleBarChart=Ln,t.SmoothLineChart=Vi,t.SymmetricChart=qi,t.PieChart=j,t.HistogramChart=Bi,t.ProgressRoundPieChart=Rn,t.HalfProgressPieChart=Tn,t.HalfPieChart=Pn,t.SlopeChart=Vn,t.BarProgressChart=Yn,t.PolygonRadarChart=Jn,t.RankingChangeChart=ei,t.PercentageBarChart=ri,t.PercentageAreaChart=ci,t.ArcDiagramChart=fi,t.BasicHorizontalBarChart=pi,t.StackBarChart=gi,t.StackHorizontalBarChart=xi,t.GroupedBarChart=ki,t.GroupedHorizontalBarChart=Si,t.NegativeHorizontalBarChart=wi,t.MixLineBarChart=Ri,t.MultipleLineChart=Rt,t.DeformedPieChart=Ti,t.DonutChart=Pi,t.FunnelChart=Di,t.BeeLineChart=Ei,t.StackedLinearChart=Hi,t.setUserMd=function(t){window.userId=t},t.SimpleLineChart=Ji,t.GanttChart=no,Object.defineProperty(t,"__esModule",{value:!0})});
